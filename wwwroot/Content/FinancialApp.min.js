(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ;b=a.FinancialApp=a.FinancialApp||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Operators=d.Operators||{};f=d.Obj=d.Obj||{};g=d.UI=d.UI||{};h=g.Var$1=g.Var$1||{};i=g.Var=g.Var||{};j=g.HtmlModule=g.HtmlModule||{};k=j.attr=j.attr||{};l=d.List=d.List||{};m=c.Transaction=c.Transaction||{};n=a.System=a.System||{};o=n.Guid=n.Guid||{};p=c.TransactionType=c.TransactionType||{};q=c.Category=c.Category||{};r=g.Client=g.Client||{};s=r.Templates=r.Templates||{};t=g.Doc=g.Doc||{};u=d.JavaScript=d.JavaScript||{};v=u.Pervasives=u.Pervasives||{};w=g.ConcreteVar=g.ConcreteVar||{};x=g.Snap=g.Snap||{};y=d.Seq=d.Seq||{};z=c.Stock=c.Stock||{};A=d.Collections=d.Collections||{};B=A.Map=A.Map||{};C=c.Portfolio=c.Portfolio||{};D=g.AttrProxy=g.AttrProxy||{};E=l.T=l.T||{};F=d.Arrays=d.Arrays||{};G=g.AttrModule=g.AttrModule||{};H=A.FSharpMap=A.FSharpMap||{};I=d.Decimal=d.Decimal||{};J=a.EventTarget;K=a.Node;L=u.JS=u.JS||{};M=A.Dictionary=A.Dictionary||{};N=d.Unchecked=d.Unchecked||{};O=g.Abbrev=g.Abbrev||{};P=O.Fresh=O.Fresh||{};Q=a.StartupCode$FinancialApp$Client=a.StartupCode$FinancialApp$Client||{};R=d.Numeric=d.Numeric||{};S=d.Enumerator=d.Enumerator||{};T=d.Random=d.Random||{};U=A.BalancedTree=A.BalancedTree||{};V=A.Pair=A.Pair||{};W=g.Attrs=g.Attrs||{};X=g.DomUtility=g.DomUtility||{};Y=g.View=g.View||{};Z=a.StartupCode$WebSharper_MathJS_Extensions$Decimal=a.StartupCode$WebSharper_MathJS_Extensions$Decimal||{};_0=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};_1=A.HashSet=A.HashSet||{};_2=a.WindowOrWorkerGlobalScope;_3=g.Docs=g.Docs||{};_4=S.T=S.T||{};_5=U.Tree=U.Tree||{};_6=g.Array=g.Array||{};_7=g.BindVar=g.BindVar||{};_8=A.DictionaryUtil=A.DictionaryUtil||{};_9=a.Element;_=a.Object;$=s.Prepare=s.Prepare||{};ba=d.Slice=d.Slice||{};bb=A.KeyCollection=A.KeyCollection||{};bc=g.DocElemNode=g.DocElemNode||{};bd=a.CharacterData;be=g.An=g.An||{};bf=r.Settings=r.Settings||{};bg=O.Mailbox=O.Mailbox||{};bh=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bi=g.Elt=g.Elt||{};bj=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bk=a.Error;bl=d.ArgumentException=d.ArgumentException||{};bm=d.Strings=d.Strings||{};bn=r.Attrs=r.Attrs||{};bo=bn.Dyn=bn.Dyn||{};bp=r.Docs=r.Docs||{};bq=bp.RunState=bp.RunState||{};br=bp.NodeSet=bp.NodeSet||{};bs=d.Concurrency=d.Concurrency||{};bt=g.Anims=g.Anims||{};bu=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bv=A.MapUtil=A.MapUtil||{};bw=g.Updates=g.Updates||{};bx=g.DynamicAttrNode=g.DynamicAttrNode||{};by=g.String=g.String||{};bz=g.CheckedInput=g.CheckedInput||{};bA=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bB=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bC=g.AppendList=g.AppendList||{};bD=A.HashSetUtil=A.HashSetUtil||{};bE=d.Char=d.Char||{};bF=d.DateUtil=d.DateUtil||{};bG=d.KeyNotFoundException=d.KeyNotFoundException||{};bH=bs.Scheduler=bs.Scheduler||{};bI=g.Easing=g.Easing||{};bJ=bs.AsyncBody=bs.AsyncBody||{};bK=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bL=bs.CT=bs.CT||{};bM=O.HashSet=O.HashSet||{};bN=d.Queue=d.Queue||{};bO=d.CancellationTokenSource=d.CancellationTokenSource||{};bP=bp.DomNodes=bp.DomNodes||{};bQ=d.OperationCanceledException=d.OperationCanceledException||{};bR=d.Lazy=d.Lazy||{};bS=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bT=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bU=bT.LazyRecord=bT.LazyRecord||{};bV=a.Date;bW=a.console;bX=a.math;bY=a.Math;bZ=d&&d.Runtime;c.Main=function(){var b0;b0=c.app();s.LoadLocalTemplates("");t.RunById("main",b0);};c.app=function(){var b0,b1,b2,b3,b4,b5,b6;function b7(){b0.Set(c.displayDashboard());b1.Set(c.displayPortfolio());}function b8(){var b$,ca;c.addTransaction(m.New(o.NewGuid(),b2.Get()=="Income"?p.Income:p.Expense,(b$=b3.Get(),b$=="Food"?q.Food:b$=="Utilities"?q.Utilities:b$=="Salary"?q.Salary:b$=="Entertainment"?q.Entertainment:{$:4,$0:b3.Get()}),(ca=b4.Get(),I.WSDecimalMath().bignumber(ca)),bV.now()));b7();}function b9(){c.addStock(b5.Get(),e.toInt(a.Number(b6.Get())));b7();}function b_(){c.removeStock(b5.Get(),e.toInt(a.Number(b6.Get())));b7();}b0=h.Create$1(c.displayDashboard());b1=h.Create$1(c.displayPortfolio());b2=h.Create$1("Income");b3=h.Create$1("Salary");b4=h.Create$1("");b5=h.Create$1("");b6=h.Create$1("");return t.Element("div",[D.Create("class","container")],[t.Element("h1",[],[t.TextNode("Finance Manager")]),t.Element("div",[D.Create("class","budget-form")],[t.Element("div",[D.Create("class","add-budget")],[t.Element("h3",[],[t.TextNode("Add Transaction")]),t.Element("label",[],[t.TextNode("Type: ")]),t.Select([],a.id,l.ofArray(["Income","Expense"]),b2),t.Element("label",[],[t.TextNode("Category: ")]),t.Select([],a.id,l.ofArray(["Food","Utilities","Salary","Entertainment","Others"]),b3),t.Element("br",[],[]),t.Element("label",[],[t.TextNode("Amount: ")]),t.Input([],b4),t.Element("button",[G.Handler("click",function(){return function(){return b8();};})],[t.TextNode("Add Transaction")])]),t.Element("div",[D.Create("class","add-expense")],[t.Element("h3",[],[t.TextNode("Manage Stocks")]),t.Element("label",[],[t.TextNode("Subject: ")]),t.Input([],b5),t.Element("label",[],[t.TextNode("Quantity: ")]),t.Input([],b6),t.Element("button",[G.Handler("click",function(){return function(){return b9();};})],[t.TextNode("Add Stock")]),t.Element("button",[D.Create("class","reset-all"),G.Handler("click",function(){return function(){return b_();};})],[t.TextNode("Remove Stock")])])]),t.Element("div",[],[t.BindView(a.id,b0.get_View())]),t.Element("div",[],[t.BindView(a.id,b1.get_View())])]);};c.displayDashboard=function(){var b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca;try{b4=l.filter(function(cb){return cb.Type.$===0;},c.transactions().Get());b0=I.CreateDecimal(0,0,0,false,0);b5=S.Get(b4);try{while(b5.MoveNext()){b0=(b6=b5.Current().Amount,b7=I.WSDecimalMath(),b7.add.apply(b7,[b0,b6]));}}finally{if(typeof b5=="object"&&"Dispose"in b5)b5.Dispose();}b8=b0;b9=l.filter(function(cb){return cb.Type.$===1;},c.transactions().Get());b2=I.CreateDecimal(0,0,0,false,0);b_=S.Get(b9);try{while(b_.MoveNext()){b2=(b$=b_.Current().Amount,ca=I.WSDecimalMath(),ca.add.apply(ca,[b2,b$]));}}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}b1=b2;b3=I.WSDecimalMath().subtract(b8,b1);return t.Element("div",[D.Create("class","budget-details")],[t.Element("h3",[],[t.TextNode("Current Financial Status")]),t.Element("div",[D.Create("class","totals")],[t.Element("p",[],[t.TextNode("Total Income: "+a.String(b8)+"$")]),t.Element("p",[],[t.TextNode("Total Expenses: "+a.String(b1)+"$")]),t.Element("p",[],[t.TextNode("Net Income: "+a.String(b3)+"$")])])]);}catch(cb){bW.log("Error in displayDashboard: ",cb.message);return t.Element("div",[],[t.TextNode("Error displaying dashboard")]);}};c.displayPortfolio=function(){return t.Element("div",[D.Create("class","budget-details")],[t.Element("h3",[],[t.TextNode("Current Portfolio")]),t.Element("ul",[D.Create("class","list-group")],l.ofSeq(y.delay(function(){return y.collect(function(b0){var b1,b2;b1=b0[1];b2=c.getRandomStockPrice(b0[0]);return[t.Element("li",[D.Create("class","list-group-item")],[t.TextNode("Symbol: "+a.String(b1.Symbol)+", Quantity: "+a.String(b1.Quantity)+", Current Price: "+a.String(b2)+"$")])];},B.ToSeq(c.portfolio().Get().Stocks));})))]);};c.removeStock=function(b0,b1){var b2,b3;b2=c.portfolio().Get().Stocks.TryFind(b0);if(b2!=null&&b2.$==1)b2.$0.Quantity>b1?(b3=b2.$0,c.portfolio().Set((c.portfolio().Get(),C.New(c.portfolio().Get().Stocks.Add$1(b0,z.New(b3.Symbol,b3.Quantity-b1)))))):b2.$0.Quantity===b1?c.portfolio().Set((c.portfolio().Get(),C.New(c.portfolio().Get().Stocks.Remove$1(b0)))):void 0;};c.addStock=function(b0,b1){var b2,b3,b4;b2=(b3=c.portfolio().Get().Stocks.TryFind(b0),b3==null?z.New(b0,b1):(b4=b3.$0,z.New(b4.Symbol,b4.Quantity+b1)));c.portfolio().Set((c.portfolio().Get(),C.New(c.portfolio().Get().Stocks.Add$1(b0,b2))));};c.addTransaction=function(b0){c.transactions().Set(new E({$:1,$0:b0,$1:c.transactions().Get()}));};c.transactions=function(){Q.$cctor();return Q.transactions;};c.getRandomStockPrice=function(b0){var b1;b1=c.random().Next(100,1000);return I.WSDecimalMath().bignumber(b1);};c.portfolio=function(){Q.$cctor();return Q.portfolio;};c.random=function(){Q.$cctor();return Q.random;};c.createMathInstance=function(){return bX.create({number:"BigNumber",precision:29,predictable:true,epsilon:1E-60});};e.toInt=function(b0){var b1;b1=e.toUInt(b0);return b1>=2147483648?b1-4294967296:b1;};e.toUInt=function(b0){return(b0<0?bY.ceil(b0):bY.floor(b0))>>>0;};e.FailWith=function(b0){throw new bk(b0);};e.InvalidArg=function(b0,b1){throw new bl.New(b0,b1);};e.KeyValue=function(b0){return[b0.K,b0.V];};e.range=function(b0,b1){var b2;b2=1+b1-b0;return b2<=0?[]:y.init(b2,function(b3){return b3+b0;});};f=d.Obj=bZ.Class({Equals:function(b0){return this===b0;},GetHashCode:function(){return -1;}},null,f);f.New=bZ.Ctor(function(){},f);h=g.Var$1=bZ.Class({},f,h);h.Create$1=function(b0){return new w.New(false,x.New({$:2,$0:b0,$1:[]}),b0);};i=g.Var=bZ.Class({},f,i);i.New=bZ.Ctor(function(){f.New.call(this);},i);k=j.attr=bZ.Class({},f,k);l.ofArray=function(b0){var b1,b2,b3;b1=E.Empty;for(b2=F.length(b0)-1,b3=0;b2>=b3;b2--)b1=new E({$:1,$0:F.get(b0,b2),$1:b1});return b1;};l.filter=function(b0,b1){var b2,b3,b4,b5,b6,b7;if(b1.$==0)return b1;else{b2=E.Empty;b3=b2;b4=b1;b5=true;while(b5){if(b0(b4.$0)){b2.$==0?(b2=new E({$:1}),b3=b2):b3=(b6=new E({$:1}),b3.$1=b6,b6);b7=b4.$0;b3.$=1;b3.$0=b7;}b4=b4.$1;if(b4.$==0)b5=false;}if(!(b2.$==0))b3.$1=E.Empty;return b2;}};l.ofSeq=function(b0){var b1,b2,b3,b4,b5,b6;if(b0 instanceof E)return b0;else if(b0 instanceof a.Array)return l.ofArray(b0);else{b1=S.Get(b0);try{b3=b1.MoveNext();if(!b3)b2=E.Empty;else{b5=new E({$:1});b4=b5;while(b3){b4.$0=b1.Current();if(b1.MoveNext())b4=(b6=new E({$:1}),b4.$1=b6,b6);else b3=false;}b4.$1=E.Empty;b2=b5;}return b2;}finally{if(typeof b1=="object"&&"Dispose"in b1)b1.Dispose();}}};l.mapi=function(b0,b1){var b2,b3,b4,b5,b6,b7;if(b1.$==0)return b1;else{b6=new E({$:1});b2=b6;b3=b1;b4=0;b5=true;while(b5){b2.$0=b0(b4,b3.$0);b3=b3.$1;if(b3.$==0)b5=false;else{b2=(b7=new E({$:1}),b2.$1=b7,b7);b4=b4+1;}}b2.$1=E.Empty;return b6;}};l.head=function(b0){return b0.$==1?b0.$0:l.listEmpty();};l.tail=function(b0){return b0.$==1?b0.$1:l.listEmpty();};l.listEmpty=function(){return e.FailWith("The input list was empty.");};m.New=function(b0,b1,b2,b3,b4){return{Id:b0,Type:b1,Category:b2,Amount:b3,Date:b4};};o.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(b0){var b1,b2;b1=bY.random()*16|0;b2=b0=="x"?b1:b1&3|8;return b2.toString(16);});};p.Income={$:0};p.Expense={$:1};q.Food={$:0};q.Utilities={$:1};q.Salary={$:2};q.Entertainment={$:3};s.LoadLocalTemplates=function(b0){!s.LocalTemplatesLoaded()?(s.set_LocalTemplatesLoaded(true),s.LoadNestedTemplates(self.document.body,"")):void 0;s.LoadedTemplates().set_Item(b0,s.LoadedTemplateFile(""));};s.LocalTemplatesLoaded=function(){_0.$cctor();return _0.LocalTemplatesLoaded;};s.set_LocalTemplatesLoaded=function(b0){_0.$cctor();_0.LocalTemplatesLoaded=b0;};s.LoadNestedTemplates=function(b0,b1){var b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl;function b2(cm){var cn,co;if(!b3.ContainsKey(cm)){cn=(co=null,[b4.TryGetValue(cm,{get:function(){return co;},set:function(cp){co=cp;}}),co]);if(cn[0]){cl.SAdd(cm);b4.RemoveKey(cm);s.PrepareTemplateStrict(b1,{$:1,$0:cm},cn[1],{$:1,$0:b2});}else bW.warn(cl.Contains(cm)?"Encountered loop when instantiating "+cm:"Local template does not exist: "+cm);}}b3=s.LoadedTemplateFile(b1);b4=new M.New$5();b5=b0.querySelectorAll("[ws-template]");for(b6=0,b7=b5.length-1;b6<=b7;b6++){b8=b5[b6];b9=b8.getAttribute("ws-template").toLowerCase();b8.removeAttribute("ws-template");b4.set_Item(b9,s.FakeRootSingle(b8));}b_=b0.querySelectorAll("[ws-children-template]");for(b$=0,ca=b_.length-1;b$<=ca;b$++){cb=b_[b$];cc=cb.getAttribute("ws-children-template").toLowerCase();cb.removeAttribute("ws-children-template");b4.set_Item(cc,s.FakeRoot(cb));}cd=b0.querySelectorAll("template[id]");for(ce=0,cf=cd.length-1;ce<=cf;ce++){cg=cd[ce];b4.set_Item(cg.getAttribute("id").toLowerCase(),s.FakeRootFromHTMLTemplate(cg));}ch=b0.querySelectorAll("template[name]");for(ci=0,cj=ch.length-1;ci<=cj;ci++){ck=ch[ci];b4.set_Item(ck.getAttribute("name").toLowerCase(),s.FakeRootFromHTMLTemplate(ck));}cl=new _1.New$3();while(b4.count>0)b2(y.head(b4.Keys()));};s.LoadedTemplates=function(){_0.$cctor();return _0.LoadedTemplates;};s.LoadedTemplateFile=function(b0){var b1,b2,b3;b1=(b2=null,[s.LoadedTemplates().TryGetValue(b0,{get:function(){return b2;},set:function(b4){b2=b4;}}),b2]);return b1[0]?b1[1]:(b3=new M.New$5(),(s.LoadedTemplates().set_Item(b0,b3),b3));};s.FakeRootSingle=function(b0){var b1,b2,b3,b4;b0.removeAttribute("ws-template");b1=b0.getAttribute("ws-replace");if(b1==null);else{b0.removeAttribute("ws-replace");b2=b0.parentNode;N.Equals(b2,null)?void 0:(b3=self.document.createElement(b0.tagName),b3.setAttribute("ws-replace",b1),b2.replaceChild(b3,b0));}b4=self.document.createElement("div");b4.appendChild(b0);return b4;};s.FakeRoot=function(b0){var b1;b1=self.document.createElement("div");while(b0.hasChildNodes())b1.appendChild(b0.firstChild);return b1;};s.FakeRootFromHTMLTemplate=function(b0){var b1,b2,b3,b4;b1=self.document.createElement("div");b2=b0.content;for(b3=0,b4=b2.childNodes.length-1;b3<=b4;b3++)b1.appendChild(b2.childNodes[b3].cloneNode(true));return b1;};s.PrepareTemplateStrict=function(b0,b1,b2,b3){var b4,b5;function b6(ca,cb){var cc,cd,ce,cf,cg,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC;function ch(cD){}while(true)switch(ca){case 0:if(cb!==null){cc=cb.nextSibling;if(N.Equals(cb.nodeType,K.TEXT_NODE))$.convertTextNode(cb);else if(N.Equals(cb.nodeType,K.ELEMENT_NODE))b8(cb);cb=cc;}else return null;break;case 1:ci=ba.string(cb.nodeName,{$:1,$0:3},null).toLowerCase();cj=(cd=ci.indexOf("."),cd===-1?[b0,ci]:[ba.string(ci,null,{$:1,$0:cd-1}),ba.string(ci,{$:1,$0:cd+1},null)]);ck=cj[1];cl=cj[0];if(cl!=""&&!s.LoadedTemplates().ContainsKey(cl))return $.failNotLoaded(ck);else{if(cl==""&&b3!=null)b3.$0(ck);cm=s.LoadedTemplates().Item(cl);if(!cm.ContainsKey(ck))return $.failNotLoaded(ck);else{cn=cm.Item(ck);co=cn.cloneNode(true);cp=new _1.New$3();cq=new M.New$5();cr=cb.attributes;for(cs=0,ct=cr.length-1;cs<=ct;cs++){cu=cr.item(cs).name.toLowerCase();cq.set_Item(cu,(cv=cr.item(cs).nodeValue,cv==""?cu:cv.toLowerCase()));if(!cp.SAdd(cu))bW.warn("Hole mapped twice",cu);}for(cw=0,cx=cb.childNodes.length-1;cw<=cx;cw++){cy=cb.childNodes[cw];if(N.Equals(cy.nodeType,K.ELEMENT_NODE))!cp.SAdd(cy.nodeName.toLowerCase())?bW.warn("Hole filled twice",ck):void 0;}cz=cb.childNodes.length===1&&N.Equals(cb.firstChild.nodeType,K.TEXT_NODE);if(cz){cf=$.fillTextHole(co,cb.firstChild.textContent,ck);((function(cD){return function(cE){if(cE!=null)cD(cE.$0);};}((cg=function(cD){return function(cE){return cD.SAdd(cE);};}(cp),function(cD){return ch(cg(cD));})))(cf));}$.removeHolesExcept(co,cp);if(!cz){for(cA=0,cB=cb.childNodes.length-1;cA<=cB;cA++){cC=cb.childNodes[cA];if(N.Equals(cC.nodeType,K.ELEMENT_NODE))cC.hasAttributes()?$.fillInstanceAttrs(co,cC):b7(co,cC);}}$.mapHoles(co,cq);$.fill(co,cb.parentNode,cb);cb.parentNode.removeChild(cb);return;}}break;}}function b7(ca,cb){var cc,cd,cf,cg;function ce(ch,ci){var cj;if(cf=="title"&&cb.hasChildNodes()){cj=X.ParseHTMLIntoFakeRoot(cb.textContent);cb.removeChild(cb.firstChild);while(cj.hasChildNodes())cb.appendChild(cj.firstChild);}else null;b8(cb);return $.fill(cb,ch,ci);}cf=cb.nodeName.toLowerCase();s.foreachNotPreserved(ca,"[ws-attr-holes]",function(ch){var ci,cj,ck,cl,cm;ci=bm.SplitChars(ch.getAttribute("ws-attr-holes"),[" "],1);for(cj=0,ck=ci.length-1;cj<=ck;cj++){cl=F.get(ci,cj);ch.setAttribute(cl,(cm=new a.RegExp("\\${"+cf+"}","ig"),ch.getAttribute(cl).replace(cm,cb.textContent)));}});cg=ca.querySelector("[ws-hole="+cf+"]");if(N.Equals(cg,null)){cc=ca.querySelector("[ws-replace="+cf+"]");return N.Equals(cc,null)?(cd=ca.querySelector("slot[name="+cf+"]"),ca.tagName.toLowerCase()=="template"?(ce(cd.parentNode,cd),void cd.parentNode.removeChild(cd)):null):(ce(cc.parentNode,cc),void cc.parentNode.removeChild(cc));}else{while(cg.hasChildNodes())cg.removeChild(cg.lastChild);cg.removeAttribute("ws-hole");return ce(cg,null);}}function b8(ca){if(!ca.hasAttribute("ws-preserve"))if(bm.StartsWith(ca.nodeName.toLowerCase(),"ws-"))b_(ca);else{$.convertAttrs(ca);b9(ca.firstChild);}}function b9(ca){return b6(0,ca);}function b_(ca){return b6(1,ca);}function b$(ca){var cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm;while(true){cb=ca.querySelector("[ws-template]");if(N.Equals(cb,null)){cc=ca.querySelector("[ws-children-template]");if(N.Equals(cc,null)){cd=ca.querySelectorAll("template[id]");for(ce=1,cf=cd.length-1;ce<=cf;ce++){cg=cd[ce];if(b4.Contains(cg));else{s.PrepareTemplateStrict(b0,{$:1,$0:cg.getAttribute("id")},cg,null);b4.SAdd(cg);}}ch=ca.querySelectorAll("template[name]");for(ci=1,cj=ch.length-1;ci<=cj;ci++){ck=ch[ci];if(b4.Contains(ck));else{s.PrepareTemplateStrict(b0,{$:1,$0:ck.getAttribute("name")},ck,null);b4.SAdd(ck);}}return null;}else{cl=cc.getAttribute("ws-children-template");cc.removeAttribute("ws-children-template");s.PrepareTemplateStrict(b0,{$:1,$0:cl},cc,null);ca=ca;}}else{cm=cb.getAttribute("ws-template");(s.PrepareSingleTemplate(b0,{$:1,$0:cm},cb))(null);ca=ca;}}}b4=new _1.New$3();b5=(b1==null?"":b1.$0).toLowerCase();s.LoadedTemplateFile(b0).set_Item(b5,b2);if(b2.hasChildNodes()){b$(b2);b9(b2.firstChild);}};s.foreachNotPreserved=function(b0,b1,b2){X.IterSelector(b0,b1,function(b3){if(b3.closest("[ws-preserve]")==null)b2(b3);});};s.PrepareSingleTemplate=function(b0,b1,b2){var b3;b3=s.FakeRootSingle(b2);return function(b4){s.PrepareTemplateStrict(b0,b1,b3,b4);};};s.TextHoleRE=function(){_0.$cctor();return _0.TextHoleRE;};t=g.Doc=bZ.Class({},f,t);t.RunById=function(b0,b1){var b2;b2=self.document.getElementById(b0);if(N.Equals(b2,null))e.FailWith("invalid id: "+b0);else t.Run(b2,b1);};t.TextNode=function(b0){return t.Mk({$:5,$0:self.document.createTextNode(b0)},Y.Const());};t.Select=function(b0,b1,b2,b3){return t.SelectImpl(b0,b1,function(b4){b4[0]=b2;return t.Concat(l.mapi(function(b5,b6){return t.Element("option",l.ofArray([D.Create("value",a.String(b5))]),l.ofArray([t.TextNode(b1(b6))]));},b2));},b3);};t.Input=function(b0,b1){return t.InputInternal("input",function(){return y.append(b0,[G.Value(b1)]);});};t.BindView=function(b0,b1){return t.EmbedView(Y.Map(b0,b1));};t.Run=function(b0,b1){_3.LinkElement(b0,b1.docNode);t.RunInPlace(false,b0,b1);};t.Element=function(b0,b1,b2){var b3,b4;b3=D.Concat(b1);b4=t.Concat(b2);return bi.New(self.document.createElement(b0),b3,b4);};t.Mk=function(b0,b1){return new t.New(b0,b1);};t.SelectImpl=function(b0,b1,b2,b3){var b4,b5,b6,b7;function b8(cb){return cb.selectedIndex;}function b9(cb,cc){cb.selectedIndex=cc;}function b_(cb){var cc;cc=b8(cb);return b4[0].get_Item(cc);}function b$(cb){return y.findIndex(function(cc){return N.Equals(cb,cc);},b4[0]);}function ca(cb,cc){return b9(cb,b$(cc));}b4=[E.Empty];b5=self.document.createElement("select");b6=G.DynamicCustom(function(cb){return function(cc){return ca(cb,cc);};},b3.get_View());b5.addEventListener("change",function(){b3.UpdateMaybe(function(cb){var cc;cc=b_(b5);return N.Equals(cb,cc)?null:{$:1,$0:cc};});},false);return bi.New(b5,(b7=D.Append(b6,D.Concat(b0)),D.Append(G.OnAfterRender(function(cb){ca(cb,b3.Get());}),b7)),b2(b4));};t.Concat=function(b0){var b1;b1=_6.ofSeqNonCopying(b0);return _6.TreeReduce(t.get_Empty(),t.Append,b1);};t.InputInternal=function(b0,b1){var b2;b2=self.document.createElement(b0);return bi.New(b2,D.Concat(b1(b2)),t.get_Empty());};t.EmbedView=function(b0){var b1;b1=_3.CreateEmbedNode();return t.Mk({$:2,$0:b1},Y.Map(a.ignore,Y.Bind(function(b2){_3.UpdateEmbedNode(b1,b2.docNode);return b2.updates;},b0)));};t.RunInPlace=function(b0,b1,b2){var b3;b3=_3.CreateRunState(b1,b2.docNode);Y.Sink(be.get_UseAnimations()||bf.BatchUpdatesEnabled()?bg.StartProcessor(_3.PerformAnimatedUpdate(b0,b3,b2.docNode)):function(){_3.PerformSyncUpdate(b0,b3,b2.docNode);},b2.updates);};t.Append=function(b0,b1){return t.Mk({$:0,$0:b0.docNode,$1:b1.docNode},Y.Map2Unit(b0.updates,b1.updates));};t.get_Empty=function(){return t.Mk(null,Y.Const());};t.New=bZ.Ctor(function(b0,b1){f.New.call(this);this.docNode=b0;this.updates=b1;},t);v.NewFromSeq=function(b0){var b1,b2,b3;b1={};b2=S.Get(b0);try{while(b2.MoveNext()){b3=b2.Current();b1[b3[0]]=b3[1];}}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}return b1;};w=g.ConcreteVar=bZ.Class({get_View:function(){return this.view;},Set:function(b0){if(this.isConst)(function(b1){return b1("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b1){bW.log(b1);}));else{x.Obsolete(this.snap);this.current=b0;this.snap=x.New({$:2,$0:b0,$1:[]});}},Get:function(){return this.current;},UpdateMaybe:function(b0){var b1;b1=b0(this.Get());if(b1!=null&&b1.$==1)this.Set(b1.$0);}},i,w);w.New=bZ.Ctor(function(b0,b1,b2){var b3;b3=this;i.New.call(this);this.isConst=b0;this.current=b2;this.snap=b1;this.view=function(){return b3.snap;};this.id=P.Int();},w);x.Map=function(b0,b1){var b2,b3;b2=b1.s;return b2!=null&&b2.$==0?x.New({$:0,$0:b0(b2.$0)}):(b3=x.New({$:3,$0:[],$1:[]}),(x.When(b1,function(b4){x.MarkDone(b3,b1,b0(b4));},b3),b3));};x.WhenObsoleteRun=function(b0,b1){var b2;b2=b0.s;if(b2==null)b1();else b2!=null&&b2.$==2?b2.$1.push(b1):b2!=null&&b2.$==3?b2.$1.push(b1):void 0;};x.When=function(b0,b1,b2){var b3;b3=b0.s;if(b3==null)x.Obsolete(b2);else b3!=null&&b3.$==2?(x.EnqueueSafe(b3.$1,b2),b1(b3.$0)):b3!=null&&b3.$==3?(b3.$0.push(b1),x.EnqueueSafe(b3.$1,b2)):b1(b3.$0);};x.MarkDone=function(b0,b1,b2){var b3;if(b3=b1.s,b3!=null&&b3.$==0)x.MarkForever(b0,b2);else x.MarkReady(b0,b2);};x.WhenRun=function(b0,b1,b2){var b3;b3=b0.s;if(b3==null)b2();else b3!=null&&b3.$==2?(b3.$1.push(b2),b1(b3.$0)):b3!=null&&b3.$==3?(b3.$0.push(b1),b3.$1.push(b2)):b1(b3.$0);};x.Map2Unit=function(b0,b1){var b2,b3,b4;function b5(){var b6,b7,b8;if(!(b6=b4.s,b6!=null&&b6.$==0||b6!=null&&b6.$==2)){b7=x.ValueAndForever(b0);b8=x.ValueAndForever(b1);if(b7!=null&&b7.$==1)b8!=null&&b8.$==1?b7.$0[1]&&b8.$0[1]?x.MarkForever(b4,null):x.MarkReady(b4,null):void 0;}}b2=b0.s;b3=b1.s;return b2!=null&&b2.$==0?b3!=null&&b3.$==0?x.New({$:0,$0:null}):b1:b3!=null&&b3.$==0?b0:(b4=x.New({$:3,$0:[],$1:[]}),(x.When(b0,b5,b4),x.When(b1,b5,b4),b4));};x.Join=function(b0){var b1;b1=x.New({$:3,$0:[],$1:[]});x.When(b0,function(b2){var b3;b3=b2();x.When(b3,function(b4){var b5,b6;if((b5=b3.s,b5!=null&&b5.$==0)&&(b6=b0.s,b6!=null&&b6.$==0))x.MarkForever(b1,b4);else x.MarkReady(b1,b4);},b1);},b1);return b1;};x.EnqueueSafe=function(b0,b1){var b2,b3,b4,b5;b0.push(b1);if(b0.length%20===0){b2=b0.slice(0);bN.Clear(b0);for(b3=0,b4=F.length(b2)-1;b3<=b4;b3++){b5=F.get(b2,b3);if(typeof b5=="object")(function(b6){if(b6.s)b0.push(b6);}(b5));else(function(b6){b0.push(b6);}(b5));}}else void 0;};x.MarkForever=function(b0,b1){var b2,b3,b4,b5;b2=b0.s;if(b2!=null&&b2.$==3){b0.s={$:0,$0:b1};b3=b2.$0;for(b4=0,b5=F.length(b3)-1;b4<=b5;b4++)(F.get(b3,b4))(b1);}else void 0;};x.MarkReady=function(b0,b1){var b2,b3,b4,b5;b2=b0.s;if(b2!=null&&b2.$==3){b0.s={$:2,$0:b1,$1:b2.$1};b3=b2.$0;for(b4=0,b5=F.length(b3)-1;b4<=b5;b4++)(F.get(b3,b4))(b1);}else void 0;};x.Copy=function(b0){var b1,b2,b3;b1=b0.s;return b1==null?b0:b1!=null&&b1.$==2?(b2=x.New({$:2,$0:b1.$0,$1:[]}),(x.WhenObsolete(b0,b2),b2)):b1!=null&&b1.$==3?(b3=x.New({$:3,$0:[],$1:[]}),(x.When(b0,function(b4){x.MarkDone(b3,b0,b4);},b3),b3)):b0;};x.ValueAndForever=function(b0){var b1;b1=b0.s;return b1!=null&&b1.$==0?{$:1,$0:[b1.$0,true]}:b1!=null&&b1.$==2?{$:1,$0:[b1.$0,false]}:null;};x.WhenObsolete=function(b0,b1){var b2;b2=b0.s;if(b2==null)x.Obsolete(b1);else b2!=null&&b2.$==2?x.EnqueueSafe(b2.$1,b1):b2!=null&&b2.$==3?x.EnqueueSafe(b2.$1,b1):void 0;};y.sumBy=function(b0,b1){var b2,b3;b2=0;b3=S.Get(b1);try{while(b3.MoveNext())b2=b2+b0(b3.Current());}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}return b2;};y.delay=function(b0){return{GetEnumerator:function(){return S.Get(b0());}};};y.collect=function(b0,b1){return y.concat(y.map(b0,b1));};y.concat=function(b0){return{GetEnumerator:function(){var b1;function b2(b3){var b4;while(true){b4=b3.s;if(N.Equals(b4,null)){if(b1.MoveNext()){b3.s=S.Get(b1.Current());b3=b3;}else{b1.Dispose();return false;}}else if(b4.MoveNext()){b3.c=b4.Current();return true;}else{b3.Dispose();b3.s=null;b3=b3;}}}b1=S.Get(b0);return new _4.New(null,null,b2,function(b3){var b4;b4=b3.s;if(!N.Equals(b4,null))b4.Dispose();if(!N.Equals(b1,null))b1.Dispose();});}};};y.map=function(b0,b1){return{GetEnumerator:function(){var b2;b2=S.Get(b1);return new _4.New(null,null,function(b3){return b2.MoveNext()&&(b3.c=b0(b2.Current()),true);},function(){b2.Dispose();});}};};y.append=function(b0,b1){return{GetEnumerator:function(){var b2,b3;b2=S.Get(b0);b3=[true];return new _4.New(b2,null,function(b4){var b5;return b4.s.MoveNext()?(b4.c=b4.s.Current(),true):(b5=b4.s,!N.Equals(b5,null)?b5.Dispose():void 0,b4.s=null,b3[0]&&(b3[0]=false,b4.s=S.Get(b1),b4.s.MoveNext()?(b4.c=b4.s.Current(),true):(b4.s.Dispose(),b4.s=null,false)));},function(b4){var b5;b5=b4.s;if(!N.Equals(b5,null))b5.Dispose();});}};};y.head=function(b0){var b1;b1=S.Get(b0);try{return b1.MoveNext()?b1.Current():y.insufficient();}finally{if(typeof b1=="object"&&"Dispose"in b1)b1.Dispose();}};y.unfold=function(b0,b1){return{GetEnumerator:function(){return new _4.New(b1,null,function(b2){var b3;b3=b0(b2.s);return b3==null?false:(b2.c=b3.$0[0],b2.s=b3.$0[1],true);},void 0);}};};y.findIndex=function(b0,b1){var b2;b2=y.tryFindIndex(b0,b1);return b2==null?e.FailWith("KeyNotFoundException"):b2.$0;};y.fold=function(b0,b1,b2){var b3,b4;b3=b1;b4=S.Get(b2);try{while(b4.MoveNext())b3=b0(b3,b4.Current());return b3;}finally{if(typeof b4=="object"&&"Dispose"in b4)b4.Dispose();}};y.forall2=function(b0,b1,b2){return!y.exists2(function(b3,b4){return!b0(b3,b4);},b1,b2);};y.tryFindIndex=function(b0,b1){var b2,b3,b4;b2=S.Get(b1);try{b3=true;b4=0;while(b3&&b2.MoveNext())if(b0(b2.Current()))b3=false;else b4=b4+1;return b3?null:{$:1,$0:b4};}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}};y.exists2=function(b0,b1,b2){var b3,b4,b5,b6;b3=S.Get(b1);try{b5=S.Get(b2);try{b6=false;while(!b6&&b3.MoveNext()&&b5.MoveNext())b6=b0(b3.Current(),b5.Current());b4=b6;}finally{if(typeof b5=="object"&&"Dispose"in b5)b5.Dispose();}return b4;}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}};y.rev=function(b0){return y.delay(function(){return F.ofSeq(b0).slice().reverse();});};y.distinctBy=function(b0,b1){return{GetEnumerator:function(){var b2,b3;b2=S.Get(b1);b3=new _1.New$3();return new _4.New(null,null,function(b4){var b5,b6;if(b2.MoveNext()){b5=b2.Current();b6=b3.SAdd(b0(b5));while(!b6&&b2.MoveNext()){b5=b2.Current();b6=b3.SAdd(b0(b5));}return b6&&(b4.c=b5,true);}else return false;},function(){b2.Dispose();});}};};y.nth=function(b0,b1){var b2,b3;if(b0<0)e.FailWith("negative index requested");b2=-1;b3=S.Get(b1);try{while(b2<b0){!b3.MoveNext()?y.insufficient():void 0;b2=b2+1;}return b3.Current();}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}};y.init=function(b0,b1){return y.take(b0,y.initInfinite(b1));};y.iter=function(b0,b1){var b2;b2=S.Get(b1);try{while(b2.MoveNext())b0(b2.Current());}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}};y.forall=function(b0,b1){return!y.exists(function(b2){return!b0(b2);},b1);};y.take=function(b0,b1){b0<0?y.nonNegative():void 0;return{GetEnumerator:function(){var b2;b2=[S.Get(b1)];return new _4.New(0,null,function(b3){var b4;b3.s=b3.s+1;return b3.s>b0?false:(b4=b2[0],N.Equals(b4,null)?y.insufficient():b4.MoveNext()?(b3.c=b4.Current(),b3.s===b0?(b4.Dispose(),b2[0]=null):void 0,true):(b4.Dispose(),b2[0]=null,y.insufficient()));},function(){var b3;b3=b2[0];if(!N.Equals(b3,null))b3.Dispose();});}};};y.initInfinite=function(b0){return{GetEnumerator:function(){return new _4.New(0,null,function(b1){b1.c=b0(b1.s);b1.s=b1.s+1;return true;},void 0);}};};y.max=function(b0){var b1,b2,b3;b1=S.Get(b0);try{if(!b1.MoveNext())y.seqEmpty();b2=b1.Current();while(b1.MoveNext()){b3=b1.Current();if(N.Compare(b3,b2)===1)b2=b3;}return b2;}finally{if(typeof b1=="object"&&"Dispose"in b1)b1.Dispose();}};y.compareWith=function(b0,b1,b2){var b3,b4,b5,b6,b7;b3=S.Get(b1);try{b5=S.Get(b2);try{b6=0;b7=true;while(b7&&b6===0)if(b3.MoveNext())b6=b5.MoveNext()?b0(b3.Current(),b5.Current()):1;else if(b5.MoveNext())b6=-1;else b7=false;b4=b6;}finally{if(typeof b5=="object"&&"Dispose"in b5)b5.Dispose();}return b4;}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}};y.exists=function(b0,b1){var b2,b3;b2=S.Get(b1);try{b3=false;while(!b3&&b2.MoveNext())b3=b0(b2.Current());return b3;}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}};y.seqEmpty=function(){return e.FailWith("The input sequence was empty.");};z.New=function(b0,b1){return{Symbol:b0,Quantity:b1};};B.ToSeq=function(b0){return y.map(function(b1){return[b1.Key,b1.Value];},U.Enumerate(false,b0.get_Tree()));};C.New=function(b0){return{Stocks:b0};};D=g.AttrProxy=bZ.Class({},null,D);D.Create=function(b0,b1){return W.Static(function(b2){b2.setAttribute(b0,b1);});};D.Concat=function(b0){var b1;b1=_6.ofSeqNonCopying(b0);return _6.TreeReduce(W.EmptyAttr(),D.Append,b1);};D.Append=function(b0,b1){return W.AppendTree(b0,b1);};E=l.T=bZ.Class({get_Item:function(b0){return y.nth(b0,this);},GetEnumerator:function(){return new _4.New(this,null,function(b0){var b1;b1=b0.s;return b1.$==0?false:(b0.c=b1.$0,b0.s=b1.$1,true);},void 0);}},null,E);E.Empty=new E({$:0});F.get=function(b0,b1){F.checkBounds(b0,b1);return b0[b1];};F.length=function(b0){return b0.dims===2?b0.length*b0.length:b0.length;};F.checkBounds=function(b0,b1){if(b1<0||b1>=b0.length)e.FailWith("Index was outside the bounds of the array.");};F.set=function(b0,b1,b2){F.checkBounds(b0,b1);b0[b1]=b2;};G.Handler=function(b0,b1){return W.Static(function(b2){b2.addEventListener(b0,function(b3){return(b1(b2))(b3);},false);});};G.Value=function(b0){return G.ValueWith(_7.StringApply(),b0);};G.OnAfterRender=function(b0){return new D({$:4,$0:b0});};G.DynamicCustom=function(b0,b1){return W.Dynamic(b1,b0);};G.ValueWith=function(b0,b1){var b2;b2=b0(b1);return D.Append(W.Static(b2[0]),G.DynamicCustom(b2[1],b2[2]));};H=A.FSharpMap=bZ.Class({TryFind:function(b0){var b1;b1=U.TryFind(V.New(b0,void 0),this.tree);return b1==null?null:{$:1,$0:b1.$0.Value};},Add$1:function(b0,b1){return new H.New$1(U.Add(V.New(b0,b1),this.tree));},Remove$1:function(b0){return new H.New$1(U.Remove(V.New(b0,void 0),this.tree));},get_Tree:function(){return this.tree;},GetEnumerator:function(){return S.Get(y.map(function(b0){return{K:b0.Key,V:b0.Value};},U.Enumerate(false,this.tree)));},Equals:function(b0){return this.Count()===b0.Count()&&y.forall2(N.Equals,this,b0);},Count:function(){var b0;b0=this.tree;return b0==null?0:b0.Count;},GetHashCode:function(){return N.Hash(F.ofSeq(this));},CompareTo0:function(b0){return y.compareWith(N.Compare,this,b0);}},f,H);H.New$1=bZ.Ctor(function(b0){f.New.call(this);this.tree=b0;},H);H.New=bZ.Ctor(function(b0){H.New$1.call(this,bv.fromSeq(b0));},H);I.WSDecimalMath=function(){Z.$cctor();return Z.WSDecimalMath;};I.CreateDecimalBits=function(b0){var b1,b2;return F.length(b0)===4?(b1=(F.get(b0,3)&-2147483648)!==0,(b2=F.get(b0,3)>>16&127,I.CreateDecimal(F.get(b0,0),F.get(b0,1),F.get(b0,2),b1,b2))):e.InvalidArg("bits","The length of the bits array is not 4");};I.CreateDecimal=function(b0,b1,b2,b3,b4){var b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp;function cq(cs){return I.WSDecimalMath().bignumber(cs);}function cr(cs){var ct,cu;return cs>=0?cq(cs):(ct=cq(cs),(cu=I.WSDecimalMath(),cu.add.apply(cu,[b5,ct])));}return b0===0&&b2===0&&b1===0?cq(0):(b5=(b6=(b7=cq(429496729),(b8=cq(10),(b9=I.WSDecimalMath(),b9.multiply.apply(b9,[b7,b8])))),(b_=cq(6),(b$=I.WSDecimalMath(),b$.add.apply(b$,[b6,b_])))),(ca=I.WSDecimalMath().pow(cq(10),I.WSDecimalMath().unaryMinus(cq(e.toInt(b4)))),(cb=(cc=(cd=(ce=(cf=cr(b2),(cg=I.WSDecimalMath(),cg.multiply.apply(cg,[cf,b5]))),(ch=cr(b1),(ci=I.WSDecimalMath(),ci.add.apply(ci,[ce,ch])))),(cj=I.WSDecimalMath(),cj.multiply.apply(cj,[cd,b5]))),(ck=cr(b0),(cl=I.WSDecimalMath(),cl.add.apply(cl,[cc,ck])))),(cm=b3?cq(-1):cq(1),(cn=(co=I.WSDecimalMath(),co.multiply.apply(co,[cm,cb])),(cp=I.WSDecimalMath(),cp.multiply.apply(cp,[cn,ca])))))));};L.GetFieldValues=function(b0){var b1,b2;b1=[];for(var b3 in b0)b1.push(b0[b3]);return b1;};M=A.Dictionary=bZ.Class({set_Item:function(b0,b1){this.set(b0,b1);},ContainsKey:function(b0){var b1,b2;b1=this;b2=this.data[this.hash(b0)];return b2==null?false:F.exists(function(b3){return b1.equals.apply(null,[(e.KeyValue(b3))[0],b0]);},b2);},TryGetValue:function(b0,b1){var b2,b3,b4;b2=this;b3=this.data[this.hash(b0)];return b3==null?false:(b4=F.tryPick(function(b5){var b6;b6=e.KeyValue(b5);return b2.equals.apply(null,[b6[0],b0])?{$:1,$0:b6[1]}:null;},b3),b4!=null&&b4.$==1&&(b1.set(b4.$0),true));},RemoveKey:function(b0){return this.remove(b0);},Keys:function(){return new bb.New(this);},set:function(b0,b1){var b2,b3,b4,b5;b2=this;b3=this.hash(b0);b4=this.data[b3];if(b4==null){this.count=this.count+1;this.data[b3]=new a.Array({K:b0,V:b1});}else{b5=F.tryFindIndex(function(b6){return b2.equals.apply(null,[(e.KeyValue(b6))[0],b0]);},b4);b5==null?(this.count=this.count+1,b4.push({K:b0,V:b1})):b4[b5.$0]={K:b0,V:b1};}},remove:function(b0){var b1,b2,b3,b4;b1=this;b2=this.hash(b0);b3=this.data[b2];return b3==null?false:(b4=F.filter(function(b5){return!b1.equals.apply(null,[(e.KeyValue(b5))[0],b0]);},b3),F.length(b4)<b3.length&&(this.count=this.count-1,this.data[b2]=b4,true));},Item:function(b0){return this.get(b0);},GetEnumerator:function(){return S.Get0(F.concat(L.GetFieldValues(this.data)));},get:function(b0){var b1,b2;b1=this;b2=this.data[this.hash(b0)];return b2==null?_8.notPresent():F.pick(function(b3){var b4;b4=e.KeyValue(b3);return b1.equals.apply(null,[b4[0],b0])?{$:1,$0:b4[1]}:null;},b2);}},f,M);M.New$5=bZ.Ctor(function(){M.New$6.call(this,[],N.Equals,N.Hash);},M);M.New$6=bZ.Ctor(function(b0,b1,b2){var b3,b4;f.New.call(this);this.equals=b1;this.hash=b2;this.count=0;this.data=[];b3=S.Get(b0);try{while(b3.MoveNext()){b4=b3.Current();this.set(b4.K,b4.V);}}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}},M);N.Equals=function(b0,b1){var b2,b3,b4,b5;if(b0===b1)return true;else{b2=typeof b0;if(b2=="object"){if(b0===null||b0===void 0||b1===null||b1===void 0||!N.Equals(typeof b1,"object"))return false;else if("Equals"in b0)return b0.Equals(b1);else if("Equals"in b1)return false;else if(b0 instanceof a.Array&&b1 instanceof a.Array)return N.arrayEquals(b0,b1);else if(b0 instanceof bV&&b1 instanceof bV)return N.dateEquals(b0,b1);else{b3=[true];for(var b6 in b0)if(function(b7){b3[0]=!b0.hasOwnProperty(b7)||b1.hasOwnProperty(b7)&&N.Equals(b0[b7],b1[b7]);return!b3[0];}(b6))break;if(b3[0]){for(var b7 in b1)if(function(b8){b3[0]=!b1.hasOwnProperty(b8)||b0.hasOwnProperty(b8);return!b3[0];}(b7))break;}return b3[0];}}else return b2=="function"&&("$Func"in b0?b0.$Func===b1.$Func&&b0.$Target===b1.$Target:"$Invokes"in b0&&"$Invokes"in b1&&N.arrayEquals(b0.$Invokes,b1.$Invokes));}};N.arrayEquals=function(b0,b1){var b2,b3;if(F.length(b0)===F.length(b1)){b2=true;b3=0;while(b2&&b3<F.length(b0)){!N.Equals(F.get(b0,b3),F.get(b1,b3))?b2=false:void 0;b3=b3+1;}return b2;}else return false;};N.dateEquals=function(b0,b1){return b0.getTime()===b1.getTime();};N.Hash=function(b0){var b1;b1=typeof b0;return b1=="function"?0:b1=="boolean"?b0?1:0:b1=="number"?b0:b1=="string"?N.hashString(b0):b1=="object"?b0==null?0:b0 instanceof a.Array?N.hashArray(b0):N.hashObject(b0):0;};N.Compare=function(b0,b1){var b2,b3,b4,b5,b6,b7;if(b0===b1)return 0;else{b3=typeof b0;switch(b3=="function"?1:b3=="boolean"?2:b3=="number"?2:b3=="string"?2:b3=="object"?3:0){case 0:return typeof b1=="undefined"?0:-1;case 1:return e.FailWith("Cannot compare function values.");case 2:return b0<b1?-1:1;case 3:if(b0===null)b4=-1;else if(b1===null)b4=1;else if("CompareTo"in b0)b4=b0.CompareTo(b1);else if("CompareTo0"in b0)b4=b0.CompareTo0(b1);else if(b0 instanceof a.Array&&b1 instanceof a.Array)b4=N.compareArrays(b0,b1);else if(b0 instanceof bV&&b1 instanceof bV)b4=N.compareDates(b0,b1);else{b5=[0];for(var b8 in b0)if(function(b9){return!b0.hasOwnProperty(b9)?false:!b1.hasOwnProperty(b9)?(b5[0]=1,true):(b5[0]=N.Compare(b0[b9],b1[b9]),b5[0]!==0);}(b8))break;if(b5[0]===0){for(var b9 in b1)if(function(b_){return!b1.hasOwnProperty(b_)?false:!b0.hasOwnProperty(b_)&&(b5[0]=-1,true);}(b9))break;}b4=b5[0];}return b4;}}};N.hashString=function(b0){var b1,b2,b3;if(b0===null)return 0;else{b1=5381;for(b2=0,b3=b0.length-1;b2<=b3;b2++)b1=N.hashMix(b1,b0[b2].charCodeAt());return b1;}};N.hashArray=function(b0){var b1,b2,b3;b1=-34948909;for(b2=0,b3=F.length(b0)-1;b2<=b3;b2++)b1=N.hashMix(b1,N.Hash(F.get(b0,b2)));return b1;};N.hashObject=function(b0){var b1,b2;if("GetHashCode"in b0)return b0.GetHashCode();else{b1=[0];for(var b3 in b0)if(function(b4){b1[0]=N.hashMix(N.hashMix(b1[0],N.hashString(b4)),N.Hash(b0[b4]));return false;}(b3))break;return b1[0];}};N.compareArrays=function(b0,b1){var b2,b3;if(F.length(b0)<F.length(b1))return -1;else if(F.length(b0)>F.length(b1))return 1;else{b2=0;b3=0;while(b2===0&&b3<F.length(b0)){b2=N.Compare(F.get(b0,b3),F.get(b1,b3));b3=b3+1;}return b2;}};N.compareDates=function(b0,b1){return N.Compare(b0.getTime(),b1.getTime());};N.hashMix=function(b0,b1){return(b0<<5)+b0+b1;};P.Int=function(){P.set_counter(P.counter()+1);return P.counter();};P.set_counter=function(b0){bh.$cctor();bh.counter=b0;};P.counter=function(){bh.$cctor();return bh.counter;};Q.$cctor=function(){Q.$cctor=a.ignore;Q.math=self.math;if(typeof bX==="undefined")bW.log("Math.js library is not loaded");Q.mathInstance=c.createMathInstance();Q.random=new T.New();Q.transactions=h.Create$1(E.Empty);Q.portfolio=h.Create$1(C.New(new H.New([])));};R.TryParseInt32=function(b0,b1){return R.TryParse(b0,-2147483648,2147483647,b1);};S.Get=function(b0){return b0 instanceof a.Array?S.ArrayEnumerator(b0):N.Equals(typeof b0,"string")?S.StringEnumerator(b0):b0.GetEnumerator();};S.ArrayEnumerator=function(b0){return new _4.New(0,null,function(b1){var b2;b2=b1.s;return b2<F.length(b0)&&(b1.c=F.get(b0,b2),b1.s=b2+1,true);},void 0);};S.StringEnumerator=function(b0){return new _4.New(0,null,function(b1){var b2;b2=b1.s;return b2<b0.length&&(b1.c=b0[b2],b1.s=b2+1,true);},void 0);};S.Get0=function(b0){return b0 instanceof a.Array?S.ArrayEnumerator(b0):N.Equals(typeof b0,"string")?S.StringEnumerator(b0):"GetEnumerator0"in b0?b0.GetEnumerator0():b0.GetEnumerator();};T=d.Random=bZ.Class({Next:function(b0,b1){return b0>b1?e.FailWith("'minValue' cannot be greater than maxValue."):b0+bY.floor(bY.random()*(b1-b0));}},f,T);T.New=bZ.Ctor(function(){f.New.call(this);},T);U.TryFind=function(b0,b1){var b2;b2=(U.Lookup(b0,b1))[0];return b2==null?null:{$:1,$0:b2.Node};};U.Add=function(b0,b1){return U.Put(function(b2,b3){return b3;},b0,b1);};U.Remove=function(b0,b1){var b2,b3,b4,b5;b2=U.Lookup(b0,b1);b3=b2[0];b4=b2[1];return b3==null?b1:b3.Right==null?U.Rebuild(b4,b3.Left):b3.Left==null?U.Rebuild(b4,b3.Right):U.Rebuild(b4,(b5=F.ofSeq(y.append(U.Enumerate(false,b3.Left),U.Enumerate(false,b3.Right))),U.Build(b5,0,b5.length-1)));};U.Enumerate=function(b0,b1){function b2(b3,b4){var b5;while(true)if(b3==null)return b4.$==1?{$:1,$0:[b4.$0[0],[b4.$0[1],b4.$1]]}:null;else if(b0){b5=b3;b3=b5.Right;b4=new E({$:1,$0:[b5.Node,b5.Left],$1:b4});}else{b5=b3;b3=b5.Left;b4=new E({$:1,$0:[b5.Node,b5.Right],$1:b4});}}return y.unfold(function(b3){return b2(b3[0],b3[1]);},[b1,E.Empty]);};U.Lookup=function(b0,b1){var b2,b3,b4,b5;b2=[];b3=b1;b4=true;while(b4)if(b3==null)b4=false;else{b5=N.Compare(b0,b3.Node);if(b5===0)b4=false;else b5===1?(b2.unshift([true,b3.Node,b3.Left]),b3=b3.Right):(b2.unshift([false,b3.Node,b3.Right]),b3=b3.Left);}return[b3,b2];};U.Put=function(b0,b1,b2){var b3,b4;b3=U.Lookup(b1,b2);b4=b3[0];return b4==null?U.Rebuild(b3[1],U.Branch(b1,null,null)):U.Rebuild(b3[1],U.Branch(b0(b4.Node,b1),b4.Left,b4.Right));};U.Rebuild=function(b0,b1){var b2,b4,b5,b6,b7,b8,b9,b_,b$,ca;function b3(cb){return cb==null?0:cb.Height;}b2=b1;for(b4=0,b5=F.length(b0)-1;b4<=b5;b4++){b2=(b6=F.get(b0,b4),b6[0]?(b7=b6[1],(b8=b6[2],b3(b2)>b3(b8)+1?b3(b2.Left)===b3(b2.Right)+1?(b9=b2.Left,U.Branch(b9.Node,U.Branch(b7,b8,b9.Left),U.Branch(b2.Node,b9.Right,b2.Right))):U.Branch(b2.Node,U.Branch(b7,b8,b2.Left),b2.Right):U.Branch(b7,b8,b2))):(b_=b6[1],(b$=b6[2],b3(b2)>b3(b$)+1?b3(b2.Right)===b3(b2.Left)+1?(ca=b2.Right,U.Branch(ca.Node,U.Branch(b2.Node,b2.Left,ca.Left),U.Branch(b_,ca.Right,b$))):U.Branch(b2.Node,b2.Left,U.Branch(b_,b2.Right,b$)):U.Branch(b_,b2,b$))));}return b2;};U.Branch=function(b0,b1,b2){var b3,b4;return _5.New(b0,b1,b2,1+(b3=b1==null?0:b1.Height,(b4=b2==null?0:b2.Height,N.Compare(b3,b4)===1?b3:b4)),1+(b1==null?0:b1.Count)+(b2==null?0:b2.Count));};U.Build=function(b0,b1,b2){var b3,b4,b5;return b2-b1+1<=0?null:(b3=(b1+b2)/2>>0,(b4=U.Build(b0,b1,b3-1),(b5=U.Build(b0,b3+1,b2),U.Branch(F.get(b0,b3),b4,b5))));};V=A.Pair=bZ.Class({Equals:function(b0){return N.Equals(this.Key,b0.Key);},GetHashCode:function(){return N.Hash(this.Key);},CompareTo0:function(b0){return N.Compare(this.Key,b0.Key);}},null,V);V.New=function(b0,b1){return new V({Key:b0,Value:b1});};W.Static=function(b0){return new D({$:3,$0:b0});};W.AppendTree=function(b0,b1){var b2;return b0===null?b1:b1===null?b0:(b2=new D({$:2,$0:b0,$1:b1}),(W.SetFlags(b2,W.Flags(b0)|W.Flags(b1)),b2));};W.Dynamic=function(b0,b1){return new D({$:1,$0:new bx.New(b0,b1)});};W.Updates=function(b0){return _6.MapTreeReduce(function(b1){return b1.NChanged();},Y.Const(),Y.Map2Unit,b0.DynNodes);};W.EmptyAttr=function(){bj.$cctor();return bj.EmptyAttr;};W.SetFlags=function(b0,b1){b0.flags=b1;};W.Flags=function(b0){return b0!==null&&b0.hasOwnProperty("flags")?b0.flags:0;};W.Insert=function(b0,b1){var b2,b3,b4;function b5(b6){var b7,b8;while(true)if(!(b6===null)){if(b6!=null&&b6.$==1)return b2.push(b6.$0);else if(b6!=null&&b6.$==2){b7=b6.$1;b8=b6.$0;b5(b8);b6=b7;}else return b6!=null&&b6.$==3?b6.$0(b0):b6!=null&&b6.$==4?b3.push(b6.$0):null;}else return null;}b2=[];b3=[];b5(b1);b4=b2.slice(0);return bo.New(b0,W.Flags(b1),b4,b3.length===0?null:{$:1,$0:function(b6){y.iter(function(b7){b7(b6);},b3);}});};W.HasExitAnim=function(b0){var b1;b1=2;return(b0.DynFlags&b1)===b1;};W.GetExitAnim=function(b0){return W.GetAnim(b0,function(b1,b2){return b1.NGetExitAnim(b2);});};W.HasEnterAnim=function(b0){var b1;b1=1;return(b0.DynFlags&b1)===b1;};W.GetEnterAnim=function(b0){return W.GetAnim(b0,function(b1,b2){return b1.NGetEnterAnim(b2);});};W.HasChangeAnim=function(b0){var b1;b1=4;return(b0.DynFlags&b1)===b1;};W.GetChangeAnim=function(b0){return W.GetAnim(b0,function(b1,b2){return b1.NGetChangeAnim(b2);});};W.GetAnim=function(b0,b1){return be.Concat(F.map(function(b2){return b1(b2,b0.DynElem);},b0.DynNodes));};W.Sync=function(b0,b1){F.iter(function(b2){b2.NSync(b0);},b1.DynNodes);};X.ParseHTMLIntoFakeRoot=function(b0){var b1,b2,b3,b4,b5;function b6(b7,b8){var b9;while(true)if(b8===0)return b7;else{b9=b8;b7=b7.lastChild;b8=b9-1;}}b1=self.document.createElement("div");return!X.rhtml().test(b0)?(b1.appendChild(self.document.createTextNode(b0)),b1):(b2=(b3=X.rtagName().exec(b0),N.Equals(b3,null)?"":F.get(b3,1).toLowerCase()),(b4=(b5=(X.wrapMap())[b2],b5?b5:X.defaultWrap()),(b1.innerHTML=b4[1]+b0.replace(X.rxhtmlTag(),"<$1></$2>")+b4[2],b6(b1,b4[0]))));};X.rhtml=function(){bA.$cctor();return bA.rhtml;};X.wrapMap=function(){bA.$cctor();return bA.wrapMap;};X.defaultWrap=function(){bA.$cctor();return bA.defaultWrap;};X.rxhtmlTag=function(){bA.$cctor();return bA.rxhtmlTag;};X.rtagName=function(){bA.$cctor();return bA.rtagName;};X.IterSelector=function(b0,b1,b2){var b3,b4,b5;b3=b0.querySelectorAll(b1);for(b4=0,b5=b3.length-1;b4<=b5;b4++)b2(b3[b4]);};X.InsertAt=function(b0,b1,b2){var b3;if(!(b2.parentNode===b0&&b1===(b3=b2.nextSibling,N.Equals(b3,null)?null:b3)))b0.insertBefore(b2,b1);};X.RemoveNode=function(b0,b1){if(b1.parentNode===b0)b0.removeChild(b1);};Y.Const=function(b0){var b1;b1=x.New({$:0,$0:b0});return function(){return b1;};};Y.Map=function(b0,b1){return Y.CreateLazy(function(){return x.Map(b0,b1());});};Y.Bind=function(b0,b1){return Y.Join(Y.Map(b0,b1));};Y.CreateLazy=function(b0){var b1;b1={c:null,o:b0};return function(){var b2,b3;b2=b1.c;return b2===null?(b2=b1.o(),b1.c=b2,(b3=b2.s,b3!=null&&b3.$==0)?b1.o=null:x.WhenObsoleteRun(b2,function(){b1.c=null;}),b2):b2;};};Y.Sink=function(b0,b1){function b2(){x.WhenRun(b1(),b0,function(){bs.scheduler().Fork(b2);});}bs.scheduler().Fork(b2);};Y.Map2Unit=function(b0,b1){return Y.CreateLazy(function(){return x.Map2Unit(b0(),b1());});};Y.Join=function(b0){return Y.CreateLazy(function(){return x.Join(b0());});};Z.$cctor=function(){var b0;Z.$cctor=a.ignore;Z.WSDecimalMath=bX.create((b0={},b0.number="BigNumber",b0.precision=29,b0.predictable=true,b0.epsilon=1E-60,b0));};_0.$cctor=function(){_0.$cctor=a.ignore;_0.LoadedTemplates=new M.New$5();_0.LocalTemplatesLoaded=false;_0.GlobalHoles=new M.New$5();_0.TextHoleRE="\\${([^}]+)}";_0.RenderedFullDocTemplate=null;};_1=A.HashSet=bZ.Class({SAdd:function(b0){return this.add(b0);},Contains:function(b0){var b1;b1=this.data[this.hash(b0)];return b1==null?false:this.arrContains(b0,b1);},add:function(b0){var b1,b2;b1=this.hash(b0);b2=this.data[b1];return b2==null?(this.data[b1]=[b0],this.count=this.count+1,true):this.arrContains(b0,b2)?false:(b2.push(b0),this.count=this.count+1,true);},arrContains:function(b0,b1){var b2,b3,b4,b5;b2=true;b3=0;b5=b1.length;while(b2&&b3<b5)if(this.equals.apply(null,[b1[b3],b0]))b2=false;else b3=b3+1;return!b2;},GetEnumerator:function(){return S.Get(bD.concat(this.data));},ExceptWith:function(b0){var b1;b1=S.Get(b0);try{while(b1.MoveNext())this.Remove(b1.Current());}finally{if(typeof b1=="object"&&"Dispose"in b1)b1.Dispose();}},Count:function(){return this.count;},IntersectWith:function(b0){var b1,b2,b3,b4,b5;b1=new _1.New$4(b0,this.equals,this.hash);b2=bD.concat(this.data);for(b3=0,b4=b2.length-1;b3<=b4;b3++){b5=b2[b3];if(!b1.Contains(b5))this.Remove(b5);}},Remove:function(b0){var b1;b1=this.data[this.hash(b0)];return b1==null?false:this.arrRemove(b0,b1)&&(this.count=this.count-1,true);},CopyTo:function(b0,b1){var b2,b3,b4;b2=bD.concat(this.data);for(b3=0,b4=b2.length-1;b3<=b4;b3++)F.set(b0,b3+b1,b2[b3]);},arrRemove:function(b0,b1){var b2,b3,b4,b5;b2=true;b3=0;b5=b1.length;while(b2&&b3<b5)if(this.equals.apply(null,[b1[b3],b0])){b1.splice.apply(b1,[b3,1]);b2=false;}else b3=b3+1;return!b2;}},f,_1);_1.New$3=bZ.Ctor(function(){_1.New$4.call(this,[],N.Equals,N.Hash);},_1);_1.New$4=bZ.Ctor(function(b0,b1,b2){var b3;f.New.call(this);this.equals=b1;this.hash=b2;this.data=[];this.count=0;b3=S.Get(b0);try{while(b3.MoveNext())this.add(b3.Current());}finally{if(typeof b3=="object"&&"Dispose"in b3)b3.Dispose();}},_1);_1.New$2=bZ.Ctor(function(b0){_1.New$4.call(this,b0,N.Equals,N.Hash);},_1);Y=g.View=bZ.Class({},null,Y);_3.LinkElement=function(b0,b1){_3.InsertDoc(b0,b1,null);};_3.CreateEmbedNode=function(){return{Current:null,Dirty:false};};_3.UpdateEmbedNode=function(b0,b1){b0.Current=b1;b0.Dirty=true;};_3.InsertDoc=function(b0,b1,b2){var b3,b4,b5;while(true)if(b1!=null&&b1.$==1)return _3.InsertNode(b0,b1.$0.El,b2);else if(b1!=null&&b1.$==2){b3=b1.$0;b3.Dirty=false;b1=b3.Current;}else if(b1==null)return b2;else if(b1!=null&&b1.$==4)return _3.InsertNode(b0,b1.$0.Text,b2);else if(b1!=null&&b1.$==5)return _3.InsertNode(b0,b1.$0,b2);else if(b1!=null&&b1.$==6)return F.foldBack(function(b6,b7){return(((bZ.Curried3(function(b8,b9,b_){return b9==null||b9.constructor===_?_3.InsertDoc(b8,b9,b_):_3.InsertNode(b8,b9,b_);}))(b0))(b6))(b7);},b1.$0.Els,b2);else{b4=b1.$1;b5=b1.$0;b1=b5;b2=_3.InsertDoc(b0,b4,b2);}};_3.CreateRunState=function(b0,b1){return bq.New(br.get_Empty(),_3.CreateElemNode(b0,W.EmptyAttr(),b1));};_3.PerformAnimatedUpdate=function(b0,b1,b2){var b3;return be.get_UseAnimations()?(b3=null,bs.Delay(function(){var b4,b5,b6;b4=br.FindAll(b2);b5=_3.ComputeChangeAnim(b1,b4);b6=_3.ComputeEnterAnim(b1,b4);return bs.Bind(be.Play(be.Append(b5,_3.ComputeExitAnim(b1,b4))),function(){return bs.Bind(_3.SyncElemNodesNextFrame(b0,b1),function(){return bs.Bind(be.Play(b6),function(){b1.PreviousNodes=b4;return bs.Return(null);});});});})):_3.SyncElemNodesNextFrame(b0,b1);};_3.PerformSyncUpdate=function(b0,b1,b2){var b3;b3=br.FindAll(b2);_3.SyncElemNode(b0,b1.Top);b1.PreviousNodes=b3;};_3.InsertNode=function(b0,b1,b2){X.InsertAt(b0,b2,b1);return b1;};_3.CreateElemNode=function(b0,b1,b2){var b3;_3.LinkElement(b0,b2);b3=W.Insert(b0,b1);return bc.New(b3,b2,null,b0,P.Int(),bZ.GetOptional(b3.OnAfterRender));};_3.SyncElemNodesNextFrame=function(b0,b1){function b2(b3){a.requestAnimationFrame(function(){_3.SyncElemNode(b0,b1.Top);b3();});}return bf.BatchUpdatesEnabled()?bs.FromContinuations(function(b3,b4,b5){return b2.apply(null,[b3,b4,b5]);}):(_3.SyncElemNode(b0,b1.Top),bs.Return(null));};_3.ComputeExitAnim=function(b0,b1){return be.Concat(F.map(function(b2){return W.GetExitAnim(b2.Attr);},br.ToArray(br.Except(b1,br.Filter(function(b2){return W.HasExitAnim(b2.Attr);},b0.PreviousNodes)))));};_3.ComputeEnterAnim=function(b0,b1){return be.Concat(F.map(function(b2){return W.GetEnterAnim(b2.Attr);},br.ToArray(br.Except(b0.PreviousNodes,br.Filter(function(b2){return W.HasEnterAnim(b2.Attr);},b1)))));};_3.ComputeChangeAnim=function(b0,b1){var b2;function b3(b4){return W.HasChangeAnim(b4.Attr);}b2=function(b4){return br.Filter(b3,b4);};return be.Concat(F.map(function(b4){return W.GetChangeAnim(b4.Attr);},br.ToArray(br.Intersect(b2(b0.PreviousNodes),b2(b1)))));};_3.SyncElemNode=function(b0,b1){!b0?_3.SyncElement(b1):void 0;_3.Sync(b1.Children);_3.AfterRender(b1);};_3.SyncElement=function(b0){function b1(b2){function b3(b4){var b5,b6,b7,b8;while(true){if(b4!=null&&b4.$==0){b6=b4.$1;b7=b4.$0;if(b3(b7))return true;else b4=b6;}else if(b4!=null&&b4.$==2){b8=b4.$0;if(b8.Dirty)return true;else b4=b8.Current;}else return b4!=null&&b4.$==6&&(b5=b4.$0,b5.Dirty||F.exists(b1,b5.Holes));}}return b3(b2.Children);}W.Sync(b0.El,b0.Attr);if(b1(b0))_3.DoSyncElement(b0);};_3.Sync=function(b0){var b1,b2,b3,b4,b5;while(true){if(b0!=null&&b0.$==1)return _3.SyncElemNode(false,b0.$0);else if(b0!=null&&b0.$==2){b3=b0.$0;b0=b3.Current;}else if(b0==null)return null;else if(b0!=null&&b0.$==5)return null;else if(b0!=null&&b0.$==4){b1=b0.$0;return b1.Dirty?(b1.Text.nodeValue=b1.Value,b1.Dirty=false):null;}else if(b0!=null&&b0.$==6){b2=b0.$0;F.iter(function(b6){_3.SyncElemNode(false,b6);},b2.Holes);F.iter(function(b6){W.Sync(b6[0],b6[1]);},b2.Attrs);return _3.AfterRender(b2);}else{b4=b0.$1;b5=b0.$0;_3.Sync(b5);b0=b4;}}};_3.AfterRender=function(b0){var b1;b1=bZ.GetOptional(b0.Render);if(b1!=null&&b1.$==1){b1.$0(b0.El);bZ.SetOptional(b0,"Render",null);}};_3.DoSyncElement=function(b0){var b1,b2,b3;function b4(b5,b6){var b7,b8,b9,b_;while(true){if(b5!=null&&b5.$==1)return b5.$0.El;else if(b5!=null&&b5.$==2){b8=b5.$0;if(b8.Dirty){b8.Dirty=false;return _3.InsertDoc(b1,b8.Current,b6);}else b5=b8.Current;}else if(b5==null)return b6;else if(b5!=null&&b5.$==4)return b5.$0.Text;else if(b5!=null&&b5.$==5)return b5.$0;else if(b5!=null&&b5.$==6){b7=b5.$0;b7.Dirty?b7.Dirty=false:void 0;return F.foldBack(function(b$,ca){return b$==null||b$.constructor===_?b4(b$,ca):b$;},b7.Els,b6);}else{b9=b5.$1;b_=b5.$0;b5=b_;b6=b4(b9,b6);}}}b1=b0.El;bP.Iter((b2=b0.El,function(b5){X.RemoveNode(b2,b5);}),bP.Except(bP.DocChildren(b0),bP.Children(b0.El,bZ.GetOptional(b0.Delimiters))));b4(b0.Children,(b3=bZ.GetOptional(b0.Delimiters),b3!=null&&b3.$==1?b3.$0[1]:null));};x.Obsolete=function(b0){var b1,b2,b3,b4,b5;b2=b0.s;if(b2==null||(b2!=null&&b2.$==2?(b1=b2.$1,false):b2!=null&&b2.$==3?(b1=b2.$1,false):true))void 0;else{b0.s=null;for(b3=0,b4=F.length(b1)-1;b3<=b4;b3++){b5=F.get(b1,b3);if(typeof b5=="object")(function(b6){x.Obsolete(b6);}(b5));else b5();}}};x.New=function(b0){return{s:b0};};_4=S.T=bZ.Class({MoveNext:function(){var b0;b0=this.n(this);this.e=b0?1:2;return b0;},Current:function(){return this.e===1?this.c:this.e===0?e.FailWith("Enumeration has not started. Call MoveNext."):e.FailWith("Enumeration already finished.");},Dispose:function(){if(this.d)this.d(this);}},f,_4);_4.New=bZ.Ctor(function(b0,b1,b2,b3){f.New.call(this);this.s=b0;this.c=b1;this.n=b2;this.d=b3;this.e=0;},_4);_5.New=function(b0,b1,b2,b3,b4){return{Node:b0,Left:b1,Right:b2,Height:b3,Count:b4};};_6.ofSeqNonCopying=function(b0){var b1,b2;if(b0 instanceof a.Array)return b0;else if(b0 instanceof E)return F.ofList(b0);else if(b0===null)return[];else{b1=[];b2=S.Get(b0);try{while(b2.MoveNext())b1.push(b2.Current());return b1;}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}}};_6.TreeReduce=function(b0,b1,b2){var b3;function b4(b5){return function(b6){var b7,b8;switch(b6<=0?0:b6===1?b5>=0&&b5<b3?1:(b7=b6,2):(b7=b6,2)){case 0:return b0;case 1:return F.get(b2,b5);case 2:b8=b6/2>>0;return b1((b4(b5))(b8),(b4(b5+b8))(b6-b8));}};}b3=F.length(b2);return(b4(0))(b3);};_6.MapTreeReduce=function(b0,b1,b2,b3){var b4;function b5(b6){return function(b7){var b8,b9;switch(b7<=0?0:b7===1?b6>=0&&b6<b4?1:(b8=b7,2):(b8=b7,2)){case 0:return b1;case 1:return b0(F.get(b3,b6));case 2:b9=b7/2>>0;return b2((b5(b6))(b9),(b5(b6+b9))(b7-b9));}};}b4=F.length(b3);return(b5(0))(b4);};F.exists=function(b0,b1){var b2,b3,b4,b5;b2=false;b3=0;b5=F.length(b1);while(!b2&&b3<b5)if(b0(b1[b3]))b2=true;else b3=b3+1;return b2;};F.tryPick=function(b0,b1){var b2,b3,b4;b2=null;b3=0;while(b3<b1.length&&b2==null){b4=b0(b1[b3]);if(b4!=null&&b4.$==1)b2=b4;b3=b3+1;}return b2;};F.tryFindIndex=function(b0,b1){var b2,b3;b2=null;b3=0;while(b3<b1.length&&b2==null){b0(b1[b3])?b2={$:1,$0:b3}:void 0;b3=b3+1;}return b2;};F.ofList=function(b0){var b1,b2;b2=[];b1=b0;while(!(b1.$==0)){b2.push(l.head(b1));b1=l.tail(b1);}return b2;};F.ofSeq=function(b0){var b1,b2;if(b0 instanceof a.Array)return b0.slice();else if(b0 instanceof E)return F.ofList(b0);else{b1=[];b2=S.Get(b0);try{while(b2.MoveNext())b1.push(b2.Current());return b1;}finally{if(typeof b2=="object"&&"Dispose"in b2)b2.Dispose();}}};F.filter=function(b0,b1){var b2,b3,b4;b2=[];for(b3=0,b4=b1.length-1;b3<=b4;b3++)if(b0(b1[b3]))b2.push(b1[b3]);return b2;};F.map=function(b0,b1){var b2,b3,b4;b2=new a.Array(b1.length);for(b3=0,b4=b1.length-1;b3<=b4;b3++)b2[b3]=b0(b1[b3]);return b2;};F.iter=function(b0,b1){var b2,b3;for(b2=0,b3=b1.length-1;b2<=b3;b2++)b0(b1[b2]);};F.foldBack=function(b0,b1,b2){var b3,b4,b5,b6,b7;b3=b2;b5=b1.length;for(b6=1,b7=b5;b6<=b7;b6++)b3=b0(b1[b5-b6],b3);return b3;};F.concat=function(b0){return a.Array.prototype.concat.apply([],F.ofSeq(b0));};F.pick=function(b0,b1){var b2;b2=F.tryPick(b0,b1);return b2==null?e.FailWith("KeyNotFoundException"):b2.$0;};F.sortInPlace=function(b0){F.mapInPlace(function(b1){return b1[0];},F.mapiInPlace(function(b1,b2){return[b2,b1];},b0).sort(N.Compare));};F.choose=function(b0,b1){var b2,b3,b4,b5;b2=[];for(b3=0,b4=b1.length-1;b3<=b4;b3++){b5=b0(b1[b3]);if(b5==null);else b2.push(b5.$0);}return b2;};F.create=function(b0,b1){var b2,b3,b4;b2=new a.Array(b0);for(b3=0,b4=b0-1;b3<=b4;b3++)b2[b3]=b1;return b2;};F.init=function(b0,b1){var b2,b3,b4;if(b0<0)e.FailWith("Negative size given.");else null;b2=new a.Array(b0);for(b3=0,b4=b0-1;b3<=b4;b3++)b2[b3]=b1(b3);return b2;};F.forall=function(b0,b1){var b2,b3,b4,b5;b2=true;b3=0;b5=F.length(b1);while(b2&&b3<b5)if(b0(b1[b3]))b3=b3+1;else b2=false;return b2;};_7.StringApply=function(){bj.$cctor();return bj.StringApply;};_7.ApplyValue=function(b0,b1,b2){var b3;function b4(b5,b6){return b6==null?null:b5(b6.$0);}b3=null;return[function(b5){function b6(){b2.UpdateMaybe(function(b7){var b8;b3=b0(b5);return b3!=null&&b3.$==1&&(!N.Equals(b3.$0,b7)&&(b8=[b3,b3.$0],true))?b8[0]:null;});}b5.addEventListener("change",b6);b5.addEventListener("input",b6);b5.addEventListener("keypress",b6);},function(b5){var b6;b6=b1(b5);return function(b7){return b4(b6,b7);};},Y.Map(function(b5){var b6;return b3!=null&&b3.$==1&&(N.Equals(b3.$0,b5)&&(b6=b3.$0,true))?null:{$:1,$0:b5};},b2.get_View())];};_7.StringSet=function(){bj.$cctor();return bj.StringSet;};_7.StringGet=function(){bj.$cctor();return bj.StringGet;};_7.DateTimeSetUnchecked=function(){bj.$cctor();return bj.DateTimeSetUnchecked;};_7.DateTimeGetUnchecked=function(){bj.$cctor();return bj.DateTimeGetUnchecked;};_7.FileApplyValue=function(b0,b1,b2){var b3;function b4(b5,b6){return b6==null?null:b5(b6.$0);}b3=null;return[function(b5){b5.addEventListener("change",function(){b2.UpdateMaybe(function(b6){var b7;b3=b0(b5);return b3!=null&&b3.$==1&&(b3.$0!==b6&&(b7=[b3,b3.$0],true))?b7[0]:null;});});},function(b5){var b6;b6=b1(b5);return function(b7){return b4(b6,b7);};},Y.Map(function(b5){var b6;return b3!=null&&b3.$==1&&(N.Equals(b3.$0,b5)&&(b6=b3.$0,true))?null:{$:1,$0:b5};},b2.get_View())];};_7.FileSetUnchecked=function(){bj.$cctor();return bj.FileSetUnchecked;};_7.FileGetUnchecked=function(){bj.$cctor();return bj.FileGetUnchecked;};_7.IntSetUnchecked=function(){bj.$cctor();return bj.IntSetUnchecked;};_7.IntGetUnchecked=function(){bj.$cctor();return bj.IntGetUnchecked;};_7.IntSetChecked=function(){bj.$cctor();return bj.IntSetChecked;};_7.IntGetChecked=function(){bj.$cctor();return bj.IntGetChecked;};_7.FloatSetUnchecked=function(){bj.$cctor();return bj.FloatSetUnchecked;};_7.FloatGetUnchecked=function(){bj.$cctor();return bj.FloatGetUnchecked;};_7.FloatSetChecked=function(){bj.$cctor();return bj.FloatSetChecked;};_7.FloatGetChecked=function(){bj.$cctor();return bj.FloatGetChecked;};_8.notPresent=function(){throw new bG.New();};$.convertTextNode=function(b0){var b1,b2,b3,b4,b5,b6;b1=null;b2=0;b4=b0.textContent;b5=new a.RegExp(s.TextHoleRE(),"g");while(b1=b5.exec(b4),b1!==null){b0.parentNode.insertBefore(self.document.createTextNode(ba.string(b4,{$:1,$0:b2},{$:1,$0:b5.lastIndex-F.get(b1,0).length-1})),b0);b2=b5.lastIndex;b6=self.document.createElement("span");b6.setAttribute("ws-replace",F.get(b1,1).toLowerCase());b0.parentNode.insertBefore(b6,b0);}b5.lastIndex=0;b0.textContent=ba.string(b4,{$:1,$0:b2},null);};$.failNotLoaded=function(b0){bW.warn("Instantiating non-loaded template",b0);};$.fillTextHole=function(b0,b1,b2){var b3;b3=b0.querySelector("[ws-replace]");return N.Equals(b3,null)?(bW.warn("Filling non-existent text hole",b2),null):(b3.parentNode.replaceChild(self.document.createTextNode(b1),b3),{$:1,$0:b3.getAttribute("ws-replace")});};$.removeHolesExcept=function(b0,b1){function b2(b3){s.foreachNotPreserved(b0,"["+b3+"]",function(b4){if(!b1.Contains(b4.getAttribute(b3)))b4.removeAttribute(b3);});}b2("ws-attr");b2("ws-onafterrender");b2("ws-var");s.foreachNotPreserved(b0,"[ws-hole]",function(b3){if(!b1.Contains(b3.getAttribute("ws-hole"))){b3.removeAttribute("ws-hole");while(b3.hasChildNodes())b3.removeChild(b3.lastChild);}});s.foreachNotPreserved(b0,"[ws-replace]",function(b3){if(!b1.Contains(b3.getAttribute("ws-replace")))b3.parentNode.removeChild(b3);});s.foreachNotPreserved(b0,"[ws-on]",function(b3){b3.setAttribute("ws-on",bm.concat(" ",F.filter(function(b4){return b1.Contains(F.get(bm.SplitChars(b4,[":"],1),1));},bm.SplitChars(b3.getAttribute("ws-on"),[" "],1))));});s.foreachNotPreserved(b0,"[ws-attr-holes]",function(b3){var b4,b5,b6,b7,b8;b4=bm.SplitChars(b3.getAttribute("ws-attr-holes"),[" "],1);for(b5=0,b6=b4.length-1;b5<=b6;b5++){b7=F.get(b4,b5);b3.setAttribute(b7,(b8=new a.RegExp(s.TextHoleRE(),"g"),b3.getAttribute(b7).replace(b8,function(b9,b_){return b1.Contains(b_)?b9:"";})));}});};$.fillInstanceAttrs=function(b0,b1){var b2,b3,b4,b5,b6;$.convertAttrs(b1);b2=b1.nodeName.toLowerCase();b3=b0.querySelector("[ws-attr="+b2+"]");if(N.Equals(b3,null))bW.warn("Filling non-existent attr hole",b2);else{b3.removeAttribute("ws-attr");for(b4=0,b5=b1.attributes.length-1;b4<=b5;b4++){b6=b1.attributes.item(b4);if(b6.name=="class"&&b3.hasAttribute("class"))b3.setAttribute("class",b3.getAttribute("class")+" "+b6.nodeValue);else b3.setAttribute(b6.name,b6.nodeValue);}}};$.mapHoles=function(b0,b1){function b2(b3){s.foreachNotPreserved(b0,"["+b3+"]",function(b4){var b5,b6;b5=(b6=null,[b1.TryGetValue(b4.getAttribute(b3).toLowerCase(),{get:function(){return b6;},set:function(b7){b6=b7;}}),b6]);if(b5[0])b4.setAttribute(b3,b5[1]);});}b2("ws-hole");b2("ws-replace");b2("ws-attr");b2("ws-onafterrender");b2("ws-var");s.foreachNotPreserved(b0,"[ws-on]",function(b3){b3.setAttribute("ws-on",bm.concat(" ",F.map(function(b4){var b5,b6,b7;b5=bm.SplitChars(b4,[":"],1);b6=(b7=null,[b1.TryGetValue(F.get(b5,1),{get:function(){return b7;},set:function(b8){b7=b8;}}),b7]);return b6[0]?F.get(b5,0)+":"+b6[1]:b4;},bm.SplitChars(b3.getAttribute("ws-on"),[" "],1))));});s.foreachNotPreserved(b0,"[ws-attr-holes]",function(b3){var b4,b5,b6;b4=bm.SplitChars(b3.getAttribute("ws-attr-holes"),[" "],1);for(b5=0,b6=b4.length-1;b5<=b6;b5++)(function(){var b7;function b8(b9,b_){var b$;b$=e.KeyValue(b_);return b9.replace(new a.RegExp("\\${"+b$[0]+"}","ig"),"${"+b$[1]+"}");}b7=F.get(b4,b5);return b3.setAttribute(b7,(((bZ.Curried3(y.fold))(b8))(b3.getAttribute(b7)))(b1));}());});};$.fill=function(b0,b1,b2){while(true)if(b0.hasChildNodes())b2=b1.insertBefore(b0.lastChild,b2);else return null;};$.convertAttrs=function(b0){var b2,b3,b4,b5,b6,b7,b8,b9;function b1(b_){var b$;b$=b0.getAttribute(b_);if(b$==null);else b0.setAttribute(b_,b$.toLowerCase());}b2=b0.attributes;b3=[];b4=[];b5=[];for(b6=0,b7=b2.length-1;b6<=b7;b6++){b8=b2.item(b6);if(bm.StartsWith(b8.nodeName,"ws-on")&&b8.nodeName!="ws-onafterrender"&&b8.nodeName!="ws-on"){b3.push(b8.nodeName);b4.push(ba.string(b8.nodeName,{$:1,$0:"ws-on".length},null)+":"+b8.nodeValue.toLowerCase());}else!bm.StartsWith(b8.nodeName,"ws-")&&(new a.RegExp(s.TextHoleRE())).test(b8.nodeValue)?(b8.nodeValue=(b9=new a.RegExp(s.TextHoleRE(),"g"),b8.nodeValue.replace(b9,function(b_,b$){return"${"+b$.toLowerCase()+"}";})),b5.push(b8.nodeName)):void 0;}if(!(b4.length==0))b0.setAttribute("ws-on",bm.concat(" ",b4));if(!(b5.length==0))b0.setAttribute("ws-attr-holes",bm.concat(" ",b5));b1("ws-hole");b1("ws-replace");b1("ws-attr");b1("ws-onafterrender");b1("ws-var");F.iter(function(b_){b0.removeAttribute(b_);},b3);};ba.string=function(b0,b1,b2){var b3,b4;return b1==null?b2!=null&&b2.$==1?(b3=b2.$0,b3<0?"":b0.slice(0,b3+1)):"":b2==null?b0.slice(b1.$0):(b4=b2.$0,b4<0?"":b0.slice(b1.$0,b4+1));};y.insufficient=function(){return e.FailWith("The input sequence has an insufficient number of elements.");};F.mapiInPlace=function(b0,b1){var b2,b3;for(b2=0,b3=b1.length-1;b2<=b3;b2++)b1[b2]=b0(b2,b1[b2]);return b1;};F.mapInPlace=function(b0,b1){var b2,b3;for(b2=0,b3=b1.length-1;b2<=b3;b2++)b1[b2]=b0(b1[b2]);};y.nonNegative=function(){return e.FailWith("The input must be non-negative.");};bb=A.KeyCollection=bZ.Class({GetEnumerator:function(){return S.Get(y.map(function(b0){return b0.K;},this.d));}},f,bb);bb.New=bZ.Ctor(function(b0){f.New.call(this);this.d=b0;},bb);bc=g.DocElemNode=bZ.Class({Equals:function(b0){return this.ElKey===b0.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bc);bc.New=function(b0,b1,b2,b3,b4,b5){var b6;return new bc((b6={Attr:b0,Children:b1,El:b3,ElKey:b4},(bZ.SetOptional(b6,"Delimiters",b2),bZ.SetOptional(b6,"Render",b5),b6)));};be.get_UseAnimations=function(){return bt.UseAnimations();};be.Play=function(b0){var b1;b1=null;return bs.Delay(function(){return bs.Bind(be.Run(a.ignore,bt.Actions(b0)),function(){bt.Finalize(b0);return bs.Return(null);});});};be.Append=function(b0,b1){return{$:0,$0:bC.Append(b0.$0,b1.$0)};};be.Run=function(b0,b1){var b2;function b3(b4){function b5(b6){return function(b7){var b8;b8=b7-b6;b1.Compute(b8);b0();return b8<=b2?void a.requestAnimationFrame(function(b9){(b5(b6))(b9);}):b4();};}a.requestAnimationFrame(function(b6){(b5(b6))(b6);});}b2=b1.Duration;return b2===0?bs.Zero():bs.FromContinuations(function(b4,b5,b6){return b3.apply(null,[b4,b5,b6]);});};be.Concat=function(b0){return{$:0,$0:bC.Concat(y.map(bt.List,b0))};};be.get_Empty=function(){return{$:0,$0:bC.Empty()};};bf.BatchUpdatesEnabled=function(){bu.$cctor();return bu.BatchUpdatesEnabled;};bg.StartProcessor=function(b0){var b1;function b2(){var b3;b3=null;return bs.Delay(function(){return bs.Bind(b0,function(){var b4;b4=b1[0];return N.Equals(b4,1)?(b1[0]=0,bs.Zero()):N.Equals(b4,2)?(b1[0]=1,b2()):bs.Zero();});});}b1=[0];return function(){var b3;b3=b1[0];if(N.Equals(b3,0)){b1[0]=1;bs.Start(b2(),null);}else N.Equals(b3,1)?b1[0]=2:void 0;};};bh.$cctor=function(){bh.$cctor=a.ignore;bh.counter=0;};bi=g.Elt=bZ.Class({},t,bi);bi.New=function(b0,b1,b2){var b3,b4;b3=_3.CreateElemNode(b0,b1,b2.docNode);b4=bw.Create(b2.updates);return new bi.New$1({$:1,$0:b3},Y.Map2Unit(W.Updates(b3.Attr),b4.v),b0,b4);};bi.New$1=bZ.Ctor(function(b0,b1,b2,b3){t.New.call(this,b0,b1);this.docNode$1=b0;this.updates$1=b1;this.elt=b2;this.rvUpdates=b3;},bi);bj.$cctor=function(){var b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb;bj.$cctor=a.ignore;bj.EmptyAttr=null;bj.BoolCheckedApply=function(cc){function cd(ce,cf){return cf!=null&&cf.$==1?void(ce.checked=cf.$0):null;}return[function(ce){ce.addEventListener("change",function(){return cc.Get()!=ce.checked?cc.Set(ce.checked):null;});},function(ce){return function(cf){return cd(ce,cf);};},Y.Map(function(ce){return{$:1,$0:ce};},cc.get_View())];};bj.StringSet=function(cc){return function(cd){cc.value=cd;};};bj.StringGet=function(cc){return{$:1,$0:cc.value};};bj.StringApply=(b0=_7.StringGet(),(b1=_7.StringSet(),function(cc){return _7.ApplyValue(b0,b1,cc);}));bj.DateTimeSetUnchecked=function(cc){return function(cd){cc.value=(new bV(cd)).toLocaleString();};};bj.DateTimeGetUnchecked=function(cc){var cd,ce,cf,cg;cd=cc.value;return by.isBlank(cd)?{$:1,$0:-8640000000000000}:(ce=(cf=0,[(cg=bF.TryParse(cd),cg!=null&&cg.$==1&&(cf=cg.$0,true)),cf]),ce[0]?{$:1,$0:ce[1]}:null);};bj.DateTimeApplyUnchecked=(b2=_7.DateTimeGetUnchecked(),(b3=_7.DateTimeSetUnchecked(),function(cc){return _7.ApplyValue(b2,b3,cc);}));bj.FileSetUnchecked=function(){return function(){return null;};};bj.FileGetUnchecked=function(cc){var cd;cd=cc.files;return{$:1,$0:F.ofSeq(y.delay(function(){return y.map(function(ce){return cd.item(ce);},e.range(0,cd.length-1));}))};};bj.FileApplyUnchecked=(b4=_7.FileGetUnchecked(),(b5=_7.FileSetUnchecked(),function(cc){return _7.FileApplyValue(b4,b5,cc);}));bj.IntSetUnchecked=function(cc){return function(cd){cc.value=a.String(cd);};};bj.IntGetUnchecked=function(cc){var cd,ce;cd=cc.value;return by.isBlank(cd)?{$:1,$0:0}:(ce=+cd,ce!==ce>>0?null:{$:1,$0:ce});};bj.IntApplyUnchecked=(b6=_7.IntGetUnchecked(),(b7=_7.IntSetUnchecked(),function(cc){return _7.ApplyValue(b6,b7,cc);}));bj.IntSetChecked=function(cc){return function(cd){var ce;ce=cd.get_Input();return cc.value!=ce?void(cc.value=ce):null;};};bj.IntGetChecked=function(cc){var cd,ce,cf;cd=cc.value;return{$:1,$0:by.isBlank(cd)?(cc.checkValidity?cc.checkValidity():true)?new bz({$:2,$0:cd}):new bz({$:1,$0:cd}):(ce=(cf=0,[R.TryParseInt32(cd,{get:function(){return cf;},set:function(cg){cf=cg;}}),cf]),ce[0]?new bz({$:0,$0:ce[1],$1:cd}):new bz({$:1,$0:cd}))};};bj.IntApplyChecked=(b8=_7.IntGetChecked(),(b9=_7.IntSetChecked(),function(cc){return _7.ApplyValue(b8,b9,cc);}));bj.FloatSetUnchecked=function(cc){return function(cd){cc.value=a.String(cd);};};bj.FloatGetUnchecked=function(cc){var cd,ce;cd=cc.value;return by.isBlank(cd)?{$:1,$0:0}:(ce=+cd,a.isNaN(ce)?null:{$:1,$0:ce});};bj.FloatApplyUnchecked=(b_=_7.FloatGetUnchecked(),(b$=_7.FloatSetUnchecked(),function(cc){return _7.ApplyValue(b_,b$,cc);}));bj.FloatSetChecked=function(cc){return function(cd){var ce;ce=cd.get_Input();return cc.value!=ce?void(cc.value=ce):null;};};bj.FloatGetChecked=function(cc){var cd,ce;cd=cc.value;return{$:1,$0:by.isBlank(cd)?(cc.checkValidity?cc.checkValidity():true)?new bz({$:2,$0:cd}):new bz({$:1,$0:cd}):(ce=+cd,a.isNaN(ce)?new bz({$:1,$0:cd}):new bz({$:0,$0:ce,$1:cd}))};};bj.FloatApplyChecked=(ca=_7.FloatGetChecked(),(cb=_7.FloatSetChecked(),function(cc){return _7.ApplyValue(ca,cb,cc);}));};bl=d.ArgumentException=bZ.Class({},bk,bl);bl.New=bZ.Ctor(function(b0,b1){bl.New$2.call(this,b1+"\nParameter name: "+b0);},bl);bl.New$2=bZ.Ctor(function(b0){this.message=b0;_.setPrototypeOf(this,bl.prototype);},bl);bm.concat=function(b0,b1){return F.ofSeq(b1).join(b0);};bm.SplitChars=function(b0,b1,b2){return bm.Split(b0,new a.RegExp("["+bm.RegexEscape(b1.join(""))+"]"),b2);};bm.StartsWith=function(b0,b1){return b0.substring(0,b1.length)==b1;};bm.Split=function(b0,b1,b2){return b2===1?F.filter(function(b3){return b3!=="";},bm.SplitWith(b0,b1)):bm.SplitWith(b0,b1);};bm.RegexEscape=function(b0){return b0.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bm.forall=function(b0,b1){return y.forall(b0,bm.protect(b1));};bm.SplitWith=function(b0,b1){return b0.split(b1);};bm.protect=function(b0){return b0==null?"":b0;};bo.New=function(b0,b1,b2,b3){var b4;b4={DynElem:b0,DynFlags:b1,DynNodes:b2};bZ.SetOptional(b4,"OnAfterRender",b3);return b4;};bq.New=function(b0,b1){return{PreviousNodes:b0,Top:b1};};br.get_Empty=function(){return{$:0,$0:new _1.New$3()};};br.FindAll=function(b0){var b1;function b2(b5,b6){var b7,b8,b9,b_,b$;while(true)switch(b5){case 0:if(b6!=null&&b6.$==0){b8=b6.$1;b9=b6.$0;b2(0,b9);b6=b8;}else if(b6!=null&&b6.$==1){b_=b6.$0;b6=b_;b5=1;}else if(b6!=null&&b6.$==2){b$=b6.$0;b6=b$.Current;}else return b6!=null&&b6.$==6?(b7=b6.$0.Holes,(function(ca){return function(cb){F.iter(ca,cb);};}(b4))(b7)):null;break;case 1:b1.push(b6);b6=b6.Children;b5=0;break;}}function b3(b5){return b2(0,b5);}function b4(b5){return b2(1,b5);}b1=[];b3(b0);return{$:0,$0:new _1.New$2(b1)};};br.Filter=function(b0,b1){return{$:0,$0:bM.Filter(b0,b1.$0)};};br.Except=function(b0,b1){return{$:0,$0:bM.Except(b0.$0,b1.$0)};};br.ToArray=function(b0){return bM.ToArray(b0.$0);};br.Intersect=function(b0,b1){return{$:0,$0:bM.Intersect(b0.$0,b1.$0)};};bs.Delay=function(b0){return function(b1){try{(b0(null))(b1);}catch(b2){b1.k({$:1,$0:b2});}};};bs.Bind=function(b0,b1){return bs.checkCancel(function(b2){b0(bJ.New(function(b3){var b4;if(b3.$==0){b4=b3.$0;bs.scheduler().Fork(function(){try{(b1(b4))(b2);}catch(b5){b2.k({$:1,$0:b5});}});}else bs.scheduler().Fork(function(){b2.k(b3);});},b2.ct));});};bs.Zero=function(){bK.$cctor();return bK.Zero;};bs.Start=function(b0,b1){var b2,b3;b2=(b3=(bs.defCTS())[0],b1==null?b3:b1.$0);bs.scheduler().Fork(function(){if(!b2.c)b0(bJ.New(function(b4){if(b4.$==1)bs.UncaughtAsyncError(b4.$0);},b2));});};bs.Return=function(b0){return function(b1){b1.k({$:0,$0:b0});};};bs.scheduler=function(){bK.$cctor();return bK.scheduler;};bs.checkCancel=function(b0){return function(b1){if(b1.ct.c)bs.cancel(b1);else b0(b1);};};bs.defCTS=function(){bK.$cctor();return bK.defCTS;};bs.UncaughtAsyncError=function(b0){bW.log("WebSharper: Uncaught asynchronous exception",b0);};bs.FromContinuations=function(b0){return function(b1){var b2;function b3(b4){if(b2[0])e.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{b2[0]=true;bs.scheduler().Fork(b4);}}b2=[false];b0(function(b4){b3(function(){b1.k({$:0,$0:b4});});},function(b4){b3(function(){b1.k({$:1,$0:b4});});},function(b4){b3(function(){b1.k({$:2,$0:b4});});});};};bs.cancel=function(b0){b0.k({$:2,$0:new bQ.New(b0.ct)});};bt.UseAnimations=function(){bB.$cctor();return bB.UseAnimations;};bt.Actions=function(b0){return bt.ConcatActions(F.choose(function(b1){return b1.$==1?{$:1,$0:b1.$0}:null;},bC.ToArray(b0.$0)));};bt.Finalize=function(b0){F.iter(function(b1){if(b1.$==0)b1.$0();},bC.ToArray(b0.$0));};bt.ConcatActions=function(b0){var b1,b2,b3,b4;b1=_6.ofSeqNonCopying(b0);b2=F.length(b1);return b2===0?bt.Const():b2===1?F.get(b1,0):(b3=y.max(y.map(function(b5){return b5.Duration;},b1)),(b4=F.map(function(b5){return bt.Prolong(b3,b5);},b1),bt.Def(b3,function(b5){F.iter(function(b6){b6.Compute(b5);},b4);})));};bt.List=function(b0){return b0.$0;};bt.Const=function(b0){return bt.Def(0,function(){return b0;});};bt.Def=function(b0,b1){return{Compute:b1,Duration:b0};};bt.Prolong=function(b0,b1){var b2,b3,b4;b2=b1.Compute;b3=b1.Duration;b4=bR.Create(function(){return b1.Compute(b1.Duration);});return{Compute:function(b5){return b5>=b3?b4.f():b2(b5);},Duration:b0};};bu.$cctor=function(){bu.$cctor=a.ignore;bu.BatchUpdatesEnabled=true;};bv.fromSeq=function(b0){var b1;b1=F.ofSeq(y.map(function(b2){return V.New(b2[0],b2[1]);},y.distinctBy(function(b2){return b2[0];},y.rev(b0))));F.sortInPlace(b1);return U.Build(b1,0,b1.length-1);};bw=g.Updates=bZ.Class({},null,bw);bw.Create=function(b0){var b1;b1=null;b1=bw.New(b0,null,function(){var b2;b2=b1.s;return b2===null?(b2=x.Copy(b1.c()),b1.s=b2,x.WhenObsoleteRun(b2,function(){b1.s=null;}),b2):b2;});return b1;};bw.New=function(b0,b1,b2){return new bw({c:b0,s:b1,v:b2});};bx=g.DynamicAttrNode=bZ.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(b0){return be.get_Empty();},NGetEnterAnim:function(b0){return be.get_Empty();},NGetChangeAnim:function(b0){return be.get_Empty();},NSync:function(b0){if(this.dirty){(this.push(b0))(this.value);this.dirty=false;}}},f,bx);bx.New=bZ.Ctor(function(b0,b1){var b2;b2=this;f.New.call(this);this.push=b1;this.value=void 0;this.dirty=false;this.updates=Y.Map(function(b3){b2.value=b3;b2.dirty=true;},b0);},bx);by.isBlank=function(b0){return bm.forall(bE.IsWhiteSpace,b0);};bz=g.CheckedInput=bZ.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,bz);bA.$cctor=function(){var b0;bA.$cctor=a.ignore;bA.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bA.rtagName=new a.RegExp("<([\\w:]+)");bA.rhtml=new a.RegExp("<|&#?\\w+;");bA.wrapMap=(b0=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:b0,tbody:b0,tfoot:b0,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bA.defaultWrap=[0,"",""];};bB.$cctor=function(){bB.$cctor=a.ignore;bB.CubicInOut=bI.Custom(function(b0){var b1;b1=b0*b0;return 3*b1-2*(b1*b0);});bB.UseAnimations=true;};bC.Append=function(b0,b1){return b0.$==0?b1:b1.$==0?b0:{$:2,$0:b0,$1:b1};};bC.ToArray=function(b0){var b1;function b2(b3){var b4,b5;while(true)if(b3.$==1)return b1.push(b3.$0);else if(b3.$==2){b4=b3.$1;b5=b3.$0;b2(b5);b3=b4;}else return b3.$==3?F.iter(function(b6){b1.push(b6);},b3.$0):null;}b1=[];b2(b0);return b1.slice(0);};bC.Concat=function(b0){var b1;b1=_6.ofSeqNonCopying(b0);return _6.TreeReduce(bC.Empty(),bC.Append,b1);};bC.Empty=function(){bS.$cctor();return bS.Empty;};bD.concat=function(b0){var b1,b2;b1=[];for(var b3 in b0)b1.push.apply(b1,b0[b3]);return b1;};bE.IsWhiteSpace=function(b0){return b0.match(new a.RegExp("\\s"))!==null;};bF.TryParse=function(b0){var b1;b1=bV.parse(b0);return a.isNaN(b1)?null:{$:1,$0:b1};};R.TryParse=function(b0,b1,b2,b3){var b4,b5;b4=+b0;b5=b4===b4-b4%1&&b4>=b1&&b4<=b2;if(b5)b3.set(b4);return b5;};bG=d.KeyNotFoundException=bZ.Class({},bk,bG);bG.New=bZ.Ctor(function(){bG.New$1.call(this,"The given key was not present in the dictionary.");},bG);bG.New$1=bZ.Ctor(function(b0){this.message=b0;_.setPrototypeOf(this,bG.prototype);},bG);bH=bs.Scheduler=bZ.Class({Fork:function(b0){var b1;b1=this;this.robin.push(b0);if(this.idle){this.idle=false;a.setTimeout(function(){b1.tick();},0);}},tick:function(){var b0,b1,b2;b1=this;b2=bV.now();b0=true;while(b0)if(this.robin.length===0){this.idle=true;b0=false;}else{(this.robin.shift())();bV.now()-b2>40?(a.setTimeout(function(){b1.tick();},0),b0=false):void 0;}}},f,bH);bH.New=bZ.Ctor(function(){f.New.call(this);this.idle=true;this.robin=[];},bH);bI=g.Easing=bZ.Class({},f,bI);bI.Custom=function(b0){return new bI.New(b0);};bI.New=bZ.Ctor(function(b0){f.New.call(this);this.transformTime=b0;},bI);bJ.New=function(b0,b1){return{k:b0,ct:b1};};bK.$cctor=function(){bK.$cctor=a.ignore;bK.noneCT=bL.New(false,[]);bK.scheduler=new bH.New();bK.defCTS=[new bO.New()];bK.Zero=bs.Return();bK.GetCT=function(b0){b0.k({$:0,$0:b0.ct});};};bL.New=function(b0,b1){return{c:b0,r:b1};};bM.Filter=function(b0,b1){return new _1.New$2(F.filter(b0,bM.ToArray(b1)));};bM.Except=function(b0,b1){var b2;b2=new _1.New$2(bM.ToArray(b1));b2.ExceptWith(bM.ToArray(b0));return b2;};bM.ToArray=function(b0){var b1;b1=F.create(b0.Count(),void 0);b0.CopyTo(b1,0);return b1;};bM.Intersect=function(b0,b1){var b2;b2=new _1.New$2(bM.ToArray(b0));b2.IntersectWith(bM.ToArray(b1));return b2;};bN.Clear=function(b0){b0.splice(0,F.length(b0));};bO=d.CancellationTokenSource=bZ.Class({},f,bO);bO.New=bZ.Ctor(function(){f.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bO);bP.Children=function(b0,b1){var b2,b3,b4;if(b1!=null&&b1.$==1){b4=[];b2=b1.$0[0].nextSibling;while(b2!==b1.$0[1]){b4.push(b2);b2=b2.nextSibling;}return{$:0,$0:b4};}else return{$:0,$0:F.init(b0.childNodes.length,(b3=b0.childNodes,function(b5){return b3[b5];}))};};bP.Except=function(b0,b1){var b2;b2=b0.$0;return{$:0,$0:F.filter(function(b3){return F.forall(function(b4){return!(b3===b4);},b2);},b1.$0)};};bP.Iter=function(b0,b1){F.iter(b0,b1.$0);};bP.DocChildren=function(b0){var b1;function b2(b3){var b4,b5,b6,b7;while(true){if(b3!=null&&b3.$==2){b5=b3.$0;b3=b5.Current;}else if(b3!=null&&b3.$==1)return b1.push(b3.$0.El);else if(b3==null)return null;else if(b3!=null&&b3.$==5)return b1.push(b3.$0);else if(b3!=null&&b3.$==4)return b1.push(b3.$0.Text);else if(b3!=null&&b3.$==6){b4=b3.$0.Els;return(function(b8){return function(b9){F.iter(b8,b9);};}(function(b8){if(b8==null||b8.constructor===_)b2(b8);else b1.push(b8);}))(b4);}else{b6=b3.$1;b7=b3.$0;b2(b7);b3=b6;}}}b1=[];b2(b0.Children);return{$:0,$0:_6.ofSeqNonCopying(b1)};};bQ=d.OperationCanceledException=bZ.Class({},bk,bQ);bQ.New=bZ.Ctor(function(b0){bQ.New$1.call(this,"The operation was canceled.",null,b0);},bQ);bQ.New$1=bZ.Ctor(function(b0,b1,b2){this.message=b0;this.inner=b1;_.setPrototypeOf(this,bQ.prototype);this.ct=b2;},bQ);bR.Create=function(b0){return bU.New(false,b0,bR.forceLazy);};bR.forceLazy=function(){var b0;b0=this.v();this.c=true;this.v=b0;this.f=bR.cachedLazy;return b0;};bR.cachedLazy=function(){return this.v;};bS.$cctor=function(){bS.$cctor=a.ignore;bS.Empty={$:0};};bU.New=function(b0,b1,b2){return{c:b0,v:b1,f:b2};};bZ.OnLoad(function(){c.Main();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
