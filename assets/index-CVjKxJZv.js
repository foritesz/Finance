(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))c(y);new MutationObserver(y=>{for(const N of y)if(N.type==="childList")for(const $ of N.addedNodes)$.tagName==="LINK"&&$.rel==="modulepreload"&&c($)}).observe(document,{childList:!0,subtree:!0});function l(y){const N={};return y.integrity&&(N.integrity=y.integrity),y.referrerPolicy&&(N.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?N.credentials="include":y.crossOrigin==="anonymous"?N.credentials="omit":N.credentials="same-origin",N}function c(y){if(y.ep)return;y.ep=!0;const N=l(y);fetch(y.href,N)}})();(function(h){Date.now||(Date.now=function(){return new Date().getTime()}),Math.trunc||(Math.trunc=function(s){return s<0?Math.ceil(s):Math.floor(s)}),Object.setPrototypeOf||(Object.setPrototypeOf=function(s,l){return s.__proto__=l,s}),h.WebSharper={Runtime:{Ctor:function(s,l){return s.prototype=l.prototype,s},Class:function(s,l,c){var y=s;if(l){y=new l;for(var N in s)y[N]=s[N]}var $=function(we){if(we)for(var Oe in we)this[Oe]=we[Oe]};if($.prototype=y,c)for(var Z in c)$[Z]=c[Z];return $},Clone:function(s){var l={};for(var c of Object.getOwnPropertyNames(s))l[c]=s[c];return Object.setPrototypeOf(l,Object.getPrototypeOf(s)),l},NewObject:function(s){for(var l={},c=0;c<s.length;c++)l[s[c][0]]=s[c][1];return l},PrintObject:function(s){var l="{ ",c=!0;for(var y of Object.getOwnPropertyNames(s))c?c=!1:l+=", ",l+=y+" = "+s[y];return c?l+="}":l+=" }",l},DeleteEmptyFields:function(s,l){for(var c=0;c<l.length;c++){var y=l[c];s[y]===void 0&&delete s[y]}return s},GetOptional:function(s){return s===void 0?null:{$:1,$0:s}},SetOptional:function(s,l,c){c?s[l]=c.$0:delete s[l]},SetOrDelete:function(s,l,c){c===void 0?delete s[l]:s[l]=c},Apply:function(s,l,c){return s.apply(l,c)},Bind:function(s,l){return function(){return s.apply(this,arguments)}},CreateFuncWithArgs:function(s){return function(){return s(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(s){return function(){return s(this)}},CreateFuncWithThis:function(s){return function(){return s(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(s){return function(){return s(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(s,l){return function(){return l(Array.prototype.slice.call(arguments,0,s).concat([Array.prototype.slice.call(arguments,s)]))}},CreateFuncWithArgsRest:function(s,l){return function(){return l([Array.prototype.slice.call(arguments,0,s),Array.prototype.slice.call(arguments,s)])}},BindDelegate:function(s,l){var c=s.bind(l);return c.$Func=s,c.$Target=l,c},CreateDelegate:function(s){if(s.length==0)return null;if(s.length==1)return s[0];var l=function(){for(var c,y=0;y<s.length;y++)c=s[y].apply(null,arguments);return c};return l.$Invokes=s,l},CombineDelegates:function(s){for(var l=[],c=0;c<s.length;c++){var y=s[c];y&&("$Invokes"in y?l=l.concat(y.$Invokes):l.push(y))}return WebSharper.Runtime.CreateDelegate(l)},DelegateEqual:function(s,l){if(s===l)return!0;if(s==null||l==null)return!1;var c=s.$Invokes||[s],y=l.$Invokes||[l];if(c.length!=y.length)return!1;for(var N=0;N<c.length;N++){var $=c[N],Z=y[N];if(!($===Z||"$Func"in $&&"$Func"in Z&&$.$Func===Z.$Func&&$.$Target==Z.$Target))return!1}return!0},ThisFunc:function(s){return function(){var l=Array.prototype.slice.call(arguments);return l.unshift(this),s.apply(null,l)}},ThisFuncOut:function(s){return function(){var l=Array.prototype.slice.call(arguments);return s.apply(l.shift(),l)}},ParamsFunc:function(s,l){return function(){var c=Array.prototype.slice.call(arguments);return l.apply(null,c.slice(0,s).concat([c.slice(s)]))}},ParamsFuncOut:function(s,l){return function(){var c=Array.prototype.slice.call(arguments);return l.apply(null,c.slice(0,s).concat(c[s]))}},ThisParamsFunc:function(s,l){return function(){var c=Array.prototype.slice.call(arguments);return c.unshift(this),l.apply(null,c.slice(0,s+1).concat([c.slice(s+1)]))}},ThisParamsFuncOut:function(s,l){return function(){var c=Array.prototype.slice.call(arguments);return l.apply(c.shift(),c.slice(0,s).concat(c[s]))}},Curried:function(s,l,c){return c=c||[],function(y){var N=c.concat([y===void 0?null:y]);return l==1?s.apply(null,N):l==2?function($){return s.apply(null,N.concat([$===void 0?null:$]))}:WebSharper.Runtime.Curried(s,l-1,N)}},Curried2:function(s){return function(l){return function(c){return s(l,c)}}},Curried3:function(s){return function(l){return function(c){return function(y){return s(l,c,y)}}}},UnionByType:function(s,l,c){for(var y=typeof l,N=0;N<s.length;N++){var $=s[N];if(typeof $=="number"){if(Array.isArray(l)&&($==0||l.length==$))return{$:N,$0:l}}else if($==y)return{$:N,$0:l}}if(!c)throw new Error("Type not expected for creating Choice value.")},MarkResizable:function(s){return Object.defineProperty(s,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),s},MarkReadOnly:function(s){return Object.defineProperty(s,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),s},ScriptBasePath:"./",ScriptPath:function(s,l){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":s+"/")+l},OnLoad:function(s){"load"in this||(this.load=[]),this.load.push(s)},Start:function(){function s(l){for(var c=0;c<l.length;c++)l[c]()}"load"in this&&(s(this.load),this.load=[])}}},h.WebSharper.Runtime.OnLoad(function(){h.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()}),h.ignore=function(){},h.id=function(s){return s},h.fst=function(s){return s[0]},h.snd=function(s){return s[1]},h.trd=function(s){return s[2]},h.console||(h.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);(function(h,s){s=h.Element.prototype,s.matches||(s.matches=s.msMatchesSelector||function(l){for(var c=(this.document||this.ownerDocument).querySelectorAll(l),y=0;c[y]&&c[y]!==e;++y);return!!c[y]}),s.closest||(s.closest=function(l){for(var c=this;c&&c.nodeType==1;){if(c.matches(l))return c;c=c.parentNode}return null})})(self);(function(){for(var h=0,s=["webkit","moz"],l=0;l<s.length&&!window.requestAnimationFrame;++l)window.requestAnimationFrame=window[s[l]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[s[l]+"CancelAnimationFrame"]||window[s[l]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(c,y){var N=new Date().getTime(),$=Math.max(0,16-(N-h)),Z=window.setTimeout(function(){c(N+$)},$);return h=N+$,Z}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(c){clearTimeout(c)})})();(function(h){var s,l,c,y,N,$,Z,we,Oe,St,J,Nt,Et,At,st,Ie,Me,k,d,ft,Bt,ze,D,S,pt,K,Tt,Je,B,H,p,fe,Ce,Q,Qe,Dt,$e,v,_e,Re,pe,ht,q,Ze,R,Le,U,ne,O,Xe,ae,X,I,se,xt,me,b,Ft,Be,ee,Pe,Ye,et,te,yt,kt,Ue,Ae,x,dt,Te,_,It,Mt,He,Rt,re,L,ue,tt,Lt,be,nt,Ke,Se,oe,je,ye,$t,qt,Pt,De,rt,We,vt,he,Ut,de,bt,it,qe,xe,Ge,ut,Wt,Vt,Fe,Ne,gt,ot,E;s=h.FinancialApp=h.FinancialApp||{},l=s.Client=s.Client||{},c=h.WebSharper=h.WebSharper||{},y=c.Operators=c.Operators||{},N=c.Obj=c.Obj||{},$=c.UI=c.UI||{},Z=$.Var$1=$.Var$1||{},we=$.Var=$.Var||{},Oe=$.HtmlModule=$.HtmlModule||{},St=Oe.attr=Oe.attr||{},J=c.List=c.List||{},Nt=l.Transaction=l.Transaction||{},Et=h.System=h.System||{},At=Et.Guid=Et.Guid||{},st=l.TransactionType=l.TransactionType||{},Ie=l.Category=l.Category||{},Me=$.Client=$.Client||{},k=Me.Templates=Me.Templates||{},d=$.Doc=$.Doc||{},ft=c.JavaScript=c.JavaScript||{},Bt=ft.Pervasives=ft.Pervasives||{},ze=$.ConcreteVar=$.ConcreteVar||{},D=$.Snap=$.Snap||{},S=c.Seq=c.Seq||{},pt=l.Stock=l.Stock||{},K=c.Collections=c.Collections||{},Tt=K.Map=K.Map||{},Je=l.Portfolio=l.Portfolio||{},B=$.AttrProxy=$.AttrProxy||{},H=J.T=J.T||{},p=c.Arrays=c.Arrays||{},fe=$.AttrModule=$.AttrModule||{},Ce=K.FSharpMap=K.FSharpMap||{},Q=c.Decimal=c.Decimal||{},Qe=h.Node,Dt=ft.JS=ft.JS||{},$e=K.Dictionary=K.Dictionary||{},v=c.Unchecked=c.Unchecked||{},_e=$.Abbrev=$.Abbrev||{},Re=_e.Fresh=_e.Fresh||{},pe=h.StartupCode$FinancialApp$Client=h.StartupCode$FinancialApp$Client||{},ht=c.Numeric=c.Numeric||{},q=c.Enumerator=c.Enumerator||{},Ze=c.Random=c.Random||{},R=K.BalancedTree=K.BalancedTree||{},Le=K.Pair=K.Pair||{},U=$.Attrs=$.Attrs||{},ne=$.DomUtility=$.DomUtility||{},O=$.View=$.View||{},Xe=h.StartupCode$WebSharper_MathJS_Extensions$Decimal=h.StartupCode$WebSharper_MathJS_Extensions$Decimal||{},ae=h.StartupCode$WebSharper_UI$Templates=h.StartupCode$WebSharper_UI$Templates||{},X=K.HashSet=K.HashSet||{},I=$.Docs=$.Docs||{},se=q.T=q.T||{},xt=R.Tree=R.Tree||{},me=$.Array=$.Array||{},b=$.BindVar=$.BindVar||{},Ft=K.DictionaryUtil=K.DictionaryUtil||{},Be=h.Object,ee=k.Prepare=k.Prepare||{},Pe=c.Slice=c.Slice||{},Ye=K.KeyCollection=K.KeyCollection||{},et=$.DocElemNode=$.DocElemNode||{},te=$.An=$.An||{},yt=Me.Settings=Me.Settings||{},kt=_e.Mailbox=_e.Mailbox||{},Ue=h.StartupCode$WebSharper_UI$Abbrev=h.StartupCode$WebSharper_UI$Abbrev||{},Ae=$.Elt=$.Elt||{},x=h.StartupCode$WebSharper_UI$Attr_Client=h.StartupCode$WebSharper_UI$Attr_Client||{},dt=h.Error,Te=c.ArgumentException=c.ArgumentException||{},_=c.Strings=c.Strings||{},It=Me.Attrs=Me.Attrs||{},Mt=It.Dyn=It.Dyn||{},He=Me.Docs=Me.Docs||{},Rt=He.RunState=He.RunState||{},re=He.NodeSet=He.NodeSet||{},L=c.Concurrency=c.Concurrency||{},ue=$.Anims=$.Anims||{},tt=h.StartupCode$WebSharper_UI$Doc_Proxy=h.StartupCode$WebSharper_UI$Doc_Proxy||{},Lt=K.MapUtil=K.MapUtil||{},be=$.Updates=$.Updates||{},nt=$.DynamicAttrNode=$.DynamicAttrNode||{},Ke=$.String=$.String||{},Se=$.CheckedInput=$.CheckedInput||{},oe=h.StartupCode$WebSharper_UI$DomUtility=h.StartupCode$WebSharper_UI$DomUtility||{},je=h.StartupCode$WebSharper_UI$Animation=h.StartupCode$WebSharper_UI$Animation||{},ye=$.AppendList=$.AppendList||{},$t=K.HashSetUtil=K.HashSetUtil||{},qt=c.Char=c.Char||{},Pt=c.DateUtil=c.DateUtil||{},De=c.KeyNotFoundException=c.KeyNotFoundException||{},rt=L.Scheduler=L.Scheduler||{},We=$.Easing=$.Easing||{},vt=L.AsyncBody=L.AsyncBody||{},he=h.StartupCode$WebSharper_Main$Concurrency=h.StartupCode$WebSharper_Main$Concurrency||{},Ut=L.CT=L.CT||{},de=_e.HashSet=_e.HashSet||{},bt=c.Queue=c.Queue||{},it=c.CancellationTokenSource=c.CancellationTokenSource||{},qe=He.DomNodes=He.DomNodes||{},xe=c.OperationCanceledException=c.OperationCanceledException||{},Ge=c.Lazy=c.Lazy||{},ut=h.StartupCode$WebSharper_UI$AppendList=h.StartupCode$WebSharper_UI$AppendList||{},Wt=c.LazyExtensionsProxy=c.LazyExtensionsProxy||{},Vt=Wt.LazyRecord=Wt.LazyRecord||{},Fe=h.Date,Ne=h.console,gt=h.math,ot=h.Math,E=c&&c.Runtime,l.Main=function(){var t;t=l.app(),k.LoadLocalTemplates(""),d.RunById("main",t)},l.app=function(){var t,n,r,i,u,o,a;function f(){t.Set(l.displayDashboard()),n.Set(l.displayPortfolio())}function g(){var P,T;l.addTransaction(Nt.New(At.NewGuid(),r.Get()=="Income"?st.Income:st.Expense,(P=i.Get(),P=="Food"?Ie.Food:P=="Utilities"?Ie.Utilities:P=="Salary"?Ie.Salary:P=="Entertainment"?Ie.Entertainment:{$:4,$0:i.Get()}),(T=u.Get(),Q.WSDecimalMath().bignumber(T)),Fe.now())),f()}function F(){l.addStock(o.Get(),y.toInt(h.Number(a.Get()))),f()}function M(){l.removeStock(o.Get(),y.toInt(h.Number(a.Get()))),f()}return t=Z.Create$1(l.displayDashboard()),n=Z.Create$1(l.displayPortfolio()),r=Z.Create$1("Income"),i=Z.Create$1("Salary"),u=Z.Create$1(""),o=Z.Create$1(""),a=Z.Create$1(""),d.Element("div",[B.Create("class","container")],[d.Element("h1",[],[d.TextNode("Finance Manager")]),d.Element("div",[B.Create("class","budget-form")],[d.Element("div",[B.Create("class","add-budget")],[d.Element("h3",[],[d.TextNode("Add Transaction")]),d.Element("label",[],[d.TextNode("Type: ")]),d.Select([],h.id,J.ofArray(["Income","Expense"]),r),d.Element("label",[],[d.TextNode("Category: ")]),d.Select([],h.id,J.ofArray(["Food","Utilities","Salary","Entertainment","Others"]),i),d.Element("br",[],[]),d.Element("label",[],[d.TextNode("Amount: ")]),d.Input([],u),d.Element("button",[fe.Handler("click",function(){return function(){return g()}})],[d.TextNode("Add Transaction")])]),d.Element("div",[B.Create("class","add-expense")],[d.Element("h3",[],[d.TextNode("Manage Stocks")]),d.Element("label",[],[d.TextNode("Subject: ")]),d.Input([],o),d.Element("label",[],[d.TextNode("Quantity: ")]),d.Input([],a),d.Element("button",[fe.Handler("click",function(){return function(){return F()}})],[d.TextNode("Add Stock")]),d.Element("button",[B.Create("class","reset-all"),fe.Handler("click",function(){return function(){return M()}})],[d.TextNode("Remove Stock")])])]),d.Element("div",[],[d.BindView(h.id,t.get_View())]),d.Element("div",[],[d.BindView(h.id,n.get_View())])])},l.displayDashboard=function(){var t,n,r,i,u,o,a,f,g,F,M,P,T;try{u=J.filter(function(w){return w.Type.$===0},l.transactions().Get()),t=Q.CreateDecimal(0,0,0,!1,0),o=q.Get(u);try{for(;o.MoveNext();)t=(a=o.Current().Amount,f=Q.WSDecimalMath(),f.add.apply(f,[t,a]))}finally{typeof o=="object"&&"Dispose"in o&&o.Dispose()}g=t,F=J.filter(function(w){return w.Type.$===1},l.transactions().Get()),r=Q.CreateDecimal(0,0,0,!1,0),M=q.Get(F);try{for(;M.MoveNext();)r=(P=M.Current().Amount,T=Q.WSDecimalMath(),T.add.apply(T,[r,P]))}finally{typeof M=="object"&&"Dispose"in M&&M.Dispose()}return n=r,i=Q.WSDecimalMath().subtract(g,n),d.Element("div",[B.Create("class","budget-details")],[d.Element("h3",[],[d.TextNode("Current Financial Status")]),d.Element("div",[B.Create("class","totals")],[d.Element("p",[],[d.TextNode("Total Income: "+h.String(g)+"$")]),d.Element("p",[],[d.TextNode("Total Expenses: "+h.String(n)+"$")]),d.Element("p",[],[d.TextNode("Net Income: "+h.String(i)+"$")])])])}catch(w){return Ne.log("Error in displayDashboard: ",w.message),d.Element("div",[],[d.TextNode("Error displaying dashboard")])}},l.displayPortfolio=function(){return d.Element("div",[B.Create("class","budget-details")],[d.Element("h3",[],[d.TextNode("Current Portfolio")]),d.Element("ul",[B.Create("class","list-group")],J.ofSeq(S.delay(function(){return S.collect(function(t){var n,r;return n=t[1],r=l.getRandomStockPrice(t[0]),[d.Element("li",[B.Create("class","list-group-item")],[d.TextNode("Symbol: "+h.String(n.Symbol)+", Quantity: "+h.String(n.Quantity)+", Current Price: "+h.String(r)+"$")])]},Tt.ToSeq(l.portfolio().Get().Stocks))})))])},l.removeStock=function(t,n){var r,i;r=l.portfolio().Get().Stocks.TryFind(t),r!=null&&r.$==1&&(r.$0.Quantity>n?(i=r.$0,l.portfolio().Set((l.portfolio().Get(),Je.New(l.portfolio().Get().Stocks.Add$1(t,pt.New(i.Symbol,i.Quantity-n)))))):r.$0.Quantity===n&&l.portfolio().Set((l.portfolio().Get(),Je.New(l.portfolio().Get().Stocks.Remove$1(t)))))},l.addStock=function(t,n){var r,i,u;r=(i=l.portfolio().Get().Stocks.TryFind(t),i==null?pt.New(t,n):(u=i.$0,pt.New(u.Symbol,u.Quantity+n))),l.portfolio().Set((l.portfolio().Get(),Je.New(l.portfolio().Get().Stocks.Add$1(t,r))))},l.addTransaction=function(t){l.transactions().Set(new H({$:1,$0:t,$1:l.transactions().Get()}))},l.transactions=function(){return pe.$cctor(),pe.transactions},l.getRandomStockPrice=function(t){var n;return n=l.random().Next(100,1e3),Q.WSDecimalMath().bignumber(n)},l.portfolio=function(){return pe.$cctor(),pe.portfolio},l.random=function(){return pe.$cctor(),pe.random},l.createMathInstance=function(){return gt.create({number:"BigNumber",precision:29,predictable:!0,epsilon:1e-60})},y.toInt=function(t){var n;return n=y.toUInt(t),n>=2147483648?n-4294967296:n},y.toUInt=function(t){return(t<0?ot.ceil(t):ot.floor(t))>>>0},y.FailWith=function(t){throw new dt(t)},y.InvalidArg=function(t,n){throw new Te.New(t,n)},y.KeyValue=function(t){return[t.K,t.V]},y.range=function(t,n){var r;return r=1+n-t,r<=0?[]:S.init(r,function(i){return i+t})},N=c.Obj=E.Class({Equals:function(t){return this===t},GetHashCode:function(){return-1}},null,N),N.New=E.Ctor(function(){},N),Z=$.Var$1=E.Class({},N,Z),Z.Create$1=function(t){return new ze.New(!1,D.New({$:2,$0:t,$1:[]}),t)},we=$.Var=E.Class({},N,we),we.New=E.Ctor(function(){N.New.call(this)},we),St=Oe.attr=E.Class({},N,St),J.ofArray=function(t){var n,r,i;for(n=H.Empty,r=p.length(t)-1,i=0;r>=i;r--)n=new H({$:1,$0:p.get(t,r),$1:n});return n},J.filter=function(t,n){var r,i,u,o,a,f;if(n.$==0)return n;for(r=H.Empty,i=r,u=n,o=!0;o;)t(u.$0)&&(r.$==0?(r=new H({$:1}),i=r):i=(a=new H({$:1}),i.$1=a,a),f=u.$0,i.$=1,i.$0=f),u=u.$1,u.$==0&&(o=!1);return r.$!=0&&(i.$1=H.Empty),r},J.ofSeq=function(t){var n,r,i,u,o,a;if(t instanceof H)return t;if(t instanceof h.Array)return J.ofArray(t);n=q.Get(t);try{if(i=n.MoveNext(),!i)r=H.Empty;else{for(o=new H({$:1}),u=o;i;)u.$0=n.Current(),n.MoveNext()?u=(a=new H({$:1}),u.$1=a,a):i=!1;u.$1=H.Empty,r=o}return r}finally{typeof n=="object"&&"Dispose"in n&&n.Dispose()}},J.mapi=function(t,n){var r,i,u,o,a,f;if(n.$==0)return n;for(a=new H({$:1}),r=a,i=n,u=0,o=!0;o;)r.$0=t(u,i.$0),i=i.$1,i.$==0?o=!1:(r=(f=new H({$:1}),r.$1=f,f),u=u+1);return r.$1=H.Empty,a},J.head=function(t){return t.$==1?t.$0:J.listEmpty()},J.tail=function(t){return t.$==1?t.$1:J.listEmpty()},J.listEmpty=function(){return y.FailWith("The input list was empty.")},Nt.New=function(t,n,r,i,u){return{Id:t,Type:n,Category:r,Amount:i,Date:u}},At.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new h.RegExp("[xy]","g"),function(t){var n,r;return n=ot.random()*16|0,r=t=="x"?n:n&3|8,r.toString(16)})},st.Income={$:0},st.Expense={$:1},Ie.Food={$:0},Ie.Utilities={$:1},Ie.Salary={$:2},Ie.Entertainment={$:3},k.LoadLocalTemplates=function(t){k.LocalTemplatesLoaded()||(k.set_LocalTemplatesLoaded(!0),k.LoadNestedTemplates(self.document.body,"")),k.LoadedTemplates().set_Item(t,k.LoadedTemplateFile(""))},k.LocalTemplatesLoaded=function(){return ae.$cctor(),ae.LocalTemplatesLoaded},k.set_LocalTemplatesLoaded=function(t){ae.$cctor(),ae.LocalTemplatesLoaded=t},k.LoadNestedTemplates=function(t,n){var r,i,u,o,a,f,g,F,M,P,T,w,m,C,A,W,V,Y,j,G,ie;function le(z){var ve,ge;r.ContainsKey(z)||(ve=(ge=null,[i.TryGetValue(z,{get:function(){return ge},set:function(ke){ge=ke}}),ge]),ve[0]?(ie.SAdd(z),i.RemoveKey(z),k.PrepareTemplateStrict(n,{$:1,$0:z},ve[1],{$:1,$0:le})):Ne.warn(ie.Contains(z)?"Encountered loop when instantiating "+z:"Local template does not exist: "+z))}for(r=k.LoadedTemplateFile(n),i=new $e.New$5,u=t.querySelectorAll("[ws-template]"),o=0,a=u.length-1;o<=a;o++)f=u[o],g=f.getAttribute("ws-template").toLowerCase(),f.removeAttribute("ws-template"),i.set_Item(g,k.FakeRootSingle(f));for(F=t.querySelectorAll("[ws-children-template]"),M=0,P=F.length-1;M<=P;M++)T=F[M],w=T.getAttribute("ws-children-template").toLowerCase(),T.removeAttribute("ws-children-template"),i.set_Item(w,k.FakeRoot(T));for(m=t.querySelectorAll("template[id]"),C=0,A=m.length-1;C<=A;C++)W=m[C],i.set_Item(W.getAttribute("id").toLowerCase(),k.FakeRootFromHTMLTemplate(W));for(V=t.querySelectorAll("template[name]"),Y=0,j=V.length-1;Y<=j;Y++)G=V[Y],i.set_Item(G.getAttribute("name").toLowerCase(),k.FakeRootFromHTMLTemplate(G));for(ie=new X.New$3;i.count>0;)le(S.head(i.Keys()))},k.LoadedTemplates=function(){return ae.$cctor(),ae.LoadedTemplates},k.LoadedTemplateFile=function(t){var n,r,i;return n=(r=null,[k.LoadedTemplates().TryGetValue(t,{get:function(){return r},set:function(u){r=u}}),r]),n[0]?n[1]:(i=new $e.New$5,k.LoadedTemplates().set_Item(t,i),i)},k.FakeRootSingle=function(t){var n,r,i,u;return t.removeAttribute("ws-template"),n=t.getAttribute("ws-replace"),n==null||(t.removeAttribute("ws-replace"),r=t.parentNode,v.Equals(r,null)||(i=self.document.createElement(t.tagName),i.setAttribute("ws-replace",n),r.replaceChild(i,t))),u=self.document.createElement("div"),u.appendChild(t),u},k.FakeRoot=function(t){var n;for(n=self.document.createElement("div");t.hasChildNodes();)n.appendChild(t.firstChild);return n},k.FakeRootFromHTMLTemplate=function(t){var n,r,i,u;for(n=self.document.createElement("div"),r=t.content,i=0,u=r.childNodes.length-1;i<=u;i++)n.appendChild(r.childNodes[i].cloneNode(!0));return n},k.PrepareTemplateStrict=function(t,n,r,i){var u,o;function a(T,w){var m,C,A,W,V,Y,j,G,ie,le,z,ve,ge,ke,ce,at,Ee,lt,Ve,Ht,Ot,_t,wt,Kt,mt;function jt(ct){}for(;;)switch(T){case 0:if(w!==null)m=w.nextSibling,v.Equals(w.nodeType,Qe.TEXT_NODE)?ee.convertTextNode(w):v.Equals(w.nodeType,Qe.ELEMENT_NODE)&&g(w),w=m;else return null;break;case 1:if(V=Pe.string(w.nodeName,{$:1,$0:3},null).toLowerCase(),Y=(C=V.indexOf("."),C===-1?[t,V]:[Pe.string(V,null,{$:1,$0:C-1}),Pe.string(V,{$:1,$0:C+1},null)]),j=Y[1],G=Y[0],G!=""&&!k.LoadedTemplates().ContainsKey(G))return ee.failNotLoaded(j);if(G==""&&i!=null&&i.$0(j),ie=k.LoadedTemplates().Item(G),ie.ContainsKey(j)){for(le=ie.Item(j),z=le.cloneNode(!0),ve=new X.New$3,ge=new $e.New$5,ke=w.attributes,ce=0,at=ke.length-1;ce<=at;ce++)Ee=ke.item(ce).name.toLowerCase(),ge.set_Item(Ee,(lt=ke.item(ce).nodeValue,lt==""?Ee:lt.toLowerCase())),ve.SAdd(Ee)||Ne.warn("Hole mapped twice",Ee);for(Ve=0,Ht=w.childNodes.length-1;Ve<=Ht;Ve++)Ot=w.childNodes[Ve],v.Equals(Ot.nodeType,Qe.ELEMENT_NODE)&&(ve.SAdd(Ot.nodeName.toLowerCase())||Ne.warn("Hole filled twice",j));if(_t=w.childNodes.length===1&&v.Equals(w.firstChild.nodeType,Qe.TEXT_NODE),_t&&(A=ee.fillTextHole(z,w.firstChild.textContent,j),function(ct){return function(Ct){Ct!=null&&ct(Ct.$0)}}((W=function(ct){return function(Ct){return ct.SAdd(Ct)}}(ve),function(ct){return W(ct),void 0}))(A)),ee.removeHolesExcept(z,ve),!_t)for(wt=0,Kt=w.childNodes.length-1;wt<=Kt;wt++)mt=w.childNodes[wt],v.Equals(mt.nodeType,Qe.ELEMENT_NODE)&&(mt.hasAttributes()?ee.fillInstanceAttrs(z,mt):f(z,mt));ee.mapHoles(z,ge),ee.fill(z,w.parentNode,w),w.parentNode.removeChild(w);return}else return ee.failNotLoaded(j)}}function f(T,w){var m,C,A,W;function V(Y,j){var G;if(A=="title"&&w.hasChildNodes())for(G=ne.ParseHTMLIntoFakeRoot(w.textContent),w.removeChild(w.firstChild);G.hasChildNodes();)w.appendChild(G.firstChild);return g(w),ee.fill(w,Y,j)}if(A=w.nodeName.toLowerCase(),k.foreachNotPreserved(T,"[ws-attr-holes]",function(Y){var j,G,ie,le,z;for(j=_.SplitChars(Y.getAttribute("ws-attr-holes"),[" "],1),G=0,ie=j.length-1;G<=ie;G++)le=p.get(j,G),Y.setAttribute(le,(z=new h.RegExp("\\${"+A+"}","ig"),Y.getAttribute(le).replace(z,w.textContent)))}),W=T.querySelector("[ws-hole="+A+"]"),v.Equals(W,null))return m=T.querySelector("[ws-replace="+A+"]"),v.Equals(m,null)?(C=T.querySelector("slot[name="+A+"]"),T.tagName.toLowerCase()=="template"?(V(C.parentNode,C),void C.parentNode.removeChild(C)):null):(V(m.parentNode,m),void m.parentNode.removeChild(m));for(;W.hasChildNodes();)W.removeChild(W.lastChild);return W.removeAttribute("ws-hole"),V(W,null)}function g(T){T.hasAttribute("ws-preserve")||(_.StartsWith(T.nodeName.toLowerCase(),"ws-")?M(T):(ee.convertAttrs(T),F(T.firstChild)))}function F(T){return a(0,T)}function M(T){return a(1,T)}function P(T){for(var w,m,C,A,W,V,Y,j,G,ie,le,z;;)if(w=T.querySelector("[ws-template]"),v.Equals(w,null))if(m=T.querySelector("[ws-children-template]"),v.Equals(m,null)){for(C=T.querySelectorAll("template[id]"),A=1,W=C.length-1;A<=W;A++)V=C[A],u.Contains(V)||(k.PrepareTemplateStrict(t,{$:1,$0:V.getAttribute("id")},V,null),u.SAdd(V));for(Y=T.querySelectorAll("template[name]"),j=1,G=Y.length-1;j<=G;j++)ie=Y[j],u.Contains(ie)||(k.PrepareTemplateStrict(t,{$:1,$0:ie.getAttribute("name")},ie,null),u.SAdd(ie));return null}else le=m.getAttribute("ws-children-template"),m.removeAttribute("ws-children-template"),k.PrepareTemplateStrict(t,{$:1,$0:le},m,null),T=T;else z=w.getAttribute("ws-template"),k.PrepareSingleTemplate(t,{$:1,$0:z},w)(null),T=T}u=new X.New$3,o=(n==null?"":n.$0).toLowerCase(),k.LoadedTemplateFile(t).set_Item(o,r),r.hasChildNodes()&&(P(r),F(r.firstChild))},k.foreachNotPreserved=function(t,n,r){ne.IterSelector(t,n,function(i){i.closest("[ws-preserve]")==null&&r(i)})},k.PrepareSingleTemplate=function(t,n,r){var i;return i=k.FakeRootSingle(r),function(u){k.PrepareTemplateStrict(t,n,i,u)}},k.TextHoleRE=function(){return ae.$cctor(),ae.TextHoleRE},d=$.Doc=E.Class({},N,d),d.RunById=function(t,n){var r;r=self.document.getElementById(t),v.Equals(r,null)?y.FailWith("invalid id: "+t):d.Run(r,n)},d.TextNode=function(t){return d.Mk({$:5,$0:self.document.createTextNode(t)},O.Const())},d.Select=function(t,n,r,i){return d.SelectImpl(t,n,function(u){return u[0]=r,d.Concat(J.mapi(function(o,a){return d.Element("option",J.ofArray([B.Create("value",h.String(o))]),J.ofArray([d.TextNode(n(a))]))},r))},i)},d.Input=function(t,n){return d.InputInternal("input",function(){return S.append(t,[fe.Value(n)])})},d.BindView=function(t,n){return d.EmbedView(O.Map(t,n))},d.Run=function(t,n){I.LinkElement(t,n.docNode),d.RunInPlace(!1,t,n)},d.Element=function(t,n,r){var i,u;return i=B.Concat(n),u=d.Concat(r),Ae.New(self.document.createElement(t),i,u)},d.Mk=function(t,n){return new d.New(t,n)},d.SelectImpl=function(t,n,r,i){var u,o,a,f;function g(w){return w.selectedIndex}function F(w,m){w.selectedIndex=m}function M(w){var m;return m=g(w),u[0].get_Item(m)}function P(w){return S.findIndex(function(m){return v.Equals(w,m)},u[0])}function T(w,m){return F(w,P(m))}return u=[H.Empty],o=self.document.createElement("select"),a=fe.DynamicCustom(function(w){return function(m){return T(w,m)}},i.get_View()),o.addEventListener("change",function(){i.UpdateMaybe(function(w){var m;return m=M(o),v.Equals(w,m)?null:{$:1,$0:m}})},!1),Ae.New(o,(f=B.Append(a,B.Concat(t)),B.Append(fe.OnAfterRender(function(w){T(w,i.Get())}),f)),r(u))},d.Concat=function(t){var n;return n=me.ofSeqNonCopying(t),me.TreeReduce(d.get_Empty(),d.Append,n)},d.InputInternal=function(t,n){var r;return r=self.document.createElement(t),Ae.New(r,B.Concat(n(r)),d.get_Empty())},d.EmbedView=function(t){var n;return n=I.CreateEmbedNode(),d.Mk({$:2,$0:n},O.Map(h.ignore,O.Bind(function(r){return I.UpdateEmbedNode(n,r.docNode),r.updates},t)))},d.RunInPlace=function(t,n,r){var i;i=I.CreateRunState(n,r.docNode),O.Sink(te.get_UseAnimations()||yt.BatchUpdatesEnabled()?kt.StartProcessor(I.PerformAnimatedUpdate(t,i,r.docNode)):function(){I.PerformSyncUpdate(t,i,r.docNode)},r.updates)},d.Append=function(t,n){return d.Mk({$:0,$0:t.docNode,$1:n.docNode},O.Map2Unit(t.updates,n.updates))},d.get_Empty=function(){return d.Mk(null,O.Const())},d.New=E.Ctor(function(t,n){N.New.call(this),this.docNode=t,this.updates=n},d),Bt.NewFromSeq=function(t){var n,r,i;n={},r=q.Get(t);try{for(;r.MoveNext();)i=r.Current(),n[i[0]]=i[1]}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}return n},ze=$.ConcreteVar=E.Class({get_View:function(){return this.view},Set:function(t){this.isConst?function(n){return n("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal")}(function(n){Ne.log(n)}):(D.Obsolete(this.snap),this.current=t,this.snap=D.New({$:2,$0:t,$1:[]}))},Get:function(){return this.current},UpdateMaybe:function(t){var n;n=t(this.Get()),n!=null&&n.$==1&&this.Set(n.$0)}},we,ze),ze.New=E.Ctor(function(t,n,r){var i;i=this,we.New.call(this),this.isConst=t,this.current=r,this.snap=n,this.view=function(){return i.snap},this.id=Re.Int()},ze),D.Map=function(t,n){var r,i;return r=n.s,r!=null&&r.$==0?D.New({$:0,$0:t(r.$0)}):(i=D.New({$:3,$0:[],$1:[]}),D.When(n,function(u){D.MarkDone(i,n,t(u))},i),i)},D.WhenObsoleteRun=function(t,n){var r;r=t.s,r==null?n():(r!=null&&r.$==2||r!=null&&r.$==3)&&r.$1.push(n)},D.When=function(t,n,r){var i;i=t.s,i==null?D.Obsolete(r):i!=null&&i.$==2?(D.EnqueueSafe(i.$1,r),n(i.$0)):i!=null&&i.$==3?(i.$0.push(n),D.EnqueueSafe(i.$1,r)):n(i.$0)},D.MarkDone=function(t,n,r){var i;i=n.s,i!=null&&i.$==0?D.MarkForever(t,r):D.MarkReady(t,r)},D.WhenRun=function(t,n,r){var i;i=t.s,i==null?r():i!=null&&i.$==2?(i.$1.push(r),n(i.$0)):i!=null&&i.$==3?(i.$0.push(n),i.$1.push(r)):n(i.$0)},D.Map2Unit=function(t,n){var r,i,u;function o(){var a,f,g;a=u.s,!(a!=null&&a.$==0||a!=null&&a.$==2)&&(f=D.ValueAndForever(t),g=D.ValueAndForever(n),f!=null&&f.$==1&&g!=null&&g.$==1&&(f.$0[1]&&g.$0[1]?D.MarkForever(u,null):D.MarkReady(u,null)))}return r=t.s,i=n.s,r!=null&&r.$==0?i!=null&&i.$==0?D.New({$:0,$0:null}):n:i!=null&&i.$==0?t:(u=D.New({$:3,$0:[],$1:[]}),D.When(t,o,u),D.When(n,o,u),u)},D.Join=function(t){var n;return n=D.New({$:3,$0:[],$1:[]}),D.When(t,function(r){var i;i=r(),D.When(i,function(u){var o,a;o=i.s,o!=null&&o.$==0&&(a=t.s,a!=null&&a.$==0)?D.MarkForever(n,u):D.MarkReady(n,u)},n)},n),n},D.EnqueueSafe=function(t,n){var r,i,u,o;if(t.push(n),t.length%20===0)for(r=t.slice(0),bt.Clear(t),i=0,u=p.length(r)-1;i<=u;i++)o=p.get(r,i),typeof o=="object"?function(a){a.s&&t.push(a)}(o):function(a){t.push(a)}(o)},D.MarkForever=function(t,n){var r,i,u,o;if(r=t.s,r!=null&&r.$==3)for(t.s={$:0,$0:n},i=r.$0,u=0,o=p.length(i)-1;u<=o;u++)p.get(i,u)(n)},D.MarkReady=function(t,n){var r,i,u,o;if(r=t.s,r!=null&&r.$==3)for(t.s={$:2,$0:n,$1:r.$1},i=r.$0,u=0,o=p.length(i)-1;u<=o;u++)p.get(i,u)(n)},D.Copy=function(t){var n,r,i;return n=t.s,n==null?t:n!=null&&n.$==2?(r=D.New({$:2,$0:n.$0,$1:[]}),D.WhenObsolete(t,r),r):n!=null&&n.$==3?(i=D.New({$:3,$0:[],$1:[]}),D.When(t,function(u){D.MarkDone(i,t,u)},i),i):t},D.ValueAndForever=function(t){var n;return n=t.s,n!=null&&n.$==0?{$:1,$0:[n.$0,!0]}:n!=null&&n.$==2?{$:1,$0:[n.$0,!1]}:null},D.WhenObsolete=function(t,n){var r;r=t.s,r==null?D.Obsolete(n):(r!=null&&r.$==2||r!=null&&r.$==3)&&D.EnqueueSafe(r.$1,n)},S.sumBy=function(t,n){var r,i;r=0,i=q.Get(n);try{for(;i.MoveNext();)r=r+t(i.Current())}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}return r},S.delay=function(t){return{GetEnumerator:function(){return q.Get(t())}}},S.collect=function(t,n){return S.concat(S.map(t,n))},S.concat=function(t){return{GetEnumerator:function(){var n;function r(i){for(var u;;)if(u=i.s,v.Equals(u,null))if(n.MoveNext())i.s=q.Get(n.Current()),i=i;else return n.Dispose(),!1;else{if(u.MoveNext())return i.c=u.Current(),!0;i.Dispose(),i.s=null,i=i}}return n=q.Get(t),new se.New(null,null,r,function(i){var u;u=i.s,v.Equals(u,null)||u.Dispose(),v.Equals(n,null)||n.Dispose()})}}},S.map=function(t,n){return{GetEnumerator:function(){var r;return r=q.Get(n),new se.New(null,null,function(i){return r.MoveNext()&&(i.c=t(r.Current()),!0)},function(){r.Dispose()})}}},S.append=function(t,n){return{GetEnumerator:function(){var r,i;return r=q.Get(t),i=[!0],new se.New(r,null,function(u){var o;return u.s.MoveNext()?(u.c=u.s.Current(),!0):(o=u.s,v.Equals(o,null)||o.Dispose(),u.s=null,i[0]&&(i[0]=!1,u.s=q.Get(n),u.s.MoveNext()?(u.c=u.s.Current(),!0):(u.s.Dispose(),u.s=null,!1)))},function(u){var o;o=u.s,v.Equals(o,null)||o.Dispose()})}}},S.head=function(t){var n;n=q.Get(t);try{return n.MoveNext()?n.Current():S.insufficient()}finally{typeof n=="object"&&"Dispose"in n&&n.Dispose()}},S.unfold=function(t,n){return{GetEnumerator:function(){return new se.New(n,null,function(r){var i;return i=t(r.s),i==null?!1:(r.c=i.$0[0],r.s=i.$0[1],!0)},void 0)}}},S.findIndex=function(t,n){var r;return r=S.tryFindIndex(t,n),r==null?y.FailWith("KeyNotFoundException"):r.$0},S.fold=function(t,n,r){var i,u;i=n,u=q.Get(r);try{for(;u.MoveNext();)i=t(i,u.Current());return i}finally{typeof u=="object"&&"Dispose"in u&&u.Dispose()}},S.forall2=function(t,n,r){return!S.exists2(function(i,u){return!t(i,u)},n,r)},S.tryFindIndex=function(t,n){var r,i,u;r=q.Get(n);try{for(i=!0,u=0;i&&r.MoveNext();)t(r.Current())?i=!1:u=u+1;return i?null:{$:1,$0:u}}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},S.exists2=function(t,n,r){var i,u,o,a;i=q.Get(n);try{o=q.Get(r);try{for(a=!1;!a&&i.MoveNext()&&o.MoveNext();)a=t(i.Current(),o.Current());u=a}finally{typeof o=="object"&&"Dispose"in o&&o.Dispose()}return u}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},S.rev=function(t){return S.delay(function(){return p.ofSeq(t).slice().reverse()})},S.distinctBy=function(t,n){return{GetEnumerator:function(){var r,i;return r=q.Get(n),i=new X.New$3,new se.New(null,null,function(u){var o,a;if(r.MoveNext()){for(o=r.Current(),a=i.SAdd(t(o));!a&&r.MoveNext();)o=r.Current(),a=i.SAdd(t(o));return a&&(u.c=o,!0)}else return!1},function(){r.Dispose()})}}},S.nth=function(t,n){var r,i;t<0&&y.FailWith("negative index requested"),r=-1,i=q.Get(n);try{for(;r<t;)i.MoveNext()||S.insufficient(),r=r+1;return i.Current()}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},S.init=function(t,n){return S.take(t,S.initInfinite(n))},S.iter=function(t,n){var r;r=q.Get(n);try{for(;r.MoveNext();)t(r.Current())}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},S.forall=function(t,n){return!S.exists(function(r){return!t(r)},n)},S.take=function(t,n){return t<0&&S.nonNegative(),{GetEnumerator:function(){var r;return r=[q.Get(n)],new se.New(0,null,function(i){var u;return i.s=i.s+1,i.s>t?!1:(u=r[0],v.Equals(u,null)?S.insufficient():u.MoveNext()?(i.c=u.Current(),i.s===t&&(u.Dispose(),r[0]=null),!0):(u.Dispose(),r[0]=null,S.insufficient()))},function(){var i;i=r[0],v.Equals(i,null)||i.Dispose()})}}},S.initInfinite=function(t){return{GetEnumerator:function(){return new se.New(0,null,function(n){return n.c=t(n.s),n.s=n.s+1,!0},void 0)}}},S.max=function(t){var n,r,i;n=q.Get(t);try{for(n.MoveNext()||S.seqEmpty(),r=n.Current();n.MoveNext();)i=n.Current(),v.Compare(i,r)===1&&(r=i);return r}finally{typeof n=="object"&&"Dispose"in n&&n.Dispose()}},S.compareWith=function(t,n,r){var i,u,o,a,f;i=q.Get(n);try{o=q.Get(r);try{for(a=0,f=!0;f&&a===0;)i.MoveNext()?a=o.MoveNext()?t(i.Current(),o.Current()):1:o.MoveNext()?a=-1:f=!1;u=a}finally{typeof o=="object"&&"Dispose"in o&&o.Dispose()}return u}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},S.exists=function(t,n){var r,i;r=q.Get(n);try{for(i=!1;!i&&r.MoveNext();)i=t(r.Current());return i}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},S.seqEmpty=function(){return y.FailWith("The input sequence was empty.")},pt.New=function(t,n){return{Symbol:t,Quantity:n}},Tt.ToSeq=function(t){return S.map(function(n){return[n.Key,n.Value]},R.Enumerate(!1,t.get_Tree()))},Je.New=function(t){return{Stocks:t}},B=$.AttrProxy=E.Class({},null,B),B.Create=function(t,n){return U.Static(function(r){r.setAttribute(t,n)})},B.Concat=function(t){var n;return n=me.ofSeqNonCopying(t),me.TreeReduce(U.EmptyAttr(),B.Append,n)},B.Append=function(t,n){return U.AppendTree(t,n)},H=J.T=E.Class({get_Item:function(t){return S.nth(t,this)},GetEnumerator:function(){return new se.New(this,null,function(t){var n;return n=t.s,n.$==0?!1:(t.c=n.$0,t.s=n.$1,!0)},void 0)}},null,H),H.Empty=new H({$:0}),p.get=function(t,n){return p.checkBounds(t,n),t[n]},p.length=function(t){return t.dims===2?t.length*t.length:t.length},p.checkBounds=function(t,n){(n<0||n>=t.length)&&y.FailWith("Index was outside the bounds of the array.")},p.set=function(t,n,r){p.checkBounds(t,n),t[n]=r},fe.Handler=function(t,n){return U.Static(function(r){r.addEventListener(t,function(i){return n(r)(i)},!1)})},fe.Value=function(t){return fe.ValueWith(b.StringApply(),t)},fe.OnAfterRender=function(t){return new B({$:4,$0:t})},fe.DynamicCustom=function(t,n){return U.Dynamic(n,t)},fe.ValueWith=function(t,n){var r;return r=t(n),B.Append(U.Static(r[0]),fe.DynamicCustom(r[1],r[2]))},Ce=K.FSharpMap=E.Class({TryFind:function(t){var n;return n=R.TryFind(Le.New(t,void 0),this.tree),n==null?null:{$:1,$0:n.$0.Value}},Add$1:function(t,n){return new Ce.New$1(R.Add(Le.New(t,n),this.tree))},Remove$1:function(t){return new Ce.New$1(R.Remove(Le.New(t,void 0),this.tree))},get_Tree:function(){return this.tree},GetEnumerator:function(){return q.Get(S.map(function(t){return{K:t.Key,V:t.Value}},R.Enumerate(!1,this.tree)))},Equals:function(t){return this.Count()===t.Count()&&S.forall2(v.Equals,this,t)},Count:function(){var t;return t=this.tree,t==null?0:t.Count},GetHashCode:function(){return v.Hash(p.ofSeq(this))},CompareTo0:function(t){return S.compareWith(v.Compare,this,t)}},N,Ce),Ce.New$1=E.Ctor(function(t){N.New.call(this),this.tree=t},Ce),Ce.New=E.Ctor(function(t){Ce.New$1.call(this,Lt.fromSeq(t))},Ce),Q.WSDecimalMath=function(){return Xe.$cctor(),Xe.WSDecimalMath},Q.CreateDecimalBits=function(t){var n,r;return p.length(t)===4?(n=(p.get(t,3)&-2147483648)!==0,r=p.get(t,3)>>16&127,Q.CreateDecimal(p.get(t,0),p.get(t,1),p.get(t,2),n,r)):y.InvalidArg("bits","The length of the bits array is not 4")},Q.CreateDecimal=function(t,n,r,i,u){var o,a,f,g,F,M,P,T,w,m,C,A,W,V,Y,j,G,ie,le,z,ve,ge,ke;function ce(Ee){return Q.WSDecimalMath().bignumber(Ee)}function at(Ee){var lt,Ve;return Ee>=0?ce(Ee):(lt=ce(Ee),Ve=Q.WSDecimalMath(),Ve.add.apply(Ve,[o,lt]))}return t===0&&r===0&&n===0?ce(0):(o=(a=(f=ce(429496729),g=ce(10),F=Q.WSDecimalMath(),F.multiply.apply(F,[f,g])),M=ce(6),P=Q.WSDecimalMath(),P.add.apply(P,[a,M])),T=Q.WSDecimalMath().pow(ce(10),Q.WSDecimalMath().unaryMinus(ce(y.toInt(u)))),w=(m=(C=(A=(W=at(r),V=Q.WSDecimalMath(),V.multiply.apply(V,[W,o])),Y=at(n),j=Q.WSDecimalMath(),j.add.apply(j,[A,Y])),G=Q.WSDecimalMath(),G.multiply.apply(G,[C,o])),ie=at(t),le=Q.WSDecimalMath(),le.add.apply(le,[m,ie])),z=ce(i?-1:1),ve=(ge=Q.WSDecimalMath(),ge.multiply.apply(ge,[z,w])),ke=Q.WSDecimalMath(),ke.multiply.apply(ke,[ve,T]))},Dt.GetFieldValues=function(t){var n;n=[];for(var r in t)n.push(t[r]);return n},$e=K.Dictionary=E.Class({set_Item:function(t,n){this.set(t,n)},ContainsKey:function(t){var n,r;return n=this,r=this.data[this.hash(t)],r==null?!1:p.exists(function(i){return n.equals.apply(null,[y.KeyValue(i)[0],t])},r)},TryGetValue:function(t,n){var r,i,u;return r=this,i=this.data[this.hash(t)],i==null?!1:(u=p.tryPick(function(o){var a;return a=y.KeyValue(o),r.equals.apply(null,[a[0],t])?{$:1,$0:a[1]}:null},i),u!=null&&u.$==1&&(n.set(u.$0),!0))},RemoveKey:function(t){return this.remove(t)},Keys:function(){return new Ye.New(this)},set:function(t,n){var r,i,u,o;r=this,i=this.hash(t),u=this.data[i],u==null?(this.count=this.count+1,this.data[i]=new h.Array({K:t,V:n})):(o=p.tryFindIndex(function(a){return r.equals.apply(null,[y.KeyValue(a)[0],t])},u),o==null?(this.count=this.count+1,u.push({K:t,V:n})):u[o.$0]={K:t,V:n})},remove:function(t){var n,r,i,u;return n=this,r=this.hash(t),i=this.data[r],i==null?!1:(u=p.filter(function(o){return!n.equals.apply(null,[y.KeyValue(o)[0],t])},i),p.length(u)<i.length&&(this.count=this.count-1,this.data[r]=u,!0))},Item:function(t){return this.get(t)},GetEnumerator:function(){return q.Get0(p.concat(Dt.GetFieldValues(this.data)))},get:function(t){var n,r;return n=this,r=this.data[this.hash(t)],r==null?Ft.notPresent():p.pick(function(i){var u;return u=y.KeyValue(i),n.equals.apply(null,[u[0],t])?{$:1,$0:u[1]}:null},r)}},N,$e),$e.New$5=E.Ctor(function(){$e.New$6.call(this,[],v.Equals,v.Hash)},$e),$e.New$6=E.Ctor(function(t,n,r){var i,u;N.New.call(this),this.equals=n,this.hash=r,this.count=0,this.data=[],i=q.Get(t);try{for(;i.MoveNext();)u=i.Current(),this.set(u.K,u.V)}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},$e),v.Equals=function(t,n){var r,i;if(t===n)return!0;if(r=typeof t,r=="object"){if(t==null||n===null||n===void 0||!v.Equals(typeof n,"object"))return!1;if("Equals"in t)return t.Equals(n);if("Equals"in n)return!1;if(t instanceof h.Array&&n instanceof h.Array)return v.arrayEquals(t,n);if(t instanceof Fe&&n instanceof Fe)return v.dateEquals(t,n);i=[!0];for(var u in t)if(function(a){return i[0]=!t.hasOwnProperty(a)||n.hasOwnProperty(a)&&v.Equals(t[a],n[a]),!i[0]}(u))break;if(i[0]){for(var o in n)if(function(a){return i[0]=!n.hasOwnProperty(a)||t.hasOwnProperty(a),!i[0]}(o))break}return i[0]}else return r=="function"&&("$Func"in t?t.$Func===n.$Func&&t.$Target===n.$Target:"$Invokes"in t&&"$Invokes"in n&&v.arrayEquals(t.$Invokes,n.$Invokes))},v.arrayEquals=function(t,n){var r,i;if(p.length(t)===p.length(n)){for(r=!0,i=0;r&&i<p.length(t);)v.Equals(p.get(t,i),p.get(n,i))||(r=!1),i=i+1;return r}else return!1},v.dateEquals=function(t,n){return t.getTime()===n.getTime()},v.Hash=function(t){var n;return n=typeof t,n=="function"?0:n=="boolean"?t?1:0:n=="number"?t:n=="string"?v.hashString(t):n=="object"?t==null?0:t instanceof h.Array?v.hashArray(t):v.hashObject(t):0},v.Compare=function(t,n){var r,i,u;if(t===n)return 0;switch(r=typeof t,r=="function"?1:r=="boolean"||r=="number"||r=="string"?2:r=="object"?3:0){case 0:return typeof n>"u"?0:-1;case 1:return y.FailWith("Cannot compare function values.");case 2:return t<n?-1:1;case 3:if(t===null)i=-1;else if(n===null)i=1;else if("CompareTo"in t)i=t.CompareTo(n);else if("CompareTo0"in t)i=t.CompareTo0(n);else if(t instanceof h.Array&&n instanceof h.Array)i=v.compareArrays(t,n);else if(t instanceof Fe&&n instanceof Fe)i=v.compareDates(t,n);else{u=[0];for(var o in t)if(function(f){return t.hasOwnProperty(f)?n.hasOwnProperty(f)?(u[0]=v.Compare(t[f],n[f]),u[0]!==0):(u[0]=1,!0):!1}(o))break;if(u[0]===0){for(var a in n)if(function(f){return n.hasOwnProperty(f)?!t.hasOwnProperty(f)&&(u[0]=-1,!0):!1}(a))break}i=u[0]}return i}},v.hashString=function(t){var n,r,i;if(t===null)return 0;for(n=5381,r=0,i=t.length-1;r<=i;r++)n=v.hashMix(n,t[r].charCodeAt());return n},v.hashArray=function(t){var n,r,i;for(n=-34948909,r=0,i=p.length(t)-1;r<=i;r++)n=v.hashMix(n,v.Hash(p.get(t,r)));return n},v.hashObject=function(t){var n;if("GetHashCode"in t)return t.GetHashCode();n=[0];for(var r in t)(function(i){return n[0]=v.hashMix(v.hashMix(n[0],v.hashString(i)),v.Hash(t[i])),!1})(r);return n[0]},v.compareArrays=function(t,n){var r,i;if(p.length(t)<p.length(n))return-1;if(p.length(t)>p.length(n))return 1;for(r=0,i=0;r===0&&i<p.length(t);)r=v.Compare(p.get(t,i),p.get(n,i)),i=i+1;return r},v.compareDates=function(t,n){return v.Compare(t.getTime(),n.getTime())},v.hashMix=function(t,n){return(t<<5)+t+n},Re.Int=function(){return Re.set_counter(Re.counter()+1),Re.counter()},Re.set_counter=function(t){Ue.$cctor(),Ue.counter=t},Re.counter=function(){return Ue.$cctor(),Ue.counter},pe.$cctor=function(){pe.$cctor=h.ignore,pe.math=self.math,typeof gt>"u"&&Ne.log("Math.js library is not loaded"),pe.mathInstance=l.createMathInstance(),pe.random=new Ze.New,pe.transactions=Z.Create$1(H.Empty),pe.portfolio=Z.Create$1(Je.New(new Ce.New([])))},ht.TryParseInt32=function(t,n){return ht.TryParse(t,-2147483648,2147483647,n)},q.Get=function(t){return t instanceof h.Array?q.ArrayEnumerator(t):v.Equals(typeof t,"string")?q.StringEnumerator(t):t.GetEnumerator()},q.ArrayEnumerator=function(t){return new se.New(0,null,function(n){var r;return r=n.s,r<p.length(t)&&(n.c=p.get(t,r),n.s=r+1,!0)},void 0)},q.StringEnumerator=function(t){return new se.New(0,null,function(n){var r;return r=n.s,r<t.length&&(n.c=t[r],n.s=r+1,!0)},void 0)},q.Get0=function(t){return t instanceof h.Array?q.ArrayEnumerator(t):v.Equals(typeof t,"string")?q.StringEnumerator(t):"GetEnumerator0"in t?t.GetEnumerator0():t.GetEnumerator()},Ze=c.Random=E.Class({Next:function(t,n){return t>n?y.FailWith("'minValue' cannot be greater than maxValue."):t+ot.floor(ot.random()*(n-t))}},N,Ze),Ze.New=E.Ctor(function(){N.New.call(this)},Ze),R.TryFind=function(t,n){var r;return r=R.Lookup(t,n)[0],r==null?null:{$:1,$0:r.Node}},R.Add=function(t,n){return R.Put(function(r,i){return i},t,n)},R.Remove=function(t,n){var r,i,u,o;return r=R.Lookup(t,n),i=r[0],u=r[1],i==null?n:i.Right==null?R.Rebuild(u,i.Left):i.Left==null?R.Rebuild(u,i.Right):R.Rebuild(u,(o=p.ofSeq(S.append(R.Enumerate(!1,i.Left),R.Enumerate(!1,i.Right))),R.Build(o,0,o.length-1)))},R.Enumerate=function(t,n){function r(i,u){for(var o;;){if(i==null)return u.$==1?{$:1,$0:[u.$0[0],[u.$0[1],u.$1]]}:null;t?(o=i,i=o.Right,u=new H({$:1,$0:[o.Node,o.Left],$1:u})):(o=i,i=o.Left,u=new H({$:1,$0:[o.Node,o.Right],$1:u}))}}return S.unfold(function(i){return r(i[0],i[1])},[n,H.Empty])},R.Lookup=function(t,n){var r,i,u,o;for(r=[],i=n,u=!0;u;)i==null?u=!1:(o=v.Compare(t,i.Node),o===0?u=!1:o===1?(r.unshift([!0,i.Node,i.Left]),i=i.Right):(r.unshift([!1,i.Node,i.Right]),i=i.Left));return[i,r]},R.Put=function(t,n,r){var i,u;return i=R.Lookup(n,r),u=i[0],u==null?R.Rebuild(i[1],R.Branch(n,null,null)):R.Rebuild(i[1],R.Branch(t(u.Node,n),u.Left,u.Right))},R.Rebuild=function(t,n){var r,i,u,o,a,f,g,F,M,P;function T(w){return w==null?0:w.Height}for(r=n,i=0,u=p.length(t)-1;i<=u;i++)r=(o=p.get(t,i),o[0]?(a=o[1],f=o[2],T(r)>T(f)+1?T(r.Left)===T(r.Right)+1?(g=r.Left,R.Branch(g.Node,R.Branch(a,f,g.Left),R.Branch(r.Node,g.Right,r.Right))):R.Branch(r.Node,R.Branch(a,f,r.Left),r.Right):R.Branch(a,f,r)):(F=o[1],M=o[2],T(r)>T(M)+1?T(r.Right)===T(r.Left)+1?(P=r.Right,R.Branch(P.Node,R.Branch(r.Node,r.Left,P.Left),R.Branch(F,P.Right,M))):R.Branch(r.Node,r.Left,R.Branch(F,r.Right,M)):R.Branch(F,r,M)));return r},R.Branch=function(t,n,r){var i,u;return xt.New(t,n,r,1+(i=n==null?0:n.Height,u=r==null?0:r.Height,v.Compare(i,u)===1?i:u),1+(n==null?0:n.Count)+(r==null?0:r.Count))},R.Build=function(t,n,r){var i,u,o;return r-n+1<=0?null:(i=(n+r)/2>>0,u=R.Build(t,n,i-1),o=R.Build(t,i+1,r),R.Branch(p.get(t,i),u,o))},Le=K.Pair=E.Class({Equals:function(t){return v.Equals(this.Key,t.Key)},GetHashCode:function(){return v.Hash(this.Key)},CompareTo0:function(t){return v.Compare(this.Key,t.Key)}},null,Le),Le.New=function(t,n){return new Le({Key:t,Value:n})},U.Static=function(t){return new B({$:3,$0:t})},U.AppendTree=function(t,n){var r;return t===null?n:n===null?t:(r=new B({$:2,$0:t,$1:n}),U.SetFlags(r,U.Flags(t)|U.Flags(n)),r)},U.Dynamic=function(t,n){return new B({$:1,$0:new nt.New(t,n)})},U.Updates=function(t){return me.MapTreeReduce(function(n){return n.NChanged()},O.Const(),O.Map2Unit,t.DynNodes)},U.EmptyAttr=function(){return x.$cctor(),x.EmptyAttr},U.SetFlags=function(t,n){t.flags=n},U.Flags=function(t){return t!==null&&t.hasOwnProperty("flags")?t.flags:0},U.Insert=function(t,n){var r,i,u;function o(a){for(var f,g;;)if(a!==null){if(a!=null&&a.$==1)return r.push(a.$0);if(a!=null&&a.$==2)f=a.$1,g=a.$0,o(g),a=f;else return a!=null&&a.$==3?a.$0(t):a!=null&&a.$==4?i.push(a.$0):null}else return null}return r=[],i=[],o(n),u=r.slice(0),Mt.New(t,U.Flags(n),u,i.length===0?null:{$:1,$0:function(a){S.iter(function(f){f(a)},i)}})},U.HasExitAnim=function(t){var n;return n=2,(t.DynFlags&n)===n},U.GetExitAnim=function(t){return U.GetAnim(t,function(n,r){return n.NGetExitAnim(r)})},U.HasEnterAnim=function(t){var n;return n=1,(t.DynFlags&n)===n},U.GetEnterAnim=function(t){return U.GetAnim(t,function(n,r){return n.NGetEnterAnim(r)})},U.HasChangeAnim=function(t){var n;return n=4,(t.DynFlags&n)===n},U.GetChangeAnim=function(t){return U.GetAnim(t,function(n,r){return n.NGetChangeAnim(r)})},U.GetAnim=function(t,n){return te.Concat(p.map(function(r){return n(r,t.DynElem)},t.DynNodes))},U.Sync=function(t,n){p.iter(function(r){r.NSync(t)},n.DynNodes)},ne.ParseHTMLIntoFakeRoot=function(t){var n,r,i,u,o;function a(f,g){for(var F;;){if(g===0)return f;F=g,f=f.lastChild,g=F-1}}return n=self.document.createElement("div"),ne.rhtml().test(t)?(r=(i=ne.rtagName().exec(t),v.Equals(i,null)?"":p.get(i,1).toLowerCase()),u=(o=ne.wrapMap()[r],o||ne.defaultWrap()),n.innerHTML=u[1]+t.replace(ne.rxhtmlTag(),"<$1></$2>")+u[2],a(n,u[0])):(n.appendChild(self.document.createTextNode(t)),n)},ne.rhtml=function(){return oe.$cctor(),oe.rhtml},ne.wrapMap=function(){return oe.$cctor(),oe.wrapMap},ne.defaultWrap=function(){return oe.$cctor(),oe.defaultWrap},ne.rxhtmlTag=function(){return oe.$cctor(),oe.rxhtmlTag},ne.rtagName=function(){return oe.$cctor(),oe.rtagName},ne.IterSelector=function(t,n,r){var i,u,o;for(i=t.querySelectorAll(n),u=0,o=i.length-1;u<=o;u++)r(i[u])},ne.InsertAt=function(t,n,r){var i;r.parentNode===t&&n===(i=r.nextSibling,v.Equals(i,null)?null:i)||t.insertBefore(r,n)},ne.RemoveNode=function(t,n){n.parentNode===t&&t.removeChild(n)},O.Const=function(t){var n;return n=D.New({$:0,$0:t}),function(){return n}},O.Map=function(t,n){return O.CreateLazy(function(){return D.Map(t,n())})},O.Bind=function(t,n){return O.Join(O.Map(t,n))},O.CreateLazy=function(t){var n;return n={c:null,o:t},function(){var r,i;return r=n.c,r===null&&(r=n.o(),n.c=r,i=r.s,i!=null&&i.$==0?n.o=null:D.WhenObsoleteRun(r,function(){n.c=null})),r}},O.Sink=function(t,n){function r(){D.WhenRun(n(),t,function(){L.scheduler().Fork(r)})}L.scheduler().Fork(r)},O.Map2Unit=function(t,n){return O.CreateLazy(function(){return D.Map2Unit(t(),n())})},O.Join=function(t){return O.CreateLazy(function(){return D.Join(t())})},Xe.$cctor=function(){var t;Xe.$cctor=h.ignore,Xe.WSDecimalMath=gt.create((t={},t.number="BigNumber",t.precision=29,t.predictable=!0,t.epsilon=1e-60,t))},ae.$cctor=function(){ae.$cctor=h.ignore,ae.LoadedTemplates=new $e.New$5,ae.LocalTemplatesLoaded=!1,ae.GlobalHoles=new $e.New$5,ae.TextHoleRE="\\${([^}]+)}",ae.RenderedFullDocTemplate=null},X=K.HashSet=E.Class({SAdd:function(t){return this.add(t)},Contains:function(t){var n;return n=this.data[this.hash(t)],n==null?!1:this.arrContains(t,n)},add:function(t){var n,r;return n=this.hash(t),r=this.data[n],r==null?(this.data[n]=[t],this.count=this.count+1,!0):this.arrContains(t,r)?!1:(r.push(t),this.count=this.count+1,!0)},arrContains:function(t,n){var r,i,u;for(r=!0,i=0,u=n.length;r&&i<u;)this.equals.apply(null,[n[i],t])?r=!1:i=i+1;return!r},GetEnumerator:function(){return q.Get($t.concat(this.data))},ExceptWith:function(t){var n;n=q.Get(t);try{for(;n.MoveNext();)this.Remove(n.Current())}finally{typeof n=="object"&&"Dispose"in n&&n.Dispose()}},Count:function(){return this.count},IntersectWith:function(t){var n,r,i,u,o;for(n=new X.New$4(t,this.equals,this.hash),r=$t.concat(this.data),i=0,u=r.length-1;i<=u;i++)o=r[i],n.Contains(o)||this.Remove(o)},Remove:function(t){var n;return n=this.data[this.hash(t)],n==null?!1:this.arrRemove(t,n)&&(this.count=this.count-1,!0)},CopyTo:function(t,n){var r,i,u;for(r=$t.concat(this.data),i=0,u=r.length-1;i<=u;i++)p.set(t,i+n,r[i])},arrRemove:function(t,n){var r,i,u;for(r=!0,i=0,u=n.length;r&&i<u;)this.equals.apply(null,[n[i],t])?(n.splice.apply(n,[i,1]),r=!1):i=i+1;return!r}},N,X),X.New$3=E.Ctor(function(){X.New$4.call(this,[],v.Equals,v.Hash)},X),X.New$4=E.Ctor(function(t,n,r){var i;N.New.call(this),this.equals=n,this.hash=r,this.data=[],this.count=0,i=q.Get(t);try{for(;i.MoveNext();)this.add(i.Current())}finally{typeof i=="object"&&"Dispose"in i&&i.Dispose()}},X),X.New$2=E.Ctor(function(t){X.New$4.call(this,t,v.Equals,v.Hash)},X),O=$.View=E.Class({},null,O),I.LinkElement=function(t,n){I.InsertDoc(t,n,null)},I.CreateEmbedNode=function(){return{Current:null,Dirty:!1}},I.UpdateEmbedNode=function(t,n){t.Current=n,t.Dirty=!0},I.InsertDoc=function(t,n,r){for(var i,u,o;;){if(n!=null&&n.$==1)return I.InsertNode(t,n.$0.El,r);if(n!=null&&n.$==2)i=n.$0,i.Dirty=!1,n=i.Current;else{if(n==null)return r;if(n!=null&&n.$==4)return I.InsertNode(t,n.$0.Text,r);if(n!=null&&n.$==5)return I.InsertNode(t,n.$0,r);if(n!=null&&n.$==6)return p.foldBack(function(a,f){return E.Curried3(function(g,F,M){return F==null||F.constructor===Be?I.InsertDoc(g,F,M):I.InsertNode(g,F,M)})(t)(a)(f)},n.$0.Els,r);u=n.$1,o=n.$0,n=o,r=I.InsertDoc(t,u,r)}}},I.CreateRunState=function(t,n){return Rt.New(re.get_Empty(),I.CreateElemNode(t,U.EmptyAttr(),n))},I.PerformAnimatedUpdate=function(t,n,r){return te.get_UseAnimations()?L.Delay(function(){var i,u,o;return i=re.FindAll(r),u=I.ComputeChangeAnim(n,i),o=I.ComputeEnterAnim(n,i),L.Bind(te.Play(te.Append(u,I.ComputeExitAnim(n,i))),function(){return L.Bind(I.SyncElemNodesNextFrame(t,n),function(){return L.Bind(te.Play(o),function(){return n.PreviousNodes=i,L.Return(null)})})})}):I.SyncElemNodesNextFrame(t,n)},I.PerformSyncUpdate=function(t,n,r){var i;i=re.FindAll(r),I.SyncElemNode(t,n.Top),n.PreviousNodes=i},I.InsertNode=function(t,n,r){return ne.InsertAt(t,r,n),n},I.CreateElemNode=function(t,n,r){var i;return I.LinkElement(t,r),i=U.Insert(t,n),et.New(i,r,null,t,Re.Int(),E.GetOptional(i.OnAfterRender))},I.SyncElemNodesNextFrame=function(t,n){function r(i){h.requestAnimationFrame(function(){I.SyncElemNode(t,n.Top),i()})}return yt.BatchUpdatesEnabled()?L.FromContinuations(function(i,u,o){return r.apply(null,[i,u,o])}):(I.SyncElemNode(t,n.Top),L.Return(null))},I.ComputeExitAnim=function(t,n){return te.Concat(p.map(function(r){return U.GetExitAnim(r.Attr)},re.ToArray(re.Except(n,re.Filter(function(r){return U.HasExitAnim(r.Attr)},t.PreviousNodes)))))},I.ComputeEnterAnim=function(t,n){return te.Concat(p.map(function(r){return U.GetEnterAnim(r.Attr)},re.ToArray(re.Except(t.PreviousNodes,re.Filter(function(r){return U.HasEnterAnim(r.Attr)},n)))))},I.ComputeChangeAnim=function(t,n){var r;function i(u){return U.HasChangeAnim(u.Attr)}return r=function(u){return re.Filter(i,u)},te.Concat(p.map(function(u){return U.GetChangeAnim(u.Attr)},re.ToArray(re.Intersect(r(t.PreviousNodes),r(n)))))},I.SyncElemNode=function(t,n){t||I.SyncElement(n),I.Sync(n.Children),I.AfterRender(n)},I.SyncElement=function(t){function n(r){function i(u){for(var o,a,f,g;;)if(u!=null&&u.$==0){if(a=u.$1,f=u.$0,i(f))return!0;u=a}else if(u!=null&&u.$==2){if(g=u.$0,g.Dirty)return!0;u=g.Current}else return u!=null&&u.$==6&&(o=u.$0,o.Dirty||p.exists(n,o.Holes))}return i(r.Children)}U.Sync(t.El,t.Attr),n(t)&&I.DoSyncElement(t)},I.Sync=function(t){for(var n,r,i,u,o;;){if(t!=null&&t.$==1)return I.SyncElemNode(!1,t.$0);if(t!=null&&t.$==2)i=t.$0,t=i.Current;else{if(t==null)return null;if(t!=null&&t.$==5)return null;if(t!=null&&t.$==4)return n=t.$0,n.Dirty?(n.Text.nodeValue=n.Value,n.Dirty=!1):null;if(t!=null&&t.$==6)return r=t.$0,p.iter(function(a){I.SyncElemNode(!1,a)},r.Holes),p.iter(function(a){U.Sync(a[0],a[1])},r.Attrs),I.AfterRender(r);u=t.$1,o=t.$0,I.Sync(o),t=u}}},I.AfterRender=function(t){var n;n=E.GetOptional(t.Render),n!=null&&n.$==1&&(n.$0(t.El),E.SetOptional(t,"Render",null))},I.DoSyncElement=function(t){var n,r,i;function u(o,a){for(var f,g,F,M;;){if(o!=null&&o.$==1)return o.$0.El;if(o!=null&&o.$==2){if(g=o.$0,g.Dirty)return g.Dirty=!1,I.InsertDoc(n,g.Current,a);o=g.Current}else{if(o==null)return a;if(o!=null&&o.$==4)return o.$0.Text;if(o!=null&&o.$==5)return o.$0;if(o!=null&&o.$==6)return f=o.$0,f.Dirty&&(f.Dirty=!1),p.foldBack(function(P,T){return P==null||P.constructor===Be?u(P,T):P},f.Els,a);F=o.$1,M=o.$0,o=M,a=u(F,a)}}}n=t.El,qe.Iter((r=t.El,function(o){ne.RemoveNode(r,o)}),qe.Except(qe.DocChildren(t),qe.Children(t.El,E.GetOptional(t.Delimiters)))),u(t.Children,(i=E.GetOptional(t.Delimiters),i!=null&&i.$==1?i.$0[1]:null))},D.Obsolete=function(t){var n,r,i,u,o;if(r=t.s,!(r==null||(!(r!=null&&r.$==2||r!=null&&r.$==3)||(n=r.$1,!1))))for(t.s=null,i=0,u=p.length(n)-1;i<=u;i++)o=p.get(n,i),typeof o=="object"?function(a){D.Obsolete(a)}(o):o()},D.New=function(t){return{s:t}},se=q.T=E.Class({MoveNext:function(){var t;return t=this.n(this),this.e=t?1:2,t},Current:function(){return this.e===1?this.c:this.e===0?y.FailWith("Enumeration has not started. Call MoveNext."):y.FailWith("Enumeration already finished.")},Dispose:function(){this.d&&this.d(this)}},N,se),se.New=E.Ctor(function(t,n,r,i){N.New.call(this),this.s=t,this.c=n,this.n=r,this.d=i,this.e=0},se),xt.New=function(t,n,r,i,u){return{Node:t,Left:n,Right:r,Height:i,Count:u}},me.ofSeqNonCopying=function(t){var n,r;if(t instanceof h.Array)return t;if(t instanceof H)return p.ofList(t);if(t===null)return[];n=[],r=q.Get(t);try{for(;r.MoveNext();)n.push(r.Current());return n}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},me.TreeReduce=function(t,n,r){var i;function u(o){return function(a){var f;switch(a<=0?0:a===1&&o>=0&&o<i?1:2){case 0:return t;case 1:return p.get(r,o);case 2:return f=a/2>>0,n(u(o)(f),u(o+f)(a-f))}}}return i=p.length(r),u(0)(i)},me.MapTreeReduce=function(t,n,r,i){var u;function o(a){return function(f){var g;switch(f<=0?0:f===1&&a>=0&&a<u?1:2){case 0:return n;case 1:return t(p.get(i,a));case 2:return g=f/2>>0,r(o(a)(g),o(a+g)(f-g))}}}return u=p.length(i),o(0)(u)},p.exists=function(t,n){var r,i,u;for(r=!1,i=0,u=p.length(n);!r&&i<u;)t(n[i])?r=!0:i=i+1;return r},p.tryPick=function(t,n){var r,i,u;for(r=null,i=0;i<n.length&&r==null;)u=t(n[i]),u!=null&&u.$==1&&(r=u),i=i+1;return r},p.tryFindIndex=function(t,n){var r,i;for(r=null,i=0;i<n.length&&r==null;)t(n[i])&&(r={$:1,$0:i}),i=i+1;return r},p.ofList=function(t){var n,r;for(r=[],n=t;n.$!=0;)r.push(J.head(n)),n=J.tail(n);return r},p.ofSeq=function(t){var n,r;if(t instanceof h.Array)return t.slice();if(t instanceof H)return p.ofList(t);n=[],r=q.Get(t);try{for(;r.MoveNext();)n.push(r.Current());return n}finally{typeof r=="object"&&"Dispose"in r&&r.Dispose()}},p.filter=function(t,n){var r,i,u;for(r=[],i=0,u=n.length-1;i<=u;i++)t(n[i])&&r.push(n[i]);return r},p.map=function(t,n){var r,i,u;for(r=new h.Array(n.length),i=0,u=n.length-1;i<=u;i++)r[i]=t(n[i]);return r},p.iter=function(t,n){var r,i;for(r=0,i=n.length-1;r<=i;r++)t(n[r])},p.foldBack=function(t,n,r){var i,u,o,a;for(i=r,u=n.length,o=1,a=u;o<=a;o++)i=t(n[u-o],i);return i},p.concat=function(t){return h.Array.prototype.concat.apply([],p.ofSeq(t))},p.pick=function(t,n){var r;return r=p.tryPick(t,n),r==null?y.FailWith("KeyNotFoundException"):r.$0},p.sortInPlace=function(t){p.mapInPlace(function(n){return n[0]},p.mapiInPlace(function(n,r){return[r,n]},t).sort(v.Compare))},p.choose=function(t,n){var r,i,u,o;for(r=[],i=0,u=n.length-1;i<=u;i++)o=t(n[i]),o==null||r.push(o.$0);return r},p.create=function(t,n){var r,i,u;for(r=new h.Array(t),i=0,u=t-1;i<=u;i++)r[i]=n;return r},p.init=function(t,n){var r,i,u;for(t<0&&y.FailWith("Negative size given."),r=new h.Array(t),i=0,u=t-1;i<=u;i++)r[i]=n(i);return r},p.forall=function(t,n){var r,i,u;for(r=!0,i=0,u=p.length(n);r&&i<u;)t(n[i])?i=i+1:r=!1;return r},b.StringApply=function(){return x.$cctor(),x.StringApply},b.ApplyValue=function(t,n,r){var i;function u(o,a){return a==null?null:o(a.$0)}return i=null,[function(o){function a(){r.UpdateMaybe(function(f){var g;return i=t(o),i!=null&&i.$==1&&!v.Equals(i.$0,f)&&(g=[i,i.$0],!0)?g[0]:null})}o.addEventListener("change",a),o.addEventListener("input",a),o.addEventListener("keypress",a)},function(o){var a;return a=n(o),function(f){return u(a,f)}},O.Map(function(o){return i!=null&&i.$==1&&v.Equals(i.$0,o)&&(i.$0,!0)?null:{$:1,$0:o}},r.get_View())]},b.StringSet=function(){return x.$cctor(),x.StringSet},b.StringGet=function(){return x.$cctor(),x.StringGet},b.DateTimeSetUnchecked=function(){return x.$cctor(),x.DateTimeSetUnchecked},b.DateTimeGetUnchecked=function(){return x.$cctor(),x.DateTimeGetUnchecked},b.FileApplyValue=function(t,n,r){var i;function u(o,a){return a==null?null:o(a.$0)}return i=null,[function(o){o.addEventListener("change",function(){r.UpdateMaybe(function(a){var f;return i=t(o),i!=null&&i.$==1&&i.$0!==a&&(f=[i,i.$0],!0)?f[0]:null})})},function(o){var a;return a=n(o),function(f){return u(a,f)}},O.Map(function(o){return i!=null&&i.$==1&&v.Equals(i.$0,o)&&(i.$0,!0)?null:{$:1,$0:o}},r.get_View())]},b.FileSetUnchecked=function(){return x.$cctor(),x.FileSetUnchecked},b.FileGetUnchecked=function(){return x.$cctor(),x.FileGetUnchecked},b.IntSetUnchecked=function(){return x.$cctor(),x.IntSetUnchecked},b.IntGetUnchecked=function(){return x.$cctor(),x.IntGetUnchecked},b.IntSetChecked=function(){return x.$cctor(),x.IntSetChecked},b.IntGetChecked=function(){return x.$cctor(),x.IntGetChecked},b.FloatSetUnchecked=function(){return x.$cctor(),x.FloatSetUnchecked},b.FloatGetUnchecked=function(){return x.$cctor(),x.FloatGetUnchecked},b.FloatSetChecked=function(){return x.$cctor(),x.FloatSetChecked},b.FloatGetChecked=function(){return x.$cctor(),x.FloatGetChecked},Ft.notPresent=function(){throw new De.New},ee.convertTextNode=function(t){var n,r,i,u,o;for(n=null,r=0,i=t.textContent,u=new h.RegExp(k.TextHoleRE(),"g");n=u.exec(i),n!==null;)t.parentNode.insertBefore(self.document.createTextNode(Pe.string(i,{$:1,$0:r},{$:1,$0:u.lastIndex-p.get(n,0).length-1})),t),r=u.lastIndex,o=self.document.createElement("span"),o.setAttribute("ws-replace",p.get(n,1).toLowerCase()),t.parentNode.insertBefore(o,t);u.lastIndex=0,t.textContent=Pe.string(i,{$:1,$0:r},null)},ee.failNotLoaded=function(t){Ne.warn("Instantiating non-loaded template",t)},ee.fillTextHole=function(t,n,r){var i;return i=t.querySelector("[ws-replace]"),v.Equals(i,null)?(Ne.warn("Filling non-existent text hole",r),null):(i.parentNode.replaceChild(self.document.createTextNode(n),i),{$:1,$0:i.getAttribute("ws-replace")})},ee.removeHolesExcept=function(t,n){function r(i){k.foreachNotPreserved(t,"["+i+"]",function(u){n.Contains(u.getAttribute(i))||u.removeAttribute(i)})}r("ws-attr"),r("ws-onafterrender"),r("ws-var"),k.foreachNotPreserved(t,"[ws-hole]",function(i){if(!n.Contains(i.getAttribute("ws-hole")))for(i.removeAttribute("ws-hole");i.hasChildNodes();)i.removeChild(i.lastChild)}),k.foreachNotPreserved(t,"[ws-replace]",function(i){n.Contains(i.getAttribute("ws-replace"))||i.parentNode.removeChild(i)}),k.foreachNotPreserved(t,"[ws-on]",function(i){i.setAttribute("ws-on",_.concat(" ",p.filter(function(u){return n.Contains(p.get(_.SplitChars(u,[":"],1),1))},_.SplitChars(i.getAttribute("ws-on"),[" "],1))))}),k.foreachNotPreserved(t,"[ws-attr-holes]",function(i){var u,o,a,f,g;for(u=_.SplitChars(i.getAttribute("ws-attr-holes"),[" "],1),o=0,a=u.length-1;o<=a;o++)f=p.get(u,o),i.setAttribute(f,(g=new h.RegExp(k.TextHoleRE(),"g"),i.getAttribute(f).replace(g,function(F,M){return n.Contains(M)?F:""})))})},ee.fillInstanceAttrs=function(t,n){var r,i,u,o,a;if(ee.convertAttrs(n),r=n.nodeName.toLowerCase(),i=t.querySelector("[ws-attr="+r+"]"),v.Equals(i,null))Ne.warn("Filling non-existent attr hole",r);else for(i.removeAttribute("ws-attr"),u=0,o=n.attributes.length-1;u<=o;u++)a=n.attributes.item(u),a.name=="class"&&i.hasAttribute("class")?i.setAttribute("class",i.getAttribute("class")+" "+a.nodeValue):i.setAttribute(a.name,a.nodeValue)},ee.mapHoles=function(t,n){function r(i){k.foreachNotPreserved(t,"["+i+"]",function(u){var o,a;o=(a=null,[n.TryGetValue(u.getAttribute(i).toLowerCase(),{get:function(){return a},set:function(f){a=f}}),a]),o[0]&&u.setAttribute(i,o[1])})}r("ws-hole"),r("ws-replace"),r("ws-attr"),r("ws-onafterrender"),r("ws-var"),k.foreachNotPreserved(t,"[ws-on]",function(i){i.setAttribute("ws-on",_.concat(" ",p.map(function(u){var o,a,f;return o=_.SplitChars(u,[":"],1),a=(f=null,[n.TryGetValue(p.get(o,1),{get:function(){return f},set:function(g){f=g}}),f]),a[0]?p.get(o,0)+":"+a[1]:u},_.SplitChars(i.getAttribute("ws-on"),[" "],1))))}),k.foreachNotPreserved(t,"[ws-attr-holes]",function(i){var u,o,a;for(u=_.SplitChars(i.getAttribute("ws-attr-holes"),[" "],1),o=0,a=u.length-1;o<=a;o++)(function(){var f;function g(F,M){var P;return P=y.KeyValue(M),F.replace(new h.RegExp("\\${"+P[0]+"}","ig"),"${"+P[1]+"}")}return f=p.get(u,o),i.setAttribute(f,E.Curried3(S.fold)(g)(i.getAttribute(f))(n))})()})},ee.fill=function(t,n,r){for(;;)if(t.hasChildNodes())r=n.insertBefore(t.lastChild,r);else return null},ee.convertAttrs=function(t){var n,r,i,u,o,a,f,g;function F(M){var P;P=t.getAttribute(M),P==null||t.setAttribute(M,P.toLowerCase())}for(n=t.attributes,r=[],i=[],u=[],o=0,a=n.length-1;o<=a;o++)f=n.item(o),_.StartsWith(f.nodeName,"ws-on")&&f.nodeName!="ws-onafterrender"&&f.nodeName!="ws-on"?(r.push(f.nodeName),i.push(Pe.string(f.nodeName,{$:1,$0:5},null)+":"+f.nodeValue.toLowerCase())):!_.StartsWith(f.nodeName,"ws-")&&new h.RegExp(k.TextHoleRE()).test(f.nodeValue)&&(f.nodeValue=(g=new h.RegExp(k.TextHoleRE(),"g"),f.nodeValue.replace(g,function(M,P){return"${"+P.toLowerCase()+"}"})),u.push(f.nodeName));i.length!=0&&t.setAttribute("ws-on",_.concat(" ",i)),u.length!=0&&t.setAttribute("ws-attr-holes",_.concat(" ",u)),F("ws-hole"),F("ws-replace"),F("ws-attr"),F("ws-onafterrender"),F("ws-var"),p.iter(function(M){t.removeAttribute(M)},r)},Pe.string=function(t,n,r){var i,u;return n==null?r!=null&&r.$==1?(i=r.$0,i<0?"":t.slice(0,i+1)):"":r==null?t.slice(n.$0):(u=r.$0,u<0?"":t.slice(n.$0,u+1))},S.insufficient=function(){return y.FailWith("The input sequence has an insufficient number of elements.")},p.mapiInPlace=function(t,n){var r,i;for(r=0,i=n.length-1;r<=i;r++)n[r]=t(r,n[r]);return n},p.mapInPlace=function(t,n){var r,i;for(r=0,i=n.length-1;r<=i;r++)n[r]=t(n[r])},S.nonNegative=function(){return y.FailWith("The input must be non-negative.")},Ye=K.KeyCollection=E.Class({GetEnumerator:function(){return q.Get(S.map(function(t){return t.K},this.d))}},N,Ye),Ye.New=E.Ctor(function(t){N.New.call(this),this.d=t},Ye),et=$.DocElemNode=E.Class({Equals:function(t){return this.ElKey===t.ElKey},GetHashCode:function(){return this.ElKey}},null,et),et.New=function(t,n,r,i,u,o){var a;return new et((a={Attr:t,Children:n,El:i,ElKey:u},E.SetOptional(a,"Delimiters",r),E.SetOptional(a,"Render",o),a))},te.get_UseAnimations=function(){return ue.UseAnimations()},te.Play=function(t){return L.Delay(function(){return L.Bind(te.Run(h.ignore,ue.Actions(t)),function(){return ue.Finalize(t),L.Return(null)})})},te.Append=function(t,n){return{$:0,$0:ye.Append(t.$0,n.$0)}},te.Run=function(t,n){var r;function i(u){function o(a){return function(f){var g;return g=f-a,n.Compute(g),t(),g<=r?void h.requestAnimationFrame(function(F){o(a)(F)}):u()}}h.requestAnimationFrame(function(a){o(a)(a)})}return r=n.Duration,r===0?L.Zero():L.FromContinuations(function(u,o,a){return i.apply(null,[u,o,a])})},te.Concat=function(t){return{$:0,$0:ye.Concat(S.map(ue.List,t))}},te.get_Empty=function(){return{$:0,$0:ye.Empty()}},yt.BatchUpdatesEnabled=function(){return tt.$cctor(),tt.BatchUpdatesEnabled},kt.StartProcessor=function(t){var n;function r(){return L.Delay(function(){return L.Bind(t,function(){var i;return i=n[0],v.Equals(i,1)?(n[0]=0,L.Zero()):v.Equals(i,2)?(n[0]=1,r()):L.Zero()})})}return n=[0],function(){var i;i=n[0],v.Equals(i,0)?(n[0]=1,L.Start(r(),null)):v.Equals(i,1)&&(n[0]=2)}},Ue.$cctor=function(){Ue.$cctor=h.ignore,Ue.counter=0},Ae=$.Elt=E.Class({},d,Ae),Ae.New=function(t,n,r){var i,u;return i=I.CreateElemNode(t,n,r.docNode),u=be.Create(r.updates),new Ae.New$1({$:1,$0:i},O.Map2Unit(U.Updates(i.Attr),u.v),t,u)},Ae.New$1=E.Ctor(function(t,n,r,i){d.New.call(this,t,n),this.docNode$1=t,this.updates$1=n,this.elt=r,this.rvUpdates=i},Ae),x.$cctor=function(){var t,n,r,i,u,o,a,f,g,F,M,P,T,w;x.$cctor=h.ignore,x.EmptyAttr=null,x.BoolCheckedApply=function(m){function C(A,W){return W!=null&&W.$==1?void(A.checked=W.$0):null}return[function(A){A.addEventListener("change",function(){return m.Get()!=A.checked?m.Set(A.checked):null})},function(A){return function(W){return C(A,W)}},O.Map(function(A){return{$:1,$0:A}},m.get_View())]},x.StringSet=function(m){return function(C){m.value=C}},x.StringGet=function(m){return{$:1,$0:m.value}},x.StringApply=(t=b.StringGet(),n=b.StringSet(),function(m){return b.ApplyValue(t,n,m)}),x.DateTimeSetUnchecked=function(m){return function(C){m.value=new Fe(C).toLocaleString()}},x.DateTimeGetUnchecked=function(m){var C,A,W,V;return C=m.value,Ke.isBlank(C)?{$:1,$0:-864e13}:(A=(W=0,[(V=Pt.TryParse(C),V!=null&&V.$==1&&(W=V.$0,!0)),W]),A[0]?{$:1,$0:A[1]}:null)},x.DateTimeApplyUnchecked=(r=b.DateTimeGetUnchecked(),i=b.DateTimeSetUnchecked(),function(m){return b.ApplyValue(r,i,m)}),x.FileSetUnchecked=function(){return function(){return null}},x.FileGetUnchecked=function(m){var C;return C=m.files,{$:1,$0:p.ofSeq(S.delay(function(){return S.map(function(A){return C.item(A)},y.range(0,C.length-1))}))}},x.FileApplyUnchecked=(u=b.FileGetUnchecked(),o=b.FileSetUnchecked(),function(m){return b.FileApplyValue(u,o,m)}),x.IntSetUnchecked=function(m){return function(C){m.value=h.String(C)}},x.IntGetUnchecked=function(m){var C,A;return C=m.value,Ke.isBlank(C)?{$:1,$0:0}:(A=+C,A!==A>>0?null:{$:1,$0:A})},x.IntApplyUnchecked=(a=b.IntGetUnchecked(),f=b.IntSetUnchecked(),function(m){return b.ApplyValue(a,f,m)}),x.IntSetChecked=function(m){return function(C){var A;return A=C.get_Input(),m.value!=A?void(m.value=A):null}},x.IntGetChecked=function(m){var C,A,W;return C=m.value,{$:1,$0:Ke.isBlank(C)?!m.checkValidity||m.checkValidity()?new Se({$:2,$0:C}):new Se({$:1,$0:C}):(A=(W=0,[ht.TryParseInt32(C,{get:function(){return W},set:function(V){W=V}}),W]),A[0]?new Se({$:0,$0:A[1],$1:C}):new Se({$:1,$0:C}))}},x.IntApplyChecked=(g=b.IntGetChecked(),F=b.IntSetChecked(),function(m){return b.ApplyValue(g,F,m)}),x.FloatSetUnchecked=function(m){return function(C){m.value=h.String(C)}},x.FloatGetUnchecked=function(m){var C,A;return C=m.value,Ke.isBlank(C)?{$:1,$0:0}:(A=+C,h.isNaN(A)?null:{$:1,$0:A})},x.FloatApplyUnchecked=(M=b.FloatGetUnchecked(),P=b.FloatSetUnchecked(),function(m){return b.ApplyValue(M,P,m)}),x.FloatSetChecked=function(m){return function(C){var A;return A=C.get_Input(),m.value!=A?void(m.value=A):null}},x.FloatGetChecked=function(m){var C,A;return C=m.value,{$:1,$0:Ke.isBlank(C)?!m.checkValidity||m.checkValidity()?new Se({$:2,$0:C}):new Se({$:1,$0:C}):(A=+C,h.isNaN(A)?new Se({$:1,$0:C}):new Se({$:0,$0:A,$1:C}))}},x.FloatApplyChecked=(T=b.FloatGetChecked(),w=b.FloatSetChecked(),function(m){return b.ApplyValue(T,w,m)})},Te=c.ArgumentException=E.Class({},dt,Te),Te.New=E.Ctor(function(t,n){Te.New$2.call(this,n+`
Parameter name: `+t)},Te),Te.New$2=E.Ctor(function(t){this.message=t,Be.setPrototypeOf(this,Te.prototype)},Te),_.concat=function(t,n){return p.ofSeq(n).join(t)},_.SplitChars=function(t,n,r){return _.Split(t,new h.RegExp("["+_.RegexEscape(n.join(""))+"]"),r)},_.StartsWith=function(t,n){return t.substring(0,n.length)==n},_.Split=function(t,n,r){return r===1?p.filter(function(i){return i!==""},_.SplitWith(t,n)):_.SplitWith(t,n)},_.RegexEscape=function(t){return t.replace(new h.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&")},_.forall=function(t,n){return S.forall(t,_.protect(n))},_.SplitWith=function(t,n){return t.split(n)},_.protect=function(t){return t??""},Mt.New=function(t,n,r,i){var u;return u={DynElem:t,DynFlags:n,DynNodes:r},E.SetOptional(u,"OnAfterRender",i),u},Rt.New=function(t,n){return{PreviousNodes:t,Top:n}},re.get_Empty=function(){return{$:0,$0:new X.New$3}},re.FindAll=function(t){var n;function r(o,a){for(var f,g,F,M,P;;)switch(o){case 0:if(a!=null&&a.$==0)g=a.$1,F=a.$0,r(0,F),a=g;else if(a!=null&&a.$==1)M=a.$0,a=M,o=1;else if(a!=null&&a.$==2)P=a.$0,a=P.Current;else return a!=null&&a.$==6?(f=a.$0.Holes,function(T){return function(w){p.iter(T,w)}}(u)(f)):null;break;case 1:n.push(a),a=a.Children,o=0;break}}function i(o){return r(0,o)}function u(o){return r(1,o)}return n=[],i(t),{$:0,$0:new X.New$2(n)}},re.Filter=function(t,n){return{$:0,$0:de.Filter(t,n.$0)}},re.Except=function(t,n){return{$:0,$0:de.Except(t.$0,n.$0)}},re.ToArray=function(t){return de.ToArray(t.$0)},re.Intersect=function(t,n){return{$:0,$0:de.Intersect(t.$0,n.$0)}},L.Delay=function(t){return function(n){try{t(null)(n)}catch(r){n.k({$:1,$0:r})}}},L.Bind=function(t,n){return L.checkCancel(function(r){t(vt.New(function(i){var u;i.$==0?(u=i.$0,L.scheduler().Fork(function(){try{n(u)(r)}catch(o){r.k({$:1,$0:o})}})):L.scheduler().Fork(function(){r.k(i)})},r.ct))})},L.Zero=function(){return he.$cctor(),he.Zero},L.Start=function(t,n){var r,i;r=(i=L.defCTS()[0],n==null?i:n.$0),L.scheduler().Fork(function(){r.c||t(vt.New(function(u){u.$==1&&L.UncaughtAsyncError(u.$0)},r))})},L.Return=function(t){return function(n){n.k({$:0,$0:t})}},L.scheduler=function(){return he.$cctor(),he.scheduler},L.checkCancel=function(t){return function(n){n.ct.c?L.cancel(n):t(n)}},L.defCTS=function(){return he.$cctor(),he.defCTS},L.UncaughtAsyncError=function(t){Ne.log("WebSharper: Uncaught asynchronous exception",t)},L.FromContinuations=function(t){return function(n){var r;function i(u){r[0]?y.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times"):(r[0]=!0,L.scheduler().Fork(u))}r=[!1],t(function(u){i(function(){n.k({$:0,$0:u})})},function(u){i(function(){n.k({$:1,$0:u})})},function(u){i(function(){n.k({$:2,$0:u})})})}},L.cancel=function(t){t.k({$:2,$0:new xe.New(t.ct)})},ue.UseAnimations=function(){return je.$cctor(),je.UseAnimations},ue.Actions=function(t){return ue.ConcatActions(p.choose(function(n){return n.$==1?{$:1,$0:n.$0}:null},ye.ToArray(t.$0)))},ue.Finalize=function(t){p.iter(function(n){n.$==0&&n.$0()},ye.ToArray(t.$0))},ue.ConcatActions=function(t){var n,r,i,u;return n=me.ofSeqNonCopying(t),r=p.length(n),r===0?ue.Const():r===1?p.get(n,0):(i=S.max(S.map(function(o){return o.Duration},n)),u=p.map(function(o){return ue.Prolong(i,o)},n),ue.Def(i,function(o){p.iter(function(a){a.Compute(o)},u)}))},ue.List=function(t){return t.$0},ue.Const=function(t){return ue.Def(0,function(){return t})},ue.Def=function(t,n){return{Compute:n,Duration:t}},ue.Prolong=function(t,n){var r,i,u;return r=n.Compute,i=n.Duration,u=Ge.Create(function(){return n.Compute(n.Duration)}),{Compute:function(o){return o>=i?u.f():r(o)},Duration:t}},tt.$cctor=function(){tt.$cctor=h.ignore,tt.BatchUpdatesEnabled=!0},Lt.fromSeq=function(t){var n;return n=p.ofSeq(S.map(function(r){return Le.New(r[0],r[1])},S.distinctBy(function(r){return r[0]},S.rev(t)))),p.sortInPlace(n),R.Build(n,0,n.length-1)},be=$.Updates=E.Class({},null,be),be.Create=function(t){var n;return n=null,n=be.New(t,null,function(){var r;return r=n.s,r===null&&(r=D.Copy(n.c()),n.s=r,D.WhenObsoleteRun(r,function(){n.s=null})),r}),n},be.New=function(t,n,r){return new be({c:t,s:n,v:r})},nt=$.DynamicAttrNode=E.Class({NChanged:function(){return this.updates},NGetExitAnim:function(t){return te.get_Empty()},NGetEnterAnim:function(t){return te.get_Empty()},NGetChangeAnim:function(t){return te.get_Empty()},NSync:function(t){this.dirty&&(this.push(t)(this.value),this.dirty=!1)}},N,nt),nt.New=E.Ctor(function(t,n){var r;r=this,N.New.call(this),this.push=n,this.value=void 0,this.dirty=!1,this.updates=O.Map(function(i){r.value=i,r.dirty=!0},t)},nt),Ke.isBlank=function(t){return _.forall(qt.IsWhiteSpace,t)},Se=$.CheckedInput=E.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1}},null,Se),oe.$cctor=function(){var t;oe.$cctor=h.ignore,oe.rxhtmlTag=new h.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi"),oe.rtagName=new h.RegExp("<([\\w:]+)"),oe.rhtml=new h.RegExp("<|&#?\\w+;"),oe.wrapMap=(t=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:t,tbody:t,tfoot:t,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]}),oe.defaultWrap=[0,"",""]},je.$cctor=function(){je.$cctor=h.ignore,je.CubicInOut=We.Custom(function(t){var n;return n=t*t,3*n-2*(n*t)}),je.UseAnimations=!0},ye.Append=function(t,n){return t.$==0?n:n.$==0?t:{$:2,$0:t,$1:n}},ye.ToArray=function(t){var n;function r(i){for(var u,o;;){if(i.$==1)return n.push(i.$0);if(i.$==2)u=i.$1,o=i.$0,r(o),i=u;else return i.$==3?p.iter(function(a){n.push(a)},i.$0):null}}return n=[],r(t),n.slice(0)},ye.Concat=function(t){var n;return n=me.ofSeqNonCopying(t),me.TreeReduce(ye.Empty(),ye.Append,n)},ye.Empty=function(){return ut.$cctor(),ut.Empty},$t.concat=function(t){var n;n=[];for(var r in t)n.push.apply(n,t[r]);return n},qt.IsWhiteSpace=function(t){return t.match(new h.RegExp("\\s"))!==null},Pt.TryParse=function(t){var n;return n=Fe.parse(t),h.isNaN(n)?null:{$:1,$0:n}},ht.TryParse=function(t,n,r,i){var u,o;return u=+t,o=u===u-u%1&&u>=n&&u<=r,o&&i.set(u),o},De=c.KeyNotFoundException=E.Class({},dt,De),De.New=E.Ctor(function(){De.New$1.call(this,"The given key was not present in the dictionary.")},De),De.New$1=E.Ctor(function(t){this.message=t,Be.setPrototypeOf(this,De.prototype)},De),rt=L.Scheduler=E.Class({Fork:function(t){var n;n=this,this.robin.push(t),this.idle&&(this.idle=!1,h.setTimeout(function(){n.tick()},0))},tick:function(){var t,n,r;for(n=this,r=Fe.now(),t=!0;t;)this.robin.length===0?(this.idle=!0,t=!1):(this.robin.shift()(),Fe.now()-r>40&&(h.setTimeout(function(){n.tick()},0),t=!1))}},N,rt),rt.New=E.Ctor(function(){N.New.call(this),this.idle=!0,this.robin=[]},rt),We=$.Easing=E.Class({},N,We),We.Custom=function(t){return new We.New(t)},We.New=E.Ctor(function(t){N.New.call(this),this.transformTime=t},We),vt.New=function(t,n){return{k:t,ct:n}},he.$cctor=function(){he.$cctor=h.ignore,he.noneCT=Ut.New(!1,[]),he.scheduler=new rt.New,he.defCTS=[new it.New],he.Zero=L.Return(),he.GetCT=function(t){t.k({$:0,$0:t.ct})}},Ut.New=function(t,n){return{c:t,r:n}},de.Filter=function(t,n){return new X.New$2(p.filter(t,de.ToArray(n)))},de.Except=function(t,n){var r;return r=new X.New$2(de.ToArray(n)),r.ExceptWith(de.ToArray(t)),r},de.ToArray=function(t){var n;return n=p.create(t.Count(),void 0),t.CopyTo(n,0),n},de.Intersect=function(t,n){var r;return r=new X.New$2(de.ToArray(t)),r.IntersectWith(de.ToArray(n)),r},bt.Clear=function(t){t.splice(0,p.length(t))},it=c.CancellationTokenSource=E.Class({},N,it),it.New=E.Ctor(function(){N.New.call(this),this.c=!1,this.pending=null,this.r=[],this.init=1},it),qe.Children=function(t,n){var r,i,u;if(n!=null&&n.$==1){for(u=[],r=n.$0[0].nextSibling;r!==n.$0[1];)u.push(r),r=r.nextSibling;return{$:0,$0:u}}else return{$:0,$0:p.init(t.childNodes.length,(i=t.childNodes,function(o){return i[o]}))}},qe.Except=function(t,n){var r;return r=t.$0,{$:0,$0:p.filter(function(i){return p.forall(function(u){return i!==u},r)},n.$0)}},qe.Iter=function(t,n){p.iter(t,n.$0)},qe.DocChildren=function(t){var n;function r(i){for(var u,o,a,f;;)if(i!=null&&i.$==2)o=i.$0,i=o.Current;else{if(i!=null&&i.$==1)return n.push(i.$0.El);if(i==null)return null;if(i!=null&&i.$==5)return n.push(i.$0);if(i!=null&&i.$==4)return n.push(i.$0.Text);if(i!=null&&i.$==6)return u=i.$0.Els,function(g){return function(F){p.iter(g,F)}}(function(g){g==null||g.constructor===Be?r(g):n.push(g)})(u);a=i.$1,f=i.$0,r(f),i=a}}return n=[],r(t.Children),{$:0,$0:me.ofSeqNonCopying(n)}},xe=c.OperationCanceledException=E.Class({},dt,xe),xe.New=E.Ctor(function(t){xe.New$1.call(this,"The operation was canceled.",null,t)},xe),xe.New$1=E.Ctor(function(t,n,r){this.message=t,this.inner=n,Be.setPrototypeOf(this,xe.prototype),this.ct=r},xe),Ge.Create=function(t){return Vt.New(!1,t,Ge.forceLazy)},Ge.forceLazy=function(){var t;return t=this.v(),this.c=!0,this.v=t,this.f=Ge.cachedLazy,t},Ge.cachedLazy=function(){return this.v},ut.$cctor=function(){ut.$cctor=h.ignore,ut.Empty={$:0}},Vt.New=function(t,n,r){return{c:t,v:n,f:r}},E.OnLoad(function(){l.Main()})})(self);typeof WebSharper<"u"&&(WebSharper.Runtime.ScriptBasePath="/Content/",WebSharper.Runtime.Start());
